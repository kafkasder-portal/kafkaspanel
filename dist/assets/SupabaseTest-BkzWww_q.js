import{v as w,r as f,j as e,Y as b,C as m,c as D,L as v,Z as c,p as R,U as A,ar as k}from"./index-JhQGfP3r.js";import{X as _}from"./x-circle-DAY1fQC3.js";import{A as E}from"./alert-circle-CYP2Nndn.js";const I=w("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]),$=w("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);function U(){const[u,y]=f.useState([{name:"Supabase Client Initialization",status:"pending",message:"Testing client setup..."},{name:"Database Connection",status:"pending",message:"Testing database connectivity..."},{name:"Authentication Service",status:"pending",message:"Testing auth service..."},{name:"Table Access",status:"pending",message:"Testing table permissions..."},{name:"Real-time Features",status:"pending",message:"Testing real-time subscriptions..."}]),[j,l]=f.useState(!1),[n,d]=f.useState("pending"),t=(a,i,x,h)=>{y(p=>p.map((o,s)=>s===a?{...o,status:i,message:x,duration:h}:o))},S=async()=>{var o;l(!0),d("pending");const a=Date.now();try{if(c)t(0,"success","Supabase client initialized successfully",Date.now()-a);else{t(0,"error","Failed to initialize Supabase client"),l(!1),d("error");return}}catch(s){t(0,"error",`Client initialization failed: ${s}`),l(!1),d("error");return}const i=Date.now();try{const{error:s}=await c.from("beneficiaries").select("count",{count:"exact",head:!0}).limit(0);s?t(1,"error",`Database connection failed: ${s.message}`):t(1,"success","Database connected successfully. Tables accessible.",Date.now()-i)}catch(s){t(1,"error",`Database connection error: ${s}`)}const x=Date.now();try{const{data:s,error:r}=await c.auth.getSession();if(r)t(2,"error",`Auth service error: ${r.message}`);else{const g=s!=null&&s.session?`Authenticated user: ${(o=s.session.user)==null?void 0:o.email}`:"Auth service working (no active session)";t(2,"success",g,Date.now()-x)}}catch(s){t(2,"error",`Auth service failed: ${s}`)}const h=Date.now();try{const{error:s}=await c.from("beneficiaries").select("id").limit(1),{error:r}=await c.from("applications").select("id").limit(1);if(s||r){const g=(s==null?void 0:s.message)||(r==null?void 0:r.message)||"Unknown table error";t(3,"error",`Table access failed: ${g}`)}else t(3,"success","All main tables accessible",Date.now()-h)}catch(s){t(3,"error",`Table access error: ${s}`)}const p=Date.now();try{const s=c.channel("test-channel").on("postgres_changes",{event:"*",schema:"public",table:"beneficiaries"},()=>{}).subscribe(r=>{r==="SUBSCRIBED"?(t(4,"success","Real-time subscriptions working",Date.now()-p),s.unsubscribe()):r==="CHANNEL_ERROR"&&(t(4,"error","Real-time subscription failed"),s.unsubscribe())});setTimeout(()=>{u[4].status==="pending"&&(t(4,"error","Real-time test timeout"),s.unsubscribe())},5e3)}catch(s){t(4,"error",`Real-time error: ${s}`)}setTimeout(()=>{const s=u.some(r=>r.status==="error");d(s?"error":"success"),l(!1)},6e3)},N=a=>{switch(a){case"pending":return e.jsx(v,{className:"h-4 w-4 animate-spin text-blue-500"});case"success":return e.jsx(R,{className:"h-4 w-4 text-green-500"});case"error":return e.jsx(_,{className:"h-4 w-4 text-red-500"})}},T=a=>[e.jsx(I,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(b,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(A,{className:"h-4 w-4 text-muted-foreground"}),e.jsx($,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(k,{className:"h-4 w-4 text-muted-foreground"})][a]||e.jsx(E,{className:"h-4 w-4 text-muted-foreground"}),C=()=>{switch(n){case"success":return"from-green-500 to-green-600";case"error":return"from-red-500 to-red-600";default:return"from-blue-500 to-blue-600"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:`bg-gradient-to-r ${C()} rounded-xl p-6 text-white`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(b,{className:"h-8 w-8"}),e.jsx("h1",{className:"text-2xl font-bold",children:"Supabase Connection Test"})]}),e.jsx("p",{className:"text-white/90",children:"Veritabanı bağlantısı ve servislerin test edilmesi"})]}),e.jsx(m,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[N(n),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-semibold",children:[n==="success"&&"All Systems Operational",n==="error"&&"System Issues Detected",n==="pending"&&"System Status Check"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[n==="success"&&"Supabase services are working properly",n==="error"&&"Some services are experiencing issues",n==="pending"&&"Testing system components"]})]})]}),e.jsx(D,{onClick:S,disabled:j,className:"gap-2",children:j?e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"h-4 w-4 animate-spin"}),"Testing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"h-4 w-4"}),"Run Tests"]})})]})}),e.jsxs(m,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Test Results"}),e.jsx("div",{className:"space-y-4",children:u.map((a,i)=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[T(i),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:a.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.message})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[a.duration&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:[a.duration,"ms"]}),N(a.status)]})]},i))})]}),e.jsxs(m,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Environment Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Supabase URL:"}),e.jsx("p",{className:"text-muted-foreground font-mono break-all",children:"your_supabase_url_here"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Environment:"}),e.jsx("p",{className:"text-muted-foreground",children:"production"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"API Key Status:"}),e.jsx("p",{className:"text-muted-foreground",children:"Configured"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Real-time Enabled:"}),e.jsx("p",{className:"text-muted-foreground",children:"No"})]})]})]}),e.jsxs(m,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Setup Instructions"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"1. Environment Variables"}),e.jsx("p",{className:"text-muted-foreground",children:"Configure your .env file with Supabase credentials:"}),e.jsx("pre",{className:"bg-muted p-3 rounded mt-2 overflow-x-auto",children:e.jsx("code",{children:`VITE_SUPABASE_URL=your_supabase_url
VITE_SUPABASE_ANON_KEY=your_anon_key`})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:"2. Database Setup"}),e.jsx("p",{className:"text-muted-foreground",children:"Run the migration scripts to create necessary tables:"}),e.jsx("pre",{className:"bg-muted p-3 rounded mt-2",children:e.jsx("code",{children:"npm run db:setup"})})]})]})]})]})}function z(){return e.jsx(U,{})}export{z as default};
