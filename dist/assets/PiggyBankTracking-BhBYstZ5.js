import{r as n,j as e}from"./index-JhQGfP3r.js";import{D as z}from"./DataTable-ZpmiLouZ.js";import{M as O}from"./Modal-Ul9aPZYl.js";import{M as Ne,T as ke,a as ve,P as fe,L as ae}from"./leaflet-BdfIzUst.js";import{L as Ce}from"./LazyQRScannerModal-HOIvdZDO.js";import{g as se,a as Te,b as we}from"./qrCodeUtils-CCw4n1DD.js";import{e as Se}from"./exportToCsv-CTUkvpR5.js";import{Q as De}from"./qr-code-B30iB-_1.js";delete ae.Icon.Default.prototype._getIconUrl;ae.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});const Re=({isOpen:d,onClose:M,address:p,bankNumber:m,assignedTo:c})=>{const[l,j]=n.useState(null),[w,u]=n.useState(!1),[S,y]=n.useState(null),B=async r=>{try{const v=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(r)}&limit=1`)).json();return v&&v.length>0?{lat:parseFloat(v[0].lat),lng:parseFloat(v[0].lon)}:null}catch(K){return console.error("Geocoding hatası:",K),null}},D=()=>{if(l){const r=`https://www.google.com/maps/dir/?api=1&destination=${l.lat},${l.lng}`;window.open(r,"_blank")}else{const r=`https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(p)}`;window.open(r,"_blank")}},N=()=>{if(l){const r=`https://maps.apple.com/?daddr=${l.lat},${l.lng}`;window.open(r,"_blank")}else{const r=`https://maps.apple.com/?daddr=${encodeURIComponent(p)}`;window.open(r,"_blank")}},A=()=>{if(l){const r=`https://yandex.com.tr/maps/?rtext=~${l.lat},${l.lng}&rtt=auto`;window.open(r,"_blank")}else{const r=`https://yandex.com.tr/maps/?text=${encodeURIComponent(p)}`;window.open(r,"_blank")}};return n.useEffect(()=>{d&&p&&(u(!0),y(null),B(p).then(r=>{r?j(r):y("Adres bulunamadı")}).catch(()=>{y("Adres aranırken hata oluştu")}).finally(()=>{u(!1)}))},[d,p]),e.jsx(O,{isOpen:d,onClose:M,title:`Harita - ${m}`,size:"large",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Kumbara:"}),e.jsx("span",{className:"ml-2 font-medium",children:m})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Atanan Yer:"}),e.jsx("span",{className:"ml-2 font-medium",children:c})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-600",children:"Adres:"}),e.jsx("span",{className:"ml-2 font-medium",children:p})]})]})}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:D,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 flex items-center gap-2",children:[e.jsx("span",{children:"🗺️"}),"Google Maps'te Rota"]}),e.jsxs("button",{onClick:N,className:"bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700 flex items-center gap-2",children:[e.jsx("span",{children:"🍎"}),"Apple Maps'te Rota"]}),e.jsxs("button",{onClick:A,className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 flex items-center gap-2",children:[e.jsx("span",{children:"🔍"}),"Yandex Maps'te Rota"]})]}),e.jsxs("div",{className:"h-96 border rounded-lg overflow-hidden",children:[w&&e.jsx("div",{className:"h-full flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600",children:"Adres aranıyor..."})]})}),S&&e.jsx("div",{className:"h-full flex items-center justify-center bg-gray-100",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-red-600 mb-2",children:S}),e.jsx("p",{className:"text-sm text-gray-500",children:"Rota butonlarını kullanarak harici harita uygulamalarında açabilirsiniz."})]})}),l&&!w&&!S&&e.jsxs(Ne,{center:[l.lat,l.lng],zoom:15,style:{height:"100%",width:"100%"},children:[e.jsx(ke,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),e.jsx(ve,{position:[l.lat,l.lng],children:e.jsx(fe,{children:e.jsxs("div",{className:"text-center",children:[e.jsx("strong",{children:m}),e.jsx("br",{}),c,e.jsx("br",{}),e.jsx("small",{children:p})]})})})]})]}),e.jsxs("div",{className:"text-xs text-gray-500 bg-blue-50 p-3 rounded",children:["💡 ",e.jsx("strong",{children:"İpucu:"})," Rota butonlarını kullanarak tercih ettiğiniz harita uygulamasında navigasyon başlatabilirsiniz."]})]})})},Ae=({isOpen:d,onClose:M,bank:p})=>{const{bankNumber:m,id:c,assignedTo:l,location:j,qrCode:w}=p||{},[u,S]=n.useState(null),[y,B]=n.useState(!1),[D,N]=n.useState(null),A=n.useCallback(async()=>{if(!(!m||!c)){B(!0),N(null);try{if(w)S(w);else{const o=se({bankNumber:m,assignedTo:l||"",location:j||"",contactPerson:"",contactPhone:""});S(o)}}catch(o){console.error("QR kod oluşturma hatası:",o),N("QR kod oluşturulamadı")}finally{B(!1)}}},[m,c,w,l,j]),r=()=>{if(!u)return;const o=document.createElement("a");o.download=`${m}-qr-kod.png`,o.href=u,document.body.appendChild(o),o.click(),document.body.removeChild(o)},K=()=>{if(!u)return;const o=Te(u,m),k=window.open("","_blank");k&&(k.document.write(o),k.document.close(),k.onload=()=>{k.print(),k.close()})},v=async()=>{if(u)try{const k=await(await fetch(u)).blob();await navigator.clipboard.write([new ClipboardItem({"image/png":k})]),alert("QR kod panoya kopyalandı!")}catch(o){console.error("Panoya kopyalama hatası:",o),alert("QR kod panoya kopyalanamadı")}},I=()=>{const o=JSON.stringify({type:"piggy_bank",bankNumber:m,bankId:c,timestamp:new Date().toISOString()});navigator.clipboard.writeText(o).then(()=>{alert("QR kod verisi panoya kopyalandı!")}).catch(()=>{alert("QR kod verisi panoya kopyalanamadı")})};return n.useEffect(()=>{d&&m&&c&&A()},[d,m,c,A]),e.jsx(O,{isOpen:d,onClose:M,title:`QR Kod - ${m}`,size:"medium",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Kumbara:"}),e.jsx("span",{className:"ml-2 font-medium",children:m})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Atanan Yer:"}),e.jsx("span",{className:"ml-2 font-medium",children:l})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-600",children:"Lokasyon:"}),e.jsx("span",{className:"ml-2 font-medium",children:j})]})]})}),e.jsxs("div",{className:"text-center",children:[y&&e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600",children:"QR kod oluşturuluyor..."})]})}),D&&e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-500 text-4xl mb-2",children:"⚠️"}),e.jsx("p",{className:"text-red-600",children:D}),e.jsx("button",{onClick:A,className:"mt-2 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Tekrar Dene"})]})}),u&&!y&&!D&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"border-2 border-gray-200 p-4 rounded-lg bg-white",children:e.jsx("img",{src:u,alt:`QR Kod - ${m}`,className:"w-64 h-64 object-contain"})})}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("p",{children:"Bu QR kodu tarayarak kumbara bilgilerine ulaşabilirsiniz."}),e.jsxs("p",{className:"mt-1",children:["Kumbara ID: ",e.jsx("span",{className:"font-mono",children:c})]})]})]})]}),u&&!y&&!D&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:r,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 flex items-center justify-center gap-2",children:[e.jsx("span",{children:"💾"}),"İndir"]}),e.jsxs("button",{onClick:K,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 flex items-center justify-center gap-2",children:[e.jsx("span",{children:"🖨️"}),"Yazdır"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:v,className:"bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700 flex items-center justify-center gap-2 text-sm",children:[e.jsx("span",{children:"📋"}),"Resmi Kopyala"]}),e.jsxs("button",{onClick:I,className:"bg-orange-600 text-white px-4 py-2 rounded hover:bg-orange-700 flex items-center justify-center gap-2 text-sm",children:[e.jsx("span",{children:"📄"}),"Veriyi Kopyala"]})]})]}),e.jsxs("div",{className:"text-xs text-gray-500 bg-blue-50 p-3 rounded",children:["💡 ",e.jsx("strong",{children:"Kullanım:"}),e.jsxs("ul",{className:"mt-1 space-y-1 list-disc list-inside",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"İndir:"})," QR kodu PNG dosyası olarak kaydedin"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Yazdır:"})," QR kodu etiket olarak yazdırın"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Resmi Kopyala:"})," QR kod görüntüsünü panoya kopyalayın"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Veriyi Kopyala:"})," QR kod içeriğini metin olarak kopyalayın"]})]})]})]})})},Me=[{id:"1",bankNumber:"KB-2024-001",assignedTo:"Ahmet Market",assignedDate:"2024-01-15",location:"Fatih/İstanbul",locationDetails:"Ahmet Market - Kasa yanı",address:"Fatih Mahallesi, Atatürk Caddesi No:15, Fatih/İstanbul",contactPerson:"Ahmet Yılmaz",contactPhone:"+90 532 123 4567",contactEmail:"ahmet@market.com",initialAmount:0,currentAmount:1250,lastCollectionDate:"2024-11-15",lastCollectionAmount:850,totalCollected:3400,collectionCount:4,averageCollection:850,status:"aktif",bankType:"standart",material:"plastik",capacity:2e3,weight:1.2,qrCode:"KB001QR",notes:"Düzenli toplama yapılıyor",assignedBy:"Admin",createdDate:"2024-01-15",lastModified:"2024-11-15",modifiedBy:"Collector1"},{id:"2",bankNumber:"KB-2024-002",assignedTo:"Merkez Cami",assignedDate:"2024-02-01",location:"Üsküdar/İstanbul",locationDetails:"Merkez Cami - Giriş holü",address:"Merkez Mahallesi, Cami Sokak No:5, Üsküdar/İstanbul",contactPerson:"İmam Mehmet Bey",contactPhone:"+90 533 987 6543",initialAmount:0,currentAmount:1950,lastCollectionDate:"2024-11-10",lastCollectionAmount:1200,totalCollected:5600,collectionCount:5,averageCollection:1120,status:"dolu",bankType:"büyük",material:"metal",capacity:2e3,weight:2.1,qrCode:"KB002QR",notes:"Cuma namazı sonrası yoğun bağış",assignedBy:"Admin",createdDate:"2024-02-01",lastModified:"2024-11-10",modifiedBy:"Collector2"},{id:"3",bankNumber:"KB-2024-003",assignedTo:"Özel Okul",assignedDate:"2024-03-10",location:"Kadıköy/İstanbul",locationDetails:"Özel Okul - Öğretmenler odası",address:"Eğitim Mahallesi, Okul Caddesi No:25, Kadıköy/İstanbul",contactPerson:"Zeynep Öğretmen",contactPhone:"+90 534 111 2233",contactEmail:"zeynep@okul.edu.tr",initialAmount:0,currentAmount:0,lastCollectionDate:"2024-11-20",lastCollectionAmount:650,totalCollected:2100,collectionCount:3,averageCollection:700,status:"bakımda",bankType:"özel",material:"plastik",capacity:1500,weight:.8,qrCode:"KB003QR",notes:"Kilit arızası - tamir edilecek",assignedBy:"Admin",createdDate:"2024-03-10",lastModified:"2024-11-20",modifiedBy:"Maintenance"},{id:"4",bankNumber:"KB-2024-004",assignedTo:"Hastane Kantini",assignedDate:"2024-04-05",location:"Şişli/İstanbul",locationDetails:"Hastane Kantini - Kasa üstü",address:"Sağlık Mahallesi, Hastane Caddesi No:10, Şişli/İstanbul",contactPerson:"Fatma Hanım",contactPhone:"+90 535 444 5566",initialAmount:0,currentAmount:320,totalCollected:1800,collectionCount:6,averageCollection:300,status:"aktif",bankType:"standart",material:"plastik",capacity:1e3,weight:.9,qrCode:"KB004QR",assignedBy:"Admin",createdDate:"2024-04-05",lastModified:"2024-11-18",modifiedBy:"Collector1"},{id:"5",bankNumber:"KB-2024-005",assignedTo:"Kayıp",assignedDate:"2024-05-20",location:"Bilinmiyor",locationDetails:"Son bilinen: Beşiktaş Çarşı",address:"Beşiktaş Çarşı, İstanbul (Son bilinen konum)",contactPerson:"Bilinmiyor",contactPhone:"Bilinmiyor",initialAmount:0,currentAmount:0,totalCollected:450,collectionCount:1,averageCollection:450,status:"kayıp",bankType:"standart",material:"plastik",capacity:1e3,notes:"Kayıp raporu verildi - 2024-10-15",assignedBy:"Admin",createdDate:"2024-05-20",lastModified:"2024-10-15",modifiedBy:"Admin"}],Be=[{id:"1",bankId:"1",collectionDate:"2024-11-15",collectedBy:"Collector1",amount:850,currency:"TRY",coinCount:45,billCount:12,condition:"iyi",receiptNumber:"TOP-2024-115",collectorSignature:"İmzalandı",witnessName:"Ahmet Yılmaz",witnessSignature:"İmzalandı",photoTaken:!0,nextCollectionDate:"2024-12-15",notes:"Normal toplama",createdDate:"2024-11-15"},{id:"2",bankId:"2",collectionDate:"2024-11-10",collectedBy:"Collector2",amount:1200,currency:"TRY",coinCount:80,billCount:18,foreignCurrency:[{amount:5,currency:"USD",exchangeRate:34.5,tryEquivalent:172.5},{amount:2,currency:"EUR",exchangeRate:37.2,tryEquivalent:74.4}],condition:"iyi",receiptNumber:"TOP-2024-110",collectorSignature:"İmzalandı",witnessName:"İmam Mehmet Bey",witnessSignature:"İmzalandı",photoTaken:!0,notes:"Yabancı para da var",createdDate:"2024-11-10"},{id:"3",bankId:"3",collectionDate:"2024-11-20",collectedBy:"Collector1",amount:650,currency:"TRY",coinCount:35,billCount:8,condition:"hasarlı",receiptNumber:"TOP-2024-120",collectorSignature:"İmzalandı",witnessName:"Zeynep Öğretmen",witnessSignature:"İmzalandı",photoTaken:!0,notes:"Kilit problemi tespit edildi",createdDate:"2024-11-20"}],Ke=[{id:"1",bankId:"1",assignedTo:"Ahmet Market",assignedDate:"2024-01-15",location:"Fatih/İstanbul",locationDetails:"Ahmet Market - Kasa yanı",contactPerson:"Ahmet Yılmaz",contactPhone:"+90 532 123 4567",expectedDuration:365,targetAmount:5e3,purpose:"Genel bağış toplama",assignedBy:"Admin",status:"aktif",notes:"Yıllık anlaşma",createdDate:"2024-01-15"},{id:"2",bankId:"2",assignedTo:"Merkez Cami",assignedDate:"2024-02-01",location:"Üsküdar/İstanbul",locationDetails:"Merkez Cami - Giriş holü",contactPerson:"İmam Mehmet Bey",contactPhone:"+90 533 987 6543",expectedDuration:365,targetAmount:8e3,purpose:"Cami bakım ve yardım fonu",assignedBy:"Admin",status:"aktif",notes:"Cuma namazı sonrası aktif",createdDate:"2024-02-01"}];function $e(){const[d,M]=n.useState(Me),[p]=n.useState(Be),[m]=n.useState(Ke),[c,l]=n.useState(""),[j,w]=n.useState(""),[u,S]=n.useState(""),[y,B]=n.useState(""),[D,N]=n.useState(!1),[A,r]=n.useState(!1),[K,v]=n.useState(!1),[I,o]=n.useState(!1),[k,G]=n.useState(!1),[Q,F]=n.useState(null),[R,H]=n.useState(null),[P,ne]=n.useState(null),[J,le]=n.useState(null),[f,L]=n.useState("banks"),[s,x]=n.useState({bankNumber:"",assignedTo:"",location:"",locationDetails:"",address:"",contactPerson:"",contactPhone:"",contactEmail:"",bankType:"standart",material:"plastik",capacity:"",weight:"",notes:""}),g=n.useMemo(()=>d.filter(t=>{const a=JSON.stringify(t).toLowerCase().includes(c.toLowerCase()),i=!j||t.status===j,h=!u||t.location.toLowerCase().includes(u.toLowerCase()),C=!y||t.bankType===y;return a&&i&&h&&C}),[d,c,j,u,y]),re=n.useMemo(()=>p.filter(t=>JSON.stringify(t).toLowerCase().includes(c.toLowerCase())),[p,c]),ie=n.useMemo(()=>m.filter(t=>JSON.stringify(t).toLowerCase().includes(c.toLowerCase())),[m,c]),b=g.length,_=g.filter(t=>t.status==="aktif").length,$=g.filter(t=>t.status==="dolu").length,E=g.filter(t=>t.status==="bakımda").length,q=g.filter(t=>t.status==="kayıp").length,V=g.reduce((t,a)=>t+a.currentAmount,0),Y=g.reduce((t,a)=>t+a.totalCollected,0),Z=g.reduce((t,a)=>t+a.collectionCount,0),oe=b>0?Y/b:0,ce=Z>0?Y/Z:0,de=[{key:"bankNumber",header:"Kumbara No"},{key:"assignedTo",header:"Atanan Yer"},{key:"location",header:"Lokasyon"},{key:"address",header:"Adres",render:(t,a)=>e.jsx("button",{onClick:()=>he(a),className:"text-blue-600 hover:text-blue-800 underline text-sm max-w-32 truncate text-left",title:a.address||a.locationDetails,children:a.address||a.locationDetails})},{key:"contactPerson",header:"İletişim"},{key:"contactPhone",header:"Telefon"},{key:"currentAmount",header:"Mevcut/Toplam",render:(t,a)=>e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"font-medium",children:[a.currentAmount.toLocaleString("tr-TR")," ₺"]}),e.jsxs("div",{className:"text-gray-500",children:[a.totalCollected.toLocaleString("tr-TR")," ₺"]}),e.jsxs("div",{className:"text-xs text-gray-400",children:[a.collectionCount," toplama"]})]})},{key:"bankType",header:"Tip/Kapasite",render:(t,a)=>e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:a.bankType}),e.jsxs("div",{className:"text-gray-500",children:[a.capacity," ₺"]}),e.jsx("div",{className:"text-xs text-gray-400",children:a.material})]})},{key:"lastCollectionDate",header:"Son Toplama",render:(t,a)=>{var i;return e.jsx("div",{className:"text-sm",children:a.lastCollectionDate?e.jsxs(e.Fragment,{children:[e.jsx("div",{children:new Date(a.lastCollectionDate).toLocaleDateString("tr-TR")}),e.jsxs("div",{className:"text-gray-500",children:[(i=a.lastCollectionAmount)==null?void 0:i.toLocaleString("tr-TR")," ₺"]})]}):e.jsx("span",{className:"text-gray-400",children:"Henüz yok"})})}},{key:"status",header:"Durum",render:(t,a)=>e.jsx("span",{className:`px-2 py-1 rounded text-xs ${a.status==="aktif"?"bg-green-100 text-green-800":a.status==="dolu"?"bg-blue-100 text-blue-800":a.status==="bakımda"?"bg-yellow-100 text-yellow-800":a.status==="kayıp"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:a.status})},{key:"id",header:"İşlemler",render:(t,a)=>e.jsxs("div",{className:"flex gap-1 text-xs flex-wrap",children:[e.jsx("button",{onClick:()=>X(a),className:"text-blue-600 hover:text-blue-800 px-2 py-1 rounded",children:"Düzenle"}),e.jsx("button",{onClick:()=>ue(a),className:"text-green-600 hover:text-green-800 px-2 py-1 rounded",children:"Toplamalar"}),e.jsx("button",{onClick:()=>ge(a),className:"text-orange-600 hover:text-orange-800 px-2 py-1 rounded",children:"QR Kod"}),e.jsx("button",{onClick:()=>xe(a),className:"text-purple-600 hover:text-purple-800 px-2 py-1 rounded",disabled:a.status!=="aktif"&&a.status!=="dolu",children:"Topla"})]})}],W=[{key:"collectionDate",header:"Tarih",render:(t,a)=>new Date(a.collectionDate).toLocaleDateString("tr-TR")},{key:"bankId",header:"Kumbara",render:(t,a)=>{const i=d.find(h=>h.id===a.bankId);return i?i.bankNumber:"Bilinmiyor"}},{key:"collectedBy",header:"Toplayan"},{key:"amount",header:"Tutar/Adet",render:(t,a)=>e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"font-medium",children:[a.amount.toLocaleString("tr-TR")," ₺"]}),e.jsxs("div",{className:"text-gray-500",children:[a.coinCount,"M + ",a.billCount,"K"]}),a.foreignCurrency&&a.foreignCurrency.length>0&&e.jsx("div",{className:"text-xs text-blue-600",children:"+Yabancı para"})]})},{key:"condition",header:"Durum",render:(t,a)=>e.jsx("span",{className:`px-2 py-1 rounded text-xs ${a.condition==="iyi"?"bg-green-100 text-green-800":a.condition==="hasarlı"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:a.condition})},{key:"receiptNumber",header:"Makbuz No"},{key:"photoTaken",header:"Fotoğraf",render:(t,a)=>a.photoTaken?"✓":"-"},{key:"witnessName",header:"Şahit"}],me=[{key:"assignedDate",header:"Atama Tarihi",render:(t,a)=>new Date(a.assignedDate).toLocaleDateString("tr-TR")},{key:"bankId",header:"Kumbara",render:(t,a)=>{const i=d.find(h=>h.id===a.bankId);return i?i.bankNumber:"Bilinmiyor"}},{key:"assignedTo",header:"Atanan Yer"},{key:"location",header:"Lokasyon"},{key:"contactPerson",header:"İletişim"},{key:"expectedDuration",header:"Süre/Hedef",render:(t,a)=>e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{children:[a.expectedDuration," gün"]}),a.targetAmount&&e.jsxs("div",{className:"text-gray-500",children:[a.targetAmount.toLocaleString("tr-TR")," ₺"]})]})},{key:"purpose",header:"Amaç"},{key:"status",header:"Durum",render:(t,a)=>e.jsx("span",{className:`px-2 py-1 rounded text-xs ${a.status==="aktif"?"bg-green-100 text-green-800":a.status==="tamamlandı"?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:a.status})},{key:"assignedBy",header:"Atayan"}],X=t=>{var a;F(t),x({bankNumber:t.bankNumber,assignedTo:t.assignedTo,location:t.location,locationDetails:t.locationDetails,address:t.address||"",contactPerson:t.contactPerson,contactPhone:t.contactPhone,contactEmail:t.contactEmail||"",bankType:t.bankType,material:t.material,capacity:t.capacity.toString(),weight:((a=t.weight)==null?void 0:a.toString())||"",notes:t.notes||""}),N(!0)},ue=t=>{H(t),r(!0)},xe=t=>{H(t),alert(`${t.bankNumber} numaralı kumbara için toplama işlemi başlatılacak.`)},he=t=>{ne(t),v(!0)},pe=()=>{o(!0)},ge=t=>{le(t),G(!0)},be=t=>{if(t&&t.bankNumber){const a=d.find(i=>i.bankNumber===t.bankNumber);a?X(a):alert("Kumbara bulunamadı!")}o(!1)},ye=t=>{t.preventDefault();const a=parseFloat(s.capacity),i=s.weight?parseFloat(s.weight):void 0;if(Q)M(d.map(h=>h.id===Q.id?{...h,...s,capacity:a,weight:i,lastModified:new Date().toISOString().split("T")[0],modifiedBy:"Admin"}:h));else{const h=we(d),C=se({bankNumber:s.bankNumber||h,assignedTo:s.assignedTo,location:s.location,contactPerson:s.contactPerson,contactPhone:s.contactPhone}),T={id:Date.now().toString(),...s,bankNumber:s.bankNumber||h,capacity:a,weight:i,assignedDate:new Date().toISOString().split("T")[0],initialAmount:0,currentAmount:0,totalCollected:0,collectionCount:0,averageCollection:0,status:"aktif",qrCode:C,assignedBy:"Admin",createdDate:new Date().toISOString().split("T")[0],lastModified:new Date().toISOString().split("T")[0],modifiedBy:"Admin"};M([...d,T])}N(!1),F(null),ee()},ee=()=>{x({bankNumber:"",assignedTo:"",location:"",locationDetails:"",address:"",contactPerson:"",contactPhone:"",contactEmail:"",bankType:"standart",material:"plastik",capacity:"",weight:"",notes:""})},je=()=>{F(null),ee();const t=(d.length+1).toString().padStart(3,"0");x(a=>({...a,bankNumber:`KB-2024-${t}`})),N(!0)},te=[...new Set(d.map(t=>t.location))];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Kumbara Takibi"}),e.jsxs("div",{className:"flex border rounded",children:[e.jsx("button",{onClick:()=>L("banks"),className:`px-4 py-2 text-sm ${f==="banks"?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"Kumbaralar"}),e.jsx("button",{onClick:()=>L("collections"),className:`px-4 py-2 text-sm ${f==="collections"?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"Toplamalar"}),e.jsx("button",{onClick:()=>L("assignments"),className:`px-4 py-2 text-sm ${f==="assignments"?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"Atamalar"}),e.jsx("button",{onClick:()=>L("analytics"),className:`px-4 py-2 text-sm ${f==="analytics"?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`,children:"Analitik"})]})]}),f==="banks"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:pe,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 flex items-center gap-2",children:[e.jsx(De,{className:"w-4 h-4"}),"QR Tara"]}),e.jsx("button",{onClick:je,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Yeni Kumbara"})]})]}),f==="banks"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-600",children:"Toplam Kumbara"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:b})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-green-600",children:"Aktif"}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:_})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-purple-600",children:"Dolu"}),e.jsx("p",{className:"text-2xl font-bold text-purple-900",children:$})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-yellow-600",children:"Bakımda"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:E})]}),e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-red-600",children:"Kayıp"}),e.jsx("p",{className:"text-2xl font-bold text-red-900",children:q})]}),e.jsxs("div",{className:"bg-indigo-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-indigo-600",children:"Mevcut Tutar"}),e.jsxs("p",{className:"text-2xl font-bold text-indigo-900",children:[V.toLocaleString("tr-TR")," ₺"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6",children:[e.jsx("input",{value:c,onChange:t=>l(t.target.value),className:"border rounded px-3 py-2",placeholder:"Kumbara no, yer adı ile ara..."}),e.jsxs("select",{value:j,onChange:t=>w(t.target.value),className:"border rounded px-3 py-2",children:[e.jsx("option",{value:"",children:"Tüm Durumlar"}),e.jsx("option",{value:"aktif",children:"Aktif"}),e.jsx("option",{value:"dolu",children:"Dolu"}),e.jsx("option",{value:"bakımda",children:"Bakımda"}),e.jsx("option",{value:"kayıp",children:"Kayıp"}),e.jsx("option",{value:"iptal",children:"İptal"})]}),e.jsxs("select",{value:u,onChange:t=>S(t.target.value),className:"border rounded px-3 py-2",children:[e.jsx("option",{value:"",children:"Tüm Lokasyonlar"}),te.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("select",{value:y,onChange:t=>B(t.target.value),className:"border rounded px-3 py-2",children:[e.jsx("option",{value:"",children:"Tüm Tipler"}),e.jsx("option",{value:"standart",children:"Standart"}),e.jsx("option",{value:"büyük",children:"Büyük"}),e.jsx("option",{value:"özel",children:"Özel"}),e.jsx("option",{value:"dijital",children:"Dijital"})]}),e.jsx("button",{onClick:()=>Se("kumbaralar.csv",g),className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Excel İndir"})]}),e.jsx(z,{columns:de,data:g})]}),f==="collections"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4",children:e.jsx("input",{value:c,onChange:t=>l(t.target.value),className:"border rounded px-3 py-2 w-full max-w-md",placeholder:"Kumbara no, toplayan kişi ile ara..."})}),e.jsx(z,{columns:W,data:re})]}),f==="assignments"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4",children:e.jsx("input",{value:c,onChange:t=>l(t.target.value),className:"border rounded px-3 py-2 w-full max-w-md",placeholder:"Atanan yer, kişi ile ara..."})}),e.jsx(z,{columns:me,data:ie})]}),f==="analytics"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-medium text-blue-600 mb-2",children:"Toplam Gelir"}),e.jsxs("p",{className:"text-3xl font-bold text-blue-900",children:[Y.toLocaleString("tr-TR")," ₺"]}),e.jsx("p",{className:"text-sm text-blue-600 mt-1",children:"Tüm toplamalar"})]}),e.jsxs("div",{className:"bg-green-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-medium text-green-600 mb-2",children:"Mevcut Tutar"}),e.jsxs("p",{className:"text-3xl font-bold text-green-900",children:[V.toLocaleString("tr-TR")," ₺"]}),e.jsx("p",{className:"text-sm text-green-600 mt-1",children:"Kumbaralarda"})]}),e.jsxs("div",{className:"bg-purple-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-medium text-purple-600 mb-2",children:"Kumbara Başına"}),e.jsxs("p",{className:"text-3xl font-bold text-purple-900",children:[oe.toLocaleString("tr-TR")," ₺"]}),e.jsx("p",{className:"text-sm text-purple-600 mt-1",children:"Ortalama gelir"})]}),e.jsxs("div",{className:"bg-orange-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-medium text-orange-600 mb-2",children:"Toplama Başına"}),e.jsxs("p",{className:"text-3xl font-bold text-orange-900",children:[ce.toLocaleString("tr-TR")," ₺"]}),e.jsx("p",{className:"text-sm text-orange-600 mt-1",children:"Ortalama tutar"})]})]}),e.jsxs("div",{className:"bg-white border rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Kumbara Durum Dağılımı"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"border rounded p-4",children:[e.jsx("div",{className:"text-sm font-medium text-green-600 mb-1",children:"Aktif"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:_}),e.jsxs("div",{className:"text-sm text-gray-500",children:["%",b>0?Math.round(_/b*100):0]})]}),e.jsxs("div",{className:"border rounded p-4",children:[e.jsx("div",{className:"text-sm font-medium text-blue-600 mb-1",children:"Dolu"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:$}),e.jsxs("div",{className:"text-sm text-gray-500",children:["%",b>0?Math.round($/b*100):0]})]}),e.jsxs("div",{className:"border rounded p-4",children:[e.jsx("div",{className:"text-sm font-medium text-yellow-600 mb-1",children:"Bakımda"}),e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:E}),e.jsxs("div",{className:"text-sm text-gray-500",children:["%",b>0?Math.round(E/b*100):0]})]}),e.jsxs("div",{className:"border rounded p-4",children:[e.jsx("div",{className:"text-sm font-medium text-red-600 mb-1",children:"Kayıp"}),e.jsx("div",{className:"text-2xl font-bold text-red-600",children:q}),e.jsxs("div",{className:"text-sm text-gray-500",children:["%",b>0?Math.round(q/b*100):0]})]}),e.jsxs("div",{className:"border rounded p-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600 mb-1",children:"İptal"}),e.jsx("div",{className:"text-2xl font-bold text-gray-600",children:g.filter(t=>t.status==="iptal").length}),e.jsxs("div",{className:"text-sm text-gray-500",children:["%",b>0?Math.round(g.filter(t=>t.status==="iptal").length/b*100):0]})]})]})]}),e.jsxs("div",{className:"bg-white border rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Lokasyon Performansı"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-2",children:"Lokasyon"}),e.jsx("th",{className:"text-right py-2",children:"Kumbara Sayısı"}),e.jsx("th",{className:"text-right py-2",children:"Toplam Gelir"}),e.jsx("th",{className:"text-right py-2",children:"Ortalama"}),e.jsx("th",{className:"text-right py-2",children:"Mevcut Tutar"})]})}),e.jsx("tbody",{children:te.map(t=>{const a=g.filter(T=>T.location===t),i=a.reduce((T,U)=>T+U.totalCollected,0),h=a.reduce((T,U)=>T+U.currentAmount,0),C=a.length>0?i/a.length:0;return e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-2",children:t}),e.jsx("td",{className:"text-right py-2",children:a.length}),e.jsxs("td",{className:"text-right py-2",children:[i.toLocaleString("tr-TR")," ₺"]}),e.jsxs("td",{className:"text-right py-2",children:[C.toLocaleString("tr-TR")," ₺"]}),e.jsxs("td",{className:"text-right py-2",children:[h.toLocaleString("tr-TR")," ₺"]})]},t)})})]})})]}),e.jsxs("div",{className:"bg-white border rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Kumbara Tipi Analizi"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:["standart","büyük","özel","dijital"].map(t=>{const a=g.filter(C=>C.bankType===t),i=a.reduce((C,T)=>C+T.totalCollected,0),h=a.length>0?i/a.length:0;return e.jsxs("div",{className:"border rounded p-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-600 mb-1",children:t}),e.jsxs("div",{className:"text-xl font-bold text-gray-900",children:[a.length," adet"]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[i.toLocaleString("tr-TR")," ₺"]}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Ort: ",h.toLocaleString("tr-TR")," ₺"]})]},t)})})]})]})]}),e.jsx(O,{isOpen:D,onClose:()=>N(!1),title:Q?"Kumbara Düzenle":"Yeni Kumbara",children:e.jsxs("form",{onSubmit:ye,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Kumbara Numarası *"}),e.jsx("input",{type:"text",value:s.bankNumber,onChange:t=>x({...s,bankNumber:t.target.value}),className:"w-full border rounded px-3 py-2",placeholder:"KB-2024-001",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Atanan Yer *"}),e.jsx("input",{type:"text",value:s.assignedTo,onChange:t=>x({...s,assignedTo:t.target.value}),className:"w-full border rounded px-3 py-2",placeholder:"Market, Cami, Okul vb.",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Lokasyon *"}),e.jsx("input",{type:"text",value:s.location,onChange:t=>x({...s,location:t.target.value}),className:"w-full border rounded px-3 py-2",placeholder:"İlçe/İl",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Lokasyon Detayı"}),e.jsx("input",{type:"text",value:s.locationDetails,onChange:t=>x({...s,locationDetails:t.target.value}),className:"w-full border rounded px-3 py-2",placeholder:"Kasa yanı, giriş holü vb."})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tam Adres"}),e.jsx("input",{type:"text",value:s.address,onChange:t=>x({...s,address:t.target.value}),className:"w-full border rounded px-3 py-2",placeholder:"Mahalle, Cadde/Sokak No, İlçe/İl"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"İletişim Kişisi *"}),e.jsx("input",{type:"text",value:s.contactPerson,onChange:t=>x({...s,contactPerson:t.target.value}),className:"w-full border rounded px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Telefon *"}),e.jsx("input",{type:"tel",value:s.contactPhone,onChange:t=>x({...s,contactPhone:t.target.value}),className:"w-full border rounded px-3 py-2",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"E-posta"}),e.jsx("input",{type:"email",value:s.contactEmail,onChange:t=>x({...s,contactEmail:t.target.value}),className:"w-full border rounded px-3 py-2"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Kumbara Tipi"}),e.jsxs("select",{value:s.bankType,onChange:t=>x({...s,bankType:t.target.value}),className:"w-full border rounded px-3 py-2",children:[e.jsx("option",{value:"standart",children:"Standart"}),e.jsx("option",{value:"büyük",children:"Büyük"}),e.jsx("option",{value:"özel",children:"Özel"}),e.jsx("option",{value:"dijital",children:"Dijital"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Malzeme"}),e.jsxs("select",{value:s.material,onChange:t=>x({...s,material:t.target.value}),className:"w-full border rounded px-3 py-2",children:[e.jsx("option",{value:"plastik",children:"Plastik"}),e.jsx("option",{value:"metal",children:"Metal"}),e.jsx("option",{value:"cam",children:"Cam"}),e.jsx("option",{value:"karton",children:"Karton"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Kapasite (₺) *"}),e.jsx("input",{type:"number",step:"0.01",value:s.capacity,onChange:t=>x({...s,capacity:t.target.value}),className:"w-full border rounded px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ağırlık (kg)"}),e.jsx("input",{type:"number",step:"0.1",value:s.weight,onChange:t=>x({...s,weight:t.target.value}),className:"w-full border rounded px-3 py-2"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notlar"}),e.jsx("textarea",{value:s.notes,onChange:t=>x({...s,notes:t.target.value}),className:"w-full border rounded px-3 py-2",rows:3,placeholder:"Kumbara hakkında notlar..."})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>N(!1),className:"px-4 py-2 border rounded hover:bg-gray-50",children:"İptal"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:Q?"Güncelle":"Oluştur"})]})]})}),e.jsx(O,{isOpen:A,onClose:()=>r(!1),title:`${R==null?void 0:R.bankNumber} - Toplama Geçmişi`,children:R&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-gray-50 p-4 rounded",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Toplam Toplama:"}),e.jsx("span",{className:"ml-2 font-medium",children:R.collectionCount})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Toplam Gelir:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[R.totalCollected.toLocaleString("tr-TR")," ₺"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Ortalama:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[R.averageCollection.toLocaleString("tr-TR")," ₺"]})]})]})}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:e.jsx(z,{columns:W,data:p.filter(t=>t.bankId===R.id)})})]})}),P&&e.jsx(Re,{isOpen:K,onClose:()=>v(!1),address:P.address||P.location,bankNumber:P.bankNumber,assignedTo:P.assignedTo}),e.jsx(Ce,{isOpen:I,onClose:()=>o(!1),onScanSuccess:be}),J&&e.jsx(Ae,{isOpen:k,onClose:()=>G(!1),bank:J})]})}export{$e as default};
