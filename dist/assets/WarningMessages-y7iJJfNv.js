import{r as o,j as e,t as x,m as w,S as v,K as u}from"./index-JhQGfP3r.js";import{D as k}from"./DataTable-ZpmiLouZ.js";import{e as A}from"./exportToCsv-CTUkvpR5.js";const C=[{id:"1",message:"Kullanıcı adı veya şifre hatalı",url:"http://172.29.188.109/login",lastOccurrence:"09.08.2025 02:01:09",repeatCount:6,ipAddress:"172.29.188.109",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64)",severity:"Medium"},{id:"2",message:'Hızlı geri bildirim için tanımlı kategori bulunamadı. Ayrıca "İş Kategorisi " içindeki "İş Kaydı Birimleri " sekmesindeki birimlerde "Hızlı Geri Bildirim Yapılabilir" işaretlenmiş olmalıdır. Lütfen sistem yöneticinizle iletişime geçiniz.',url:"http://172.29.188.109/crea/feedback",lastOccurrence:"06.08.2025 19:42:59",repeatCount:1,ipAddress:"172.29.188.109",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64)",severity:"High"},{id:"3",message:"Kullanıcı adı veya şifre hatalı",url:"http://172.29.178.79/login",lastOccurrence:"24.07.2025 13:04:34",repeatCount:2,ipAddress:"172.29.178.79",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_0)",severity:"Medium"},{id:"4",message:"Kullanıcı adı veya şifre hatalı",url:"http://172.22.217.56/login",lastOccurrence:"12.07.2025 01:56:45",repeatCount:7,ipAddress:"172.22.217.56",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64)",severity:"High"},{id:"5",message:"Şifreler uyuşmuyor",url:"http://172.22.217.56/repassword",lastOccurrence:"17.06.2025 14:33:36",repeatCount:1,ipAddress:"172.22.217.56",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64)",severity:"Low"},{id:"6",message:"Lütfen daha önce kullanılmayan bir şifre belirleyiniz",url:"http://172.22.217.56/repassword",lastOccurrence:"17.06.2025 14:33:01",repeatCount:1,ipAddress:"172.22.217.56",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64)",severity:"Low"},{id:"7",message:"Durum bilgisi sıfır olamaz",url:"http://172.22.217.56/crea/relief/service/detail/906",lastOccurrence:"02.06.2025 15:28:12",repeatCount:3,ipAddress:"172.22.217.56",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64)",severity:"Medium"},{id:"8",message:"nurettin nicki ile giriş yapmaya çalışan kullanıcının hatalı giriş denemesinden dolayı ip engellemesi",url:"http://192.168.48.44/login",lastOccurrence:"12.05.2025 04:43:51",repeatCount:1,ipAddress:"192.168.48.44",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64)",severity:"Critical"}];function W(){const[a,g]=o.useState(""),[i,p]=o.useState("all"),[l,h]=o.useState(""),r=o.useMemo(()=>{let s=C;return i!=="all"&&(s=s.filter(t=>t.severity===i)),l&&(s=s.filter(t=>t.ipAddress.includes(l))),a&&(s=s.filter(t=>JSON.stringify(t).toLowerCase().includes(a.toLowerCase()))),s},[a,i,l]),f=[{key:"message",header:"Uyarı Mesajı",render:s=>e.jsx("div",{className:"max-w-md",children:e.jsx("p",{className:"text-sm truncate",title:String(s||""),children:String(s||"")})})},{key:"url",header:"URL",render:s=>e.jsx("div",{className:"max-w-xs",children:e.jsx("p",{className:"text-sm text-blue-600 truncate",title:String(s||""),children:String(s||"")})})},{key:"lastOccurrence",header:"Son Oluşma"},{key:"repeatCount",header:"Tekrar",render:s=>{const t=Number(s)||0;return e.jsx("span",{className:`font-medium ${t>5?"text-red-600":t>2?"text-yellow-600":"text-gray-600"}`,children:t})}},{key:"ipAddress",header:"IP Adresi"},{key:"severity",header:"Önem",render:s=>{const t={Low:"bg-gray-100 text-gray-700",Medium:"bg-yellow-100 text-yellow-700",High:"bg-orange-100 text-orange-700",Critical:"bg-red-100 text-red-700"},d={Low:"Düşük",Medium:"Orta",High:"Yüksek",Critical:"Kritik"},c=String(s||"Low");return e.jsx("span",{className:`rounded-full px-2 py-1 text-xs ${t[c]||t.Low}`,children:d[c]||d.Low})}},{key:"actions",header:"İşlemler",render:()=>e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{className:"rounded p-1 text-red-600 hover:bg-red-50",title:"Sil",children:e.jsx(x,{className:"h-4 w-4"})})})}],m=["Low","Medium","High","Critical"],n=r.length,j=r.filter(s=>s.severity==="Critical").length,y=r.reduce((s,t)=>s+t.repeatCount,0);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto rounded border p-2",children:[e.jsxs("button",{className:"flex items-center gap-2 rounded bg-red-600 px-3 py-1 text-sm text-white",children:[e.jsx(x,{className:"h-4 w-4"}),"Tümünü Sil"]}),e.jsxs("button",{className:"flex items-center gap-2 rounded bg-blue-600 px-3 py-1 text-sm text-white",children:[e.jsx(w,{className:"h-4 w-4"}),"Yenile"]}),e.jsxs("select",{value:i,onChange:s=>p(s.target.value),className:"rounded border bg-background px-2 py-1 text-sm",children:[e.jsx("option",{value:"all",children:"Tüm Önem Seviyeleri"}),m.map(s=>e.jsx("option",{value:s,children:s==="Low"?"Düşük":s==="Medium"?"Orta":s==="High"?"Yüksek":"Kritik"},s))]}),e.jsx("input",{value:l,onChange:s=>h(s.target.value),className:"w-40 rounded border px-2 py-1 text-sm",placeholder:"IP Adresi"}),e.jsx("input",{value:a,onChange:s=>g(s.target.value),className:"min-w-64 flex-1 rounded border px-2 py-1 text-sm",placeholder:"Uyarı mesajı ara..."}),e.jsxs("button",{className:"flex items-center gap-2 rounded bg-green-600 px-3 py-1 text-sm text-white",children:[e.jsx(v,{className:"h-4 w-4"}),"Ara"]}),e.jsx("button",{onClick:()=>A("uyari-mesajlari.csv",r),className:"rounded bg-gray-600 px-3 py-1 text-sm text-white",children:"İndir"}),e.jsxs("div",{className:"ml-auto text-sm text-muted-foreground",children:[n," Kayıt"]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-4",children:[e.jsxs("div",{className:"rounded border bg-card p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-5 w-5 text-yellow-600"}),e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Toplam Uyarı"})]}),e.jsx("p",{className:"text-2xl font-bold",children:n})]}),e.jsxs("div",{className:"rounded border bg-card p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-5 w-5 text-red-600"}),e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Kritik Uyarılar"})]}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:j})]}),e.jsxs("div",{className:"rounded border bg-card p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Toplam Tekrar"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:y})]}),e.jsxs("div",{className:"rounded border bg-card p-4",children:[e.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Benzersiz IP"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:new Set(r.map(s=>s.ipAddress)).size})]})]}),e.jsxs("div",{className:"rounded border bg-card p-4",children:[e.jsx("h3",{className:"mb-3 text-lg font-semibold",children:"Uyarı Türleri Dağılımı"}),e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-4",children:m.map(s=>{const t=r.filter(b=>b.severity===s).length,d=n>0?(t/n*100).toFixed(1):0,c=s==="Low"?"Düşük":s==="Medium"?"Orta":s==="High"?"Yüksek":"Kritik",N=s==="Low"?"text-gray-600":s==="Medium"?"text-yellow-600":s==="High"?"text-orange-600":"text-red-600";return e.jsxs("div",{className:"rounded border p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:c}),e.jsx("span",{className:`text-lg font-bold ${N}`,children:t})]}),e.jsxs("div",{className:"mt-1 text-xs text-muted-foreground",children:["%",d]})]},s)})})]}),e.jsx(k,{columns:f,data:r})]})}export{W as default};
