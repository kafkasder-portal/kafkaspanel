import{v as O,r as f,j as e,Q as U,X as E,aJ as S,K as z,U as T,M as G,B as Q,P as H,a4 as I,i as K,aK as P,T as q,l as X,n as V,S as J}from"./index-JhQGfP3r.js";import{u as W}from"./useUserManagement-DYDp8Nlo.js";import{M}from"./Modal-Ul9aPZYl.js";import{P as Z}from"./pen-square-BZRlDdvk.js";import{E as ee}from"./eye-off-DpgB4qnf.js";import{E as ae}from"./eye-Bcuk08KK.js";const L=O("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);function te({isOpen:s,onClose:c,user:a,onRoleChange:n}){var x;const[l,p]=f.useState(a.role),[i,m]=f.useState(""),[t,d]=f.useState(!1),[y,j]=f.useState(null),N=["super_admin","admin","manager","coordinator","operator","viewer"],k=r=>({super_admin:"Sistemin tüm özelliklerine erişim ve tüm yetkileri",admin:"Kullanıcı yönetimi ve sistem ayarları dahil geniş yetkiler",manager:"Departman yönetimi ve onay süreçlerinde yetki",coordinator:"Proje koordinasyonu ve takım yönetimi yetkileri",operator:"Günlük operasyonel işlemler için temel yetkiler",viewer:"Sadece görüntüleme yetkisi, değişiklik yapamaz"})[r]||"",w=r=>({super_admin:"border-red-300 bg-red-50 text-red-800",admin:"border-orange-300 bg-orange-50 text-orange-800",manager:"border-purple-300 bg-purple-50 text-purple-800",coordinator:"border-blue-300 bg-blue-50 text-blue-800",operator:"border-green-300 bg-green-50 text-green-800",viewer:"border-gray-300 bg-gray-50 text-gray-800"})[r]||"border-gray-300 bg-gray-50 text-gray-800",g=async r=>{if(r.preventDefault(),l===a.role){j("Lütfen farklı bir rol seçin");return}d(!0),j(null);try{const u=await n(a.id,l,i.trim()||void 0);u.success?c():j(u.error||"Rol değiştirme işlemi başarısız")}catch(u){j(u instanceof Error?u.message:"Beklenmeyen bir hata oluştu")}finally{d(!1)}},v=()=>{t||(j(null),p(a.role),m(""),c())};return e.jsx(M,{isOpen:s,onClose:v,children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(U,{className:"h-6 w-6 text-purple-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Kullanıcı Rolünü Değiştir"})]}),e.jsx("button",{onClick:v,disabled:t,className:"text-gray-400 hover:text-gray-600 disabled:cursor-not-allowed",children:e.jsx(E,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:g,className:"p-6 space-y-6",children:[e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-indigo-100 flex items-center justify-center",children:e.jsx("span",{className:"text-indigo-600 font-medium text-lg",children:((x=a.full_name)==null?void 0:x.charAt(0))||a.email.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900",children:a.full_name||a.email}),e.jsx("p",{className:"text-sm text-gray-500",children:a.email}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Mevcut Rol: ",e.jsx("span",{className:"font-medium",children:S(a.role)})]})]})]})}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(z,{className:"h-5 w-5 text-blue-400"}),e.jsx("div",{className:"ml-3",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Bilgi:"})," Rol atama işlevi devre dışı bırakılmıştır. Tüm kullanıcılar otomatik olarak tam yetkiye sahiptir."]})})]})}),y&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(z,{className:"h-5 w-5 text-red-400"}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-800",children:y})})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Yeni Rol Seçin"}),e.jsx("div",{className:"space-y-3",children:N.map(r=>e.jsxs("label",{className:`relative flex cursor-pointer rounded-lg border p-4 hover:bg-gray-50 ${l===r?w(r):"border-gray-300"} opacity-50 cursor-not-allowed`,children:[e.jsx("input",{type:"radio",name:"role",value:r,checked:l===r,onChange:u=>p(u.target.value),disabled:!0,className:"sr-only"}),e.jsxs("div",{className:"flex w-full items-start",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`h-5 w-5 rounded-full border-2 flex items-center justify-center ${l===r?"border-current bg-current":"border-gray-300"}`,children:l===r&&e.jsx("div",{className:"h-2 w-2 bg-white rounded-full"})})}),e.jsxs("div",{className:"ml-3 flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"font-medium",children:S(r)}),r===a.role&&e.jsx("span",{className:"text-xs px-2 py-1 bg-blue-100 text-blue-600 rounded-full",children:"Mevcut"}),e.jsx("span",{className:"text-xs px-2 py-1 bg-red-100 text-red-600 rounded-full",children:"Yetki Yok"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:k(r)})]})]})]},r))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"reason",className:"block text-sm font-medium text-gray-700 mb-2",children:"Değişiklik Nedeni (Opsiyonel)"}),e.jsx("textarea",{id:"reason",value:i,onChange:r=>m(r.target.value),disabled:t,rows:3,placeholder:"Bu rol değişikliğinin nedenini açıklayın...",className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500 disabled:bg-gray-50 disabled:cursor-not-allowed"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Bu bilgi rol değişiklik loglarında saklanacak"})]}),l!==a.role&&e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(z,{className:"h-5 w-5 text-amber-400"}),e.jsx("div",{className:"ml-3",children:e.jsxs("p",{className:"text-sm text-amber-800",children:[e.jsx("strong",{children:"Dikkat:"})," Rol değişikliği kullanıcının sistem erişim yetkilerini değiştirecek. Bu işlem geri alınamaz ve kullanıcı yeni rolüne göre yetkilendirilecek."]})})]})}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:v,disabled:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50",children:"İptal"}),e.jsx("button",{type:"submit",disabled:t||l===a.role||!0,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 border border-transparent rounded-md hover:bg-purple-700 disabled:cursor-not-allowed disabled:opacity-50",children:t?"Güncelleniyor...":"Rolü Değiştir"})]})]})]})})}function le({isOpen:s,onClose:c,user:a,onSave:n}){var w;const[l,p]=f.useState({full_name:a.full_name||"",email:a.email||"",department:a.department||"",phone:a.phone||""}),[i,m]=f.useState(!1),[t,d]=f.useState(null),y=g=>{const{name:v,value:x}=g.target;p(r=>({...r,[v]:x}))},j=async g=>{if(g.preventDefault(),!l.full_name.trim()){d("Ad Soyad alanı zorunludur");return}if(!l.email.trim()){d("E-posta alanı zorunludur");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l.email)){d("Geçerli bir e-posta adresi giriniz");return}m(!0),d(null);try{const x=await n(a.id,{full_name:l.full_name.trim(),email:l.email.trim(),department:l.department.trim()||null,phone:l.phone.trim()||null});x.success?c():d(x.error||"Profil güncellenirken hata oluştu")}catch(x){d(x instanceof Error?x.message:"Beklenmeyen bir hata oluştu")}finally{m(!1)}},N=()=>{i||(d(null),p({full_name:a.full_name||"",email:a.email||"",department:a.department||"",phone:a.phone||""}),c())},k=()=>l.full_name!==(a.full_name||"")||l.email!==(a.email||"")||l.department!==(a.department||"")||l.phone!==(a.phone||"");return e.jsx(M,{isOpen:s,onClose:N,children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(T,{className:"h-6 w-6 text-blue-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Profil Düzenle"})]}),e.jsx("button",{onClick:N,disabled:i,className:"text-gray-400 hover:text-gray-600 disabled:cursor-not-allowed",children:e.jsx(E,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:j,className:"p-6 space-y-4",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"h-16 w-16 rounded-full bg-indigo-100 flex items-center justify-center",children:e.jsx("span",{className:"text-indigo-600 font-medium text-xl",children:((w=l.full_name)==null?void 0:w.charAt(0))||a.email.charAt(0).toUpperCase()})})}),t&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:e.jsx("p",{className:"text-sm text-red-800",children:t})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"full_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Ad Soyad *"}),e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"text",id:"full_name",name:"full_name",value:l.full_name,onChange:y,disabled:i,required:!0,className:"pl-10 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500 disabled:bg-gray-50 disabled:cursor-not-allowed",placeholder:"Ad ve soyadınızı giriniz"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"E-posta *"}),e.jsxs("div",{className:"relative",children:[e.jsx(G,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"email",id:"email",name:"email",value:l.email,onChange:y,disabled:i,required:!0,className:"pl-10 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500 disabled:bg-gray-50 disabled:cursor-not-allowed",placeholder:"E-posta adresinizi giriniz"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"department",className:"block text-sm font-medium text-gray-700 mb-1",children:"Departman"}),e.jsxs("div",{className:"relative",children:[e.jsx(Q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"text",id:"department",name:"department",value:l.department,onChange:y,disabled:i,className:"pl-10 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500 disabled:bg-gray-50 disabled:cursor-not-allowed",placeholder:"Departmanınızı giriniz"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefon"}),e.jsxs("div",{className:"relative",children:[e.jsx(H,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"tel",id:"phone",name:"phone",value:l.phone,onChange:y,disabled:i,className:"pl-10 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500 disabled:bg-gray-50 disabled:cursor-not-allowed",placeholder:"Telefon numaranızı giriniz"})]})]}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Not:"})," E-posta adresi değişikliği kullanıcının giriş bilgilerini etkileyecektir."]})}),e.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:N,disabled:i,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50",children:"İptal"}),e.jsxs("button",{type:"submit",disabled:i||!k(),className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-50",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),i?"Kaydediliyor...":"Kaydet"]})]})]})]})})}function se({statistics:s}){const c={super_admin:"text-red-600 bg-red-50 border-red-200",admin:"text-orange-600 bg-orange-50 border-orange-200",manager:"text-purple-600 bg-purple-50 border-purple-200",coordinator:"text-blue-600 bg-blue-50 border-blue-200",operator:"text-green-600 bg-green-50 border-green-200",viewer:"text-gray-600 bg-gray-50 border-gray-200"},a=({title:n,value:l,icon:p,color:i="text-blue-600 bg-blue-50",change:m})=>e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:n}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l}),m!==void 0&&e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(q,{className:"h-3 w-3 text-green-500 mr-1"}),e.jsxs("span",{className:"text-xs text-green-600",children:["+",m," bu hafta"]})]})]}),e.jsx("div",{className:`p-3 rounded-full ${i}`,children:e.jsx(p,{className:"h-6 w-6"})})]})});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(a,{title:"Toplam Kullanıcı",value:s.total,icon:K,color:"text-blue-600 bg-blue-50",change:s.recentSignups}),e.jsx(a,{title:"Aktif Kullanıcı",value:s.active,icon:P,color:"text-green-600 bg-green-50"}),e.jsx(a,{title:"Pasif Kullanıcı",value:s.inactive,icon:L,color:"text-red-600 bg-red-50"}),e.jsx(a,{title:"Yönetici Sayısı",value:s.byRole.admin+s.byRole.super_admin,icon:U,color:"text-purple-600 bg-purple-50"})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Rol Dağılımı"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:Object.entries(s.byRole).map(([n,l])=>e.jsx("div",{className:`p-4 rounded-lg border-2 ${c[n]}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:S(n)}),e.jsx("p",{className:"text-2xl font-bold",children:l})]}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"text-xs",children:s.total>0?`${Math.round(l/s.total*100)}%`:"0%"})})]})},n))})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Özet Bilgiler"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Kullanıcı Durumu"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Aktif Rate:"}),e.jsx("span",{className:"text-sm font-medium text-green-600",children:s.total>0?`${Math.round(s.active/s.total*100)}%`:"0%"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Bu Hafta Yeni:"}),e.jsx("span",{className:"text-sm font-medium text-blue-600",children:s.recentSignups})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Yetki Dağılımı"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Yönetici:"}),e.jsx("span",{className:"text-sm font-medium text-purple-600",children:s.byRole.admin+s.byRole.super_admin})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Operasyonel:"}),e.jsx("span",{className:"text-sm font-medium text-blue-600",children:s.byRole.manager+s.byRole.coordinator+s.byRole.operator})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Görüntüleyici:"}),e.jsx("span",{className:"text-sm font-medium text-gray-600",children:s.byRole.viewer})]})]})]})]})]})]})}function re({users:s,canManageUsers:c,onRoleChange:a,onProfileEdit:n,onStatusToggle:l,isUpdating:p}){const i=t=>({super_admin:"text-red-600 bg-red-50",admin:"text-orange-600 bg-orange-50",manager:"text-purple-600 bg-purple-50",coordinator:"text-blue-600 bg-blue-50",operator:"text-green-600 bg-green-50",viewer:"text-gray-600 bg-gray-50"})[t]||"text-gray-600 bg-gray-50",m=t=>t?new Date(t).toLocaleDateString("tr-TR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Hiçbir zaman";return e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kullanıcı"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rol"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Departman"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Durum"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Son Giriş"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kayıt Tarihi"}),c&&e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"İşlemler"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(t=>{var d;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-10 w-10 flex-shrink-0",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center",children:e.jsx("span",{className:"text-indigo-600 font-medium",children:((d=t.full_name)==null?void 0:d.charAt(0))||t.email.charAt(0).toUpperCase()})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.full_name||t.email}),e.jsx("div",{className:"text-sm text-gray-500",children:t.email})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${i(t.role)}`,children:S(t.role)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.department||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex items-center",children:t.is_active?e.jsxs("div",{className:"flex items-center text-green-600",children:[e.jsx(P,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"text-sm",children:"Aktif"})]}):e.jsxs("div",{className:"flex items-center text-red-600",children:[e.jsx(L,{className:"h-4 w-4 mr-1"}),e.jsx("span",{className:"text-sm",children:"Pasif"})]})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:m(t.last_sign_in_at)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:m(t.created_at)}),c&&e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[e.jsx("button",{onClick:()=>n(t),className:"text-indigo-600 hover:text-indigo-900",title:"Profil Düzenle",children:e.jsx(Z,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>a(t),className:"text-purple-600 hover:text-purple-900",title:"Rol Değiştir",children:e.jsx(U,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>l(t.id,!t.is_active),disabled:p,className:`${t.is_active?"text-red-600 hover:text-red-900":"text-green-600 hover:text-green-900"} ${p?"opacity-50 cursor-not-allowed":""}`,title:t.is_active?"Pasif Yap":"Aktif Yap",children:t.is_active?e.jsx(ee,{className:"h-4 w-4"}):e.jsx(ae,{className:"h-4 w-4"})})]})})]},t.id)})})]}),s.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(K,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Kullanıcı bulunamadı"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Henüz hiç kullanıcı kaydedilmemiş veya arama kriterlerinize uygun kullanıcı yok."})]})]})}function xe(){var A;const{users:s,permissions:c,statistics:a,selectedUser:n,isLoading:l,isUpdating:p,error:i,showRoleModal:m,showProfileModal:t,handleRoleChange:d,handleProfileUpdate:y,handleStatusToggle:j,selectUserForRoleChange:N,selectUserForProfileEdit:k,closeModals:w,search:g,refetchUsers:v}=W(),[x,r]=f.useState("all"),[u,$]=f.useState("all"),Y=!0,C=s.filter(h=>{var b,o;const R=g.searchQuery.length<=2||h.email.toLowerCase().includes(g.searchQuery.toLowerCase())||((b=h.full_name)==null?void 0:b.toLowerCase().includes(g.searchQuery.toLowerCase()))||((o=h.department)==null?void 0:o.toLowerCase().includes(g.searchQuery.toLowerCase())),_=x==="all"||h.role===x,D=u==="all"||u==="active"&&h.is_active||u==="inactive"&&!h.is_active;return R&&_&&D}),B=()=>{const h=["Ad Soyad","Email","Rol","Departman","Durum","Son Giriş","Kayıt Tarihi"],R=C.map(o=>[o.full_name||o.email,o.email,S(o.role),o.department||"",o.is_active?"Aktif":"Pasif",o.last_sign_in_at?new Date(o.last_sign_in_at).toLocaleDateString("tr-TR"):"Hiçbir zaman",new Date(o.created_at).toLocaleDateString("tr-TR")]),_=[h,...R].map(o=>o.map(F=>`"${F}"`).join(",")).join(`
`),D=new Blob([_],{type:"text/csv;charset=utf-8;"}),b=document.createElement("a");if(b.download!==void 0){const o=URL.createObjectURL(D);b.setAttribute("href",o),b.setAttribute("download",`kullanicilar-${new Date().toISOString().slice(0,10)}.csv`),b.style.visibility="hidden",document.body.appendChild(b),b.click(),document.body.removeChild(b)}};return l?e.jsx(X,{}):i?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-red-500 text-sm",children:["Kullanıcı verileri yüklenirken hata oluştu: ",i==null?void 0:i.message]}),e.jsx("button",{onClick:()=>v(),className:"mt-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Tekrar Dene"})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Kullanıcı Yönetimi"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Sistem kullanıcılarını yönetin ve rollerini düzenleyin."})]}),e.jsxs("button",{onClick:B,className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"CSV İndir"]})]}),a&&e.jsx(se,{statistics:a}),e.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(J,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx("input",{type:"text",placeholder:"Kullanıcı ara...",value:g.searchQuery,onChange:h=>g.setSearchQuery(h.target.value),className:"pl-10 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsx("div",{children:e.jsxs("select",{value:x,onChange:h=>r(h.target.value),className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"Tüm Roller"}),e.jsx("option",{value:"super_admin",children:"Süper Yönetici"}),e.jsx("option",{value:"admin",children:"Yönetici"}),e.jsx("option",{value:"manager",children:"Müdür"}),e.jsx("option",{value:"coordinator",children:"Koordinatör"}),e.jsx("option",{value:"operator",children:"Operatör"}),e.jsx("option",{value:"viewer",children:"Görüntüleyici"})]})}),e.jsx("div",{children:e.jsxs("select",{value:u,onChange:h=>$(h.target.value),className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"Tüm Durumlar"}),e.jsx("option",{value:"active",children:"Aktif"}),e.jsx("option",{value:"inactive",children:"Pasif"})]})}),e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[C.length," kullanıcı gösteriliyor"]})]})}),e.jsx("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200",children:e.jsx(re,{users:C,canManageUsers:Y,onRoleChange:N,onProfileEdit:k,onStatusToggle:j,isUpdating:p})}),m&&n&&e.jsx(te,{isOpen:m,onClose:w,user:n,onRoleChange:d,currentUserRole:(A=c==null?void 0:c.profile)==null?void 0:A.role}),t&&n&&e.jsx(le,{isOpen:t,onClose:w,user:n,onSave:y})]})}export{xe as default};
