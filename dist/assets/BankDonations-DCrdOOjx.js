import{r as o,j as e,g as f}from"./index-JhQGfP3r.js";import{D as M}from"./DataTable-ZpmiLouZ.js";import{M as g}from"./Modal-Ul9aPZYl.js";import{e as $}from"./exportToCsv-CTUkvpR5.js";import{L as O}from"./LazyCameraScanner-DfxkbHju.js";import{e as F,a as H}from"./pdfExport-BxB3yxD7.js";import{F as q}from"./jspdf.plugin.autotable-Cb0Hj5Ka.js";const P=[{id:"1",date:"2024-01-15",transactionDate:"2024-01-15",donorName:"Mehmet Yılmaz",donorIban:"TR33 0006 1005 1978 6457 8413 26",amount:2500,currency:"TRY",bankName:"Ziraat Bankası",accountName:"Dernek Genel Hesap",transactionRef:"TXN123456789",description:"EFT Gönderimi",purpose:"Genel Bağış",status:"eşleştirildi",matchedDonor:"Mehmet Yılmaz",notes:"Düzenli bağışçı"},{id:"2",date:"2024-01-14",transactionDate:"2024-01-14",donorName:"Bilinmeyen",amount:1e3,currency:"TRY",bankName:"İş Bankası",accountName:"Dernek Eğitim Hesap",transactionRef:"TXN987654321",description:"Havale",purpose:"Belirsiz",status:"beklemede",notes:"Bağışçı bilgisi eksik"}],k=[{name:"Dernek Genel Hesap",iban:"TR33 0006 1005 1978 6457 8413 26",bank:"Ziraat Bankası"},{name:"Dernek Eğitim Hesap",iban:"TR64 0001 2009 4520 0058 0012 34",bank:"İş Bankası"},{name:"Dernek Sağlık Hesap",iban:"TR98 0004 6007 8800 0000 1234 56",bank:"Akbank"}];function Q(){const[d,u]=o.useState(P),[h,v]=o.useState(""),[y,m]=o.useState(!1),[D,p]=o.useState(!1),[x,b]=o.useState(null),[l,j]=o.useState(null),[r,a]=o.useState({donorName:"",donorIban:"",amount:"",currency:"TRY",bankName:"",accountName:"",transactionRef:"",description:"",purpose:"",notes:""}),[t,c]=o.useState({donorName:"",donorPhone:"",donorEmail:"",purpose:""}),[B,S]=o.useState(!1),i=o.useMemo(()=>d.filter(s=>JSON.stringify(s).toLowerCase().includes(h.toLowerCase())),[d,h]),R=i.reduce((s,n)=>s+n.amount,0),T=i.filter(s=>s.status==="beklemede").length,w=[{key:"transactionDate",header:"İşlem Tarihi"},{key:"transactionRef",header:"Referans No"},{key:"donorName",header:"Gönderen"},{key:"amount",header:"Tutar",render:(s,n)=>`${n.amount.toLocaleString("tr-TR")} ${n.currency}`},{key:"bankName",header:"Banka"},{key:"accountName",header:"Hesap"},{key:"description",header:"Açıklama"},{key:"purpose",header:"Amaç"},{key:"status",header:"Durum",render:(s,n)=>e.jsx("span",{className:`px-2 py-1 rounded text-xs ${n.status==="eşleştirildi"?"bg-green-100 text-green-800":n.status==="onaylandı"?"bg-blue-100 text-blue-800":n.status==="beklemede"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:n.status})},{key:"id",header:"İşlemler",render:(s,n)=>e.jsxs("div",{className:"flex gap-2",children:[n.status==="beklemede"&&e.jsx("button",{onClick:()=>E(n),className:"text-green-600 hover:text-green-800 text-sm",children:"Eşleştir"}),e.jsx("button",{onClick:()=>C(n),className:"text-blue-600 hover:text-blue-800 text-sm",children:"Düzenle"}),e.jsx("button",{onClick:()=>Y(n.id),className:"text-red-600 hover:text-red-800 text-sm",children:"Sil"})]})}],C=s=>{b(s),a({donorName:s.donorName,donorIban:s.donorIban||"",amount:s.amount.toString(),currency:s.currency,bankName:s.bankName,accountName:s.accountName,transactionRef:s.transactionRef,description:s.description,purpose:s.purpose,notes:s.notes||""}),m(!0)},E=s=>{j(s),c({donorName:s.donorName!=="Bilinmeyen"?s.donorName:"",donorPhone:"",donorEmail:"",purpose:s.purpose!=="Belirsiz"?s.purpose:""}),p(!0)},Y=s=>{confirm("Bu banka bağışını silmek istediğinizden emin misiniz?")&&u(d.filter(n=>n.id!==s))},z=s=>{if(s.preventDefault(),x)u(d.map(n=>n.id===x.id?{...n,...r,amount:parseFloat(r.amount)}:n));else{const n={id:Date.now().toString(),date:new Date().toISOString().split("T")[0],transactionDate:new Date().toISOString().split("T")[0],...r,amount:parseFloat(r.amount),status:"onaylandı"};u([...d,n])}m(!1),b(null),N()},A=s=>{s.preventDefault(),l&&u(d.map(n=>n.id===l.id?{...n,donorName:t.donorName,purpose:t.purpose,status:"eşleştirildi",matchedDonor:t.donorName}:n)),p(!1),j(null),c({donorName:"",donorPhone:"",donorEmail:"",purpose:""})},N=()=>{a({donorName:"",donorIban:"",amount:"",currency:"TRY",bankName:"",accountName:"",transactionRef:"",description:"",purpose:"",notes:""})},G=s=>{s&&(s.donorName!=null&&a(n=>({...n,donorName:s.donorName??n.donorName})),s.donorIban!=null&&a(n=>({...n,donorIban:s.donorIban??n.donorIban})),s.amount!=null&&a(n=>({...n,amount:(s.amount??Number(n.amount||0)).toString()})),s.currency!=null&&a(n=>({...n,currency:["TRY","USD","EUR"].includes(s.currency)?s.currency:n.currency})),s.bankName!=null&&a(n=>({...n,bankName:s.bankName??n.bankName})),s.transactionRef!=null&&a(n=>({...n,transactionRef:s.transactionRef??n.transactionRef})),s.description!=null&&a(n=>({...n,description:s.description??n.description})),s.purpose!=null&&a(n=>({...n,purpose:s.purpose??n.purpose})),s.notes!=null&&a(n=>({...n,notes:s.notes??n.notes})),s.firstName&&s.lastName&&a(n=>({...n,donorName:`${s.firstName} ${s.lastName}`})),s.idNumber&&a(n=>({...n,description:`TC: ${s.idNumber}`})),s.passportNumber&&a(n=>({...n,description:`Pasaport: ${s.passportNumber}`})),s.phone&&a(n=>({...n,notes:n.notes?`${n.notes} | Tel: ${s.phone}`:`Tel: ${s.phone}`})),s.address&&a(n=>({...n,notes:n.notes?`${n.notes} | Adres: ${s.address}`:`Adres: ${s.address}`})),s.birthDate&&a(n=>({...n,notes:n.notes?`${n.notes} | Doğum: ${s.birthDate}`:`Doğum: ${s.birthDate}`})),S(!1))},I=()=>{b(null),N(),m(!0)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Banka Bağışları"}),e.jsx("button",{onClick:I,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Yeni Banka Bağışı"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-600",children:"Toplam Bağış"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:i.length})]}),e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-green-600",children:"Toplam Tutar"}),e.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[R.toLocaleString("tr-TR")," ₺"]})]}),e.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-yellow-600",children:"Bekleyen"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:T})]}),e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-purple-600",children:"Bugünkü"}),e.jsx("p",{className:"text-2xl font-bold text-purple-900",children:"1"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-3",children:"Banka Hesaplarımız"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:k.map((s,n)=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.bank}),e.jsx("p",{className:"text-sm font-mono",children:s.iban})]},n))})]}),e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("input",{value:h,onChange:s=>v(s.target.value),className:"flex-1 border rounded px-3 py-2",placeholder:"Gönderen, referans no, banka ile ara..."}),e.jsxs("select",{className:"border rounded px-3 py-2",children:[e.jsx("option",{value:"",children:"Tüm Durumlar"}),e.jsx("option",{value:"eşleştirildi",children:"Eşleştirildi"}),e.jsx("option",{value:"onaylandı",children:"Onaylandı"}),e.jsx("option",{value:"beklemede",children:"Beklemede"}),e.jsx("option",{value:"iptal",children:"İptal"})]}),e.jsxs("select",{className:"border rounded px-3 py-2",children:[e.jsx("option",{value:"",children:"Tüm Bankalar"}),e.jsx("option",{value:"Ziraat Bankası",children:"Ziraat Bankası"}),e.jsx("option",{value:"İş Bankası",children:"İş Bankası"}),e.jsx("option",{value:"Akbank",children:"Akbank"})]}),e.jsx("input",{type:"date",className:"border rounded px-3 py-2"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>$("bank-donations.csv",i),className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 flex items-center gap-2",children:[e.jsx(f,{size:16}),"CSV İndir"]}),e.jsxs("button",{onClick:()=>F(i,{}),className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(q,{size:16}),"Excel İndir"]}),e.jsxs("button",{onClick:()=>H(i,{}),className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 flex items-center gap-2",children:[e.jsx(f,{size:16}),"PDF İndir"]})]})]}),e.jsx(M,{columns:w,data:i})]}),e.jsxs(g,{isOpen:y,onClose:()=>m(!1),title:x?"Banka Bağışı Düzenle":"Yeni Banka Bağışı",children:[B&&e.jsx("div",{className:"mb-4",children:e.jsx(O,{onScanResult:G,onError:s=>console.error("Tarama hatası:",s)})}),e.jsxs("form",{onSubmit:z,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gönderen Adı"}),e.jsx("input",{type:"text",value:r.donorName,onChange:s=>a({...r,donorName:s.target.value}),className:"w-full border rounded px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Gönderen IBAN"}),e.jsx("input",{type:"text",value:r.donorIban,onChange:s=>a({...r,donorIban:s.target.value}),className:"w-full border rounded px-3 py-2",placeholder:"TR33 0006 1005 1978 6457 8413 26"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tutar"}),e.jsx("input",{type:"number",step:"0.01",value:r.amount,onChange:s=>a({...r,amount:s.target.value}),className:"w-full border rounded px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Para Birimi"}),e.jsxs("select",{value:r.currency,onChange:s=>a({...r,currency:s.target.value}),className:"w-full border rounded px-3 py-2",children:[e.jsx("option",{value:"TRY",children:"TRY"}),e.jsx("option",{value:"USD",children:"USD"}),e.jsx("option",{value:"EUR",children:"EUR"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Banka"}),e.jsx("input",{type:"text",value:r.bankName,onChange:s=>a({...r,bankName:s.target.value}),className:"w-full border rounded px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Alıcı Hesap"}),e.jsxs("select",{value:r.accountName,onChange:s=>a({...r,accountName:s.target.value}),className:"w-full border rounded px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Seçiniz"}),k.map((s,n)=>e.jsx("option",{value:s.name,children:s.name},n))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Referans No"}),e.jsx("input",{type:"text",value:r.transactionRef,onChange:s=>a({...r,transactionRef:s.target.value}),className:"w-full border rounded px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"İşlem Açıklaması"}),e.jsx("input",{type:"text",value:r.description,onChange:s=>a({...r,description:s.target.value}),className:"w-full border rounded px-3 py-2",placeholder:"EFT, Havale, vb."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Bağış Amacı"}),e.jsxs("select",{value:r.purpose,onChange:s=>a({...r,purpose:s.target.value}),className:"w-full border rounded px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Seçiniz"}),e.jsx("option",{value:"Genel Bağış",children:"Genel Bağış"}),e.jsx("option",{value:"Eğitim Yardımı",children:"Eğitim Yardımı"}),e.jsx("option",{value:"Sağlık Yardımı",children:"Sağlık Yardımı"}),e.jsx("option",{value:"Gıda Yardımı",children:"Gıda Yardımı"}),e.jsx("option",{value:"Kurban",children:"Kurban"}),e.jsx("option",{value:"Ramazan",children:"Ramazan"}),e.jsx("option",{value:"Diğer",children:"Diğer"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notlar"}),e.jsx("textarea",{value:r.notes,onChange:s=>a({...r,notes:s.target.value}),className:"w-full border rounded px-3 py-2",rows:3})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>m(!1),className:"px-4 py-2 border rounded hover:bg-gray-50",children:"İptal"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:x?"Güncelle":"Kaydet"})]})]})]}),e.jsx(g,{isOpen:D,onClose:()=>p(!1),title:"Bağışçı Eşleştir",children:e.jsxs("form",{onSubmit:A,className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"İşlem Bilgileri"}),e.jsxs("p",{children:[e.jsx("strong",{children:"Tutar:"})," ",l==null?void 0:l.amount.toLocaleString("tr-TR")," ",l==null?void 0:l.currency]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Referans:"})," ",l==null?void 0:l.transactionRef]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Tarih:"})," ",l==null?void 0:l.transactionDate]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Bağışçı Adı"}),e.jsx("input",{type:"text",value:t.donorName,onChange:s=>c({...t,donorName:s.target.value}),className:"w-full border rounded px-3 py-2",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Telefon"}),e.jsx("input",{type:"tel",value:t.donorPhone,onChange:s=>c({...t,donorPhone:s.target.value}),className:"w-full border rounded px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"E-posta"}),e.jsx("input",{type:"email",value:t.donorEmail,onChange:s=>c({...t,donorEmail:s.target.value}),className:"w-full border rounded px-3 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Bağış Amacı"}),e.jsxs("select",{value:t.purpose,onChange:s=>c({...t,purpose:s.target.value}),className:"w-full border rounded px-3 py-2",required:!0,children:[e.jsx("option",{value:"",children:"Seçiniz"}),e.jsx("option",{value:"Genel Bağış",children:"Genel Bağış"}),e.jsx("option",{value:"Eğitim Yardımı",children:"Eğitim Yardımı"}),e.jsx("option",{value:"Sağlık Yardımı",children:"Sağlık Yardımı"}),e.jsx("option",{value:"Gıda Yardımı",children:"Gıda Yardımı"}),e.jsx("option",{value:"Kurban",children:"Kurban"}),e.jsx("option",{value:"Ramazan",children:"Ramazan"}),e.jsx("option",{value:"Diğer",children:"Diğer"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>p(!1),className:"px-4 py-2 border rounded hover:bg-gray-50",children:"İptal"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"Eşleştir"})]})]})})]})}export{Q as default};
