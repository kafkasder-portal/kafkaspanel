import{u as f,w as D,E as k}from"./jspdf.plugin.autotable-Cb0Hj5Ka.js";const b=a=>{const{filename:t,sheetName:n="Sheet1",columns:i,data:e,includeTimestamp:d=!0}=a,h=i.map(r=>r.label),o=e.map(r=>i.map(s=>{const w=r[s.key];return s.formatter?s.formatter(w):w})),l=[h,...o],m=f.aoa_to_sheet(l),y=i.map(r=>({wch:r.width||15}));m["!cols"]=y;const u=f.book_new();f.book_append_sheet(u,m,n);const p=d?`_${new Date().toISOString().split("T")[0]}`:"",c=`${t}${p}.xlsx`;D(u,c)},K=(a,t)=>{b({filename:t?"beneficiaries_filtered":"beneficiaries",sheetName:"Yararlanıcılar",columns:[{key:"id",label:"ID",width:10},{key:"name",label:"Ad Soyad",width:25},{key:"email",label:"E-posta",width:30},{key:"phone",label:"Telefon",width:20},{key:"address",label:"Adres",width:40},{key:"status",label:"Durum",width:15},{key:"created_at",label:"Oluşturulma Tarihi",width:20,formatter:e=>e?new Date(e).toLocaleDateString("tr-TR"):""}],data:a})},S=(a,t)=>{b({filename:t?"applications_filtered":"applications",sheetName:"Başvurular",columns:[{key:"id",label:"ID",width:10},{key:"applicant_name",label:"Başvuran",width:25},{key:"type",label:"Başvuru Türü",width:20},{key:"status",label:"Durum",width:15},{key:"amount",label:"Tutar",width:15,formatter:e=>e?`${e} TL`:""},{key:"description",label:"Açıklama",width:40},{key:"created_at",label:"Başvuru Tarihi",width:20,formatter:e=>e?new Date(e).toLocaleDateString("tr-TR"):""},{key:"updated_at",label:"Güncelleme Tarihi",width:20,formatter:e=>e?new Date(e).toLocaleDateString("tr-TR"):""}],data:a})},B=(a,t)=>{b({filename:t?"donations_filtered":"donations",sheetName:"Bağışlar",columns:[{key:"id",label:"ID",width:10},{key:"donor_name",label:"Bağışçı",width:25},{key:"amount",label:"Tutar",width:15,formatter:e=>`${e} TL`},{key:"currency",label:"Para Birimi",width:15},{key:"type",label:"Bağış Türü",width:20},{key:"status",label:"Durum",width:15},{key:"description",label:"Açıklama",width:40},{key:"donation_date",label:"Bağış Tarihi",width:20,formatter:e=>e?new Date(e).toLocaleDateString("tr-TR"):""},{key:"created_at",label:"Kayıt Tarihi",width:20,formatter:e=>e?new Date(e).toLocaleDateString("tr-TR"):""}],data:a})},T=a=>{const{title:t,subtitle:n,columns:i,data:e,filename:d,includeTimestamp:h=!0}=a,o=new k;o.setFontSize(18),o.text(t,14,22);let l=30;n&&(o.setFontSize(12),o.text(n,14,l),l+=10),o.setFontSize(10),o.text(`Rapor Tarihi: ${new Date().toLocaleDateString("tr-TR")}`,14,l),l+=15;const m=i.map(c=>c.header),y=e.map(c=>i.map(r=>{const s=c[r.dataKey];return s instanceof Date?s.toLocaleDateString("tr-TR"):s||""}));o.autoTable({head:[m],body:y,startY:l,styles:{fontSize:8,cellPadding:3},headStyles:{fillColor:[41,128,185],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{top:20}});const u=h?`_${new Date().toISOString().split("T")[0]}`:"",p=`${d}${u}.pdf`;o.save(p)},x=(a,t)=>{T({title:"Yararlanıcılar Listesi",subtitle:t?"Filtrelenmiş Liste":"Tüm Yararlanıcılar",columns:[{header:"ID",dataKey:"id"},{header:"Ad Soyad",dataKey:"name"},{header:"E-posta",dataKey:"email"},{header:"Telefon",dataKey:"phone"},{header:"Durum",dataKey:"status"},{header:"Kayıt Tarihi",dataKey:"created_at"}],data:a,filename:t?"beneficiaries_filtered":"beneficiaries"})},L=(a,t)=>{T({title:"Başvurular Listesi",subtitle:t?"Filtrelenmiş Liste":"Tüm Başvurular",columns:[{header:"ID",dataKey:"id"},{header:"Başvuran",dataKey:"applicant_name"},{header:"Tür",dataKey:"type"},{header:"Durum",dataKey:"status"},{header:"Tutar",dataKey:"amount"},{header:"Başvuru Tarihi",dataKey:"created_at"}],data:a,filename:t?"applications_filtered":"applications"})},F=(a,t)=>{T({title:"Bağışlar Listesi",subtitle:t?"Filtrelenmiş Liste":"Tüm Bağışlar",columns:[{header:"ID",dataKey:"id"},{header:"Bağışçı",dataKey:"donor_name"},{header:"Tutar",dataKey:"amount"},{header:"Para Birimi",dataKey:"currency"},{header:"Tür",dataKey:"type"},{header:"Durum",dataKey:"status"},{header:"Bağış Tarihi",dataKey:"donation_date"}],data:a,filename:t?"donations_filtered":"donations"})};export{F as a,K as b,x as c,S as d,B as e,L as f};
