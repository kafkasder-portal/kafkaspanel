import f from"./purify.es-CQJ0hv7W.js";const o={TEXT_ONLY:{allowedTags:[],allowedAttributes:[],stripTags:!0,allowHtml:!1},RICH_TEXT:{allowedTags:["p","br","strong","em","u","ol","ul","li","h1","h2","h3","h4","h5","h6"],allowedAttributes:["class"],stripTags:!1,allowHtml:!0},HTML_WITH_LINKS:{allowedTags:["p","br","strong","em","u","ol","ul","li","h1","h2","h3","h4","h5","h6","a"],allowedAttributes:["class","href","target","rel"],stripTags:!1,allowHtml:!0},EMAIL:{allowedTags:[],allowedAttributes:[],stripTags:!0,allowHtml:!1},PHONE:{allowedTags:[],allowedAttributes:[],stripTags:!0,allowHtml:!1},URL:{allowedTags:[],allowedAttributes:[],stripTags:!0,allowHtml:!1}};function n(t,e=o.TEXT_ONLY){if(!t||typeof t!="string")return"";const r={};return e.allowedTags&&(r.ALLOWED_TAGS=e.allowedTags),e.allowedAttributes&&(r.ALLOWED_ATTR=e.allowedAttributes),e.stripTags&&(r.ALLOWED_TAGS=[],r.KEEP_CONTENT=!0),r.FORBID_ATTR=["onerror","onload","onclick","onmouseover","onfocus","onblur"],r.FORBID_TAGS=["script","object","embed","form","input","textarea","select","button"],f.sanitize(t.trim(),r)}function i(t,e=o.TEXT_ONLY){if(!t||typeof t!="object")return t;const r={...t};for(const[s,l]of Object.entries(r))typeof l=="string"?r[s]=n(l,e):Array.isArray(l)?r[s]=l.map(a=>typeof a=="string"?n(a,e):typeof a=="object"?i(a,e):a):l&&typeof l=="object"&&(r[s]=i(l,e));return r}function p(t){if(!t||typeof t!="string")return"";const e=n(t,o.TEXT_ONLY);return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(e)?e:""}function d(t){return!t||typeof t!="string"?"":n(t,o.TEXT_ONLY).replace(/[^0-9+\-\s()]/g,"")}function u(t){if(!t||typeof t!="string")return!1;const e=t.trim();return!([/^YOUR_.*_URL$/i,/^PLACEHOLDER/i,/^REPLACE_WITH/i,/^\[.*\]$/,/^<.*>$/,/^\{.*\}$/,/^undefined$/i,/^null$/i,/^\s*$/].some(s=>s.test(e))||e.length<3)}function c(t){if(!t||typeof t!="string")return!1;const e=t.trim();if(!u(e))return!1;try{let r;return e.startsWith("http://")||e.startsWith("https://")?r=new URL(e):r=new URL(e,"http://localhost"),r.protocol==="http:"||r.protocol==="https:"}catch{return!1}}function h(t,e){if(!c(t))return null;try{return e?new URL(t,e):new URL(t)}catch{return null}}function w(t){if(!t||typeof t!="string")return"";const e=n(t,o.TEXT_ONLY);if(!u(e))return"";try{let r;if(e.startsWith("http://")||e.startsWith("https://"))r=new URL(e);else{const s=typeof window<"u"?window.location.origin:"http://localhost";r=new URL(e,s)}if(r.protocol==="http:"||r.protocol==="https:")return r.toString()}catch{}return""}export{o as S,i as a,p as b,d as c,w as d,h as e,c as i,n as s};
