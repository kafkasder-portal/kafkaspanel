import{r,j as e,e as O,T as G,k as W,S as Z,n as ee,h as te,aD as ae,X as se,ak as E,q as re}from"./index-JhQGfP3r.js";import{e as ne}from"./exportToCsv-CTUkvpR5.js";import{D as le}from"./DataTable-ZpmiLouZ.js";import{M as oe}from"./Modal-Ul9aPZYl.js";import{S as j}from"./StatCard-By2eovuR.js";import{u as ie,t as ce,o as de,s as c,n as me,e as pe}from"./types-DpNt5E6n.js";import{V as k}from"./index-BJu9RWF7.js";import{T as F}from"./trending-down-mje6Xvoe.js";import{C as ue}from"./calculator-BuhAK6r8.js";import{E as xe}from"./eye-Bcuk08KK.js";import{P as he}from"./pen-square-BZRlDdvk.js";const ge=de({operation_type:pe(["income","expense","transfer"],{message:"İşlem türü seçiniz"}),amount:me().min(.01,"Geçerli bir tutar giriniz"),description:c().min(1,"Açıklama giriniz"),category:c().min(1,"Kategori seçiniz"),reference_number:c().optional(),from_account:c().optional(),to_account:c().optional(),notes:c().optional()}),ye={income:["Bağış Geliri","Faiz Geliri","Kira Geliri","Diğer Gelirler"],expense:["Nakdi Yardım","Personel Gideri","Kira Gideri","Elektrik-Su","Telefon-İnternet","Kırtasiye","Diğer Giderler"],transfer:["Hesap Arası Transfer","Banka Transfer","Kasa Transfer"]};function De(){var C;const[v,w]=r.useState([]),[m,I]=r.useState({totalIncome:0,totalExpense:0,balance:0,todayOperations:0}),[A,B]=r.useState(!0),[o,M]=r.useState(""),[p,R]=r.useState("all"),[u,Y]=r.useState("all"),[x,z]=r.useState("all"),[K,i]=r.useState(!1),[S,_]=r.useState(null),{register:n,handleSubmit:L,formState:{errors:l},reset:H,watch:P}=ie({resolver:ce(ge)}),h=P("operation_type");r.useEffect(()=>{U(),T()},[]);const U=async()=>{try{const t=[{id:"1",operation_type:"income",amount:5e4,description:"Aylık bağış geliri",category:"Bağış Geliri",reference_number:"REF001",operator_id:"user1",operation_date:new Date().toISOString(),status:"completed",created_at:new Date().toISOString(),operator:{name:"Admin User",email:"admin@example.com"}},{id:"2",operation_type:"expense",amount:15e3,description:"Nakdi yardım ödemesi",category:"Nakdi Yardım",reference_number:"REF002",operator_id:"user1",operation_date:new Date().toISOString(),status:"completed",created_at:new Date().toISOString(),operator:{name:"Admin User",email:"admin@example.com"}}];w(t)}catch(t){console.error("Nakdi işlemler yüklenirken hata:",t),k.error("Nakdi işlemler yüklenirken hata oluştu")}finally{B(!1)}},T=async()=>{try{I({totalIncome:15e4,totalExpense:85e3,balance:65e3,todayOperations:5})}catch(t){console.error("İstatistikler yüklenirken hata:",t)}},N=r.useMemo(()=>v.filter(t=>{var D;const a=o===""||t.description.toLowerCase().includes(o.toLowerCase())||t.category.toLowerCase().includes(o.toLowerCase())||((D=t.reference_number)==null?void 0:D.toLowerCase().includes(o.toLowerCase())),s=p==="all"||t.operation_type===p,d=u==="all"||t.status===u;let y=!0;if(x!=="all"){const b=new Date(t.operation_date),f=new Date;switch(x){case"today":{y=b.toDateString()===f.toDateString();break}case"week":{const J=new Date(f.getTime()-6048e5);y=b>=J;break}case"month":{y=b.getMonth()===f.getMonth()&&b.getFullYear()===f.getFullYear();break}}}return a&&s&&d&&y}),[v,o,p,u,x]),$=async t=>{try{const a={id:Date.now().toString(),...t,operator_id:"current_user",operation_date:new Date().toISOString(),status:"completed",created_at:new Date().toISOString(),operator:{name:"Current User",email:"user@example.com"}};w(s=>[a,...s]),k.success("Nakdi işlem başarıyla kaydedildi"),i(!1),H(),T()}catch(a){console.error("Nakdi işlem kaydedilirken hata:",a),k.error("Nakdi işlem kaydedilirken hata oluştu")}},q=t=>{const s={income:{label:"Gelir",class:"bg-green-100 text-green-800",icon:G},expense:{label:"Gider",class:"bg-red-100 text-red-800",icon:F},transfer:{label:"Transfer",class:"bg-blue-100 text-blue-800",icon:te}}[t]||{label:t,class:"bg-gray-100 text-gray-800",icon:ae},d=s.icon;return e.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2 py-1 text-xs font-medium ${s.class}`,children:[e.jsx(d,{className:"h-3 w-3"}),s.label]})},Q=t=>{const s={pending:{label:"Beklemede",class:"bg-yellow-100 text-yellow-800",icon:re},completed:{label:"Tamamlandı",class:"bg-green-100 text-green-800",icon:E},cancelled:{label:"İptal Edildi",class:"bg-red-100 text-red-800",icon:se}}[t]||{label:t,class:"bg-gray-100 text-gray-800",icon:E},d=s.icon;return e.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2 py-1 text-xs font-medium ${s.class}`,children:[e.jsx(d,{className:"h-3 w-3"}),s.label]})},g=t=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY"}).format(t),V=t=>new Date(t).toLocaleDateString("tr-TR"),X=[{key:"operation_type",header:"İşlem Türü",render:(t,a)=>q(a.operation_type)},{key:"description",header:"Açıklama",render:(t,a)=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:a.description}),e.jsx("div",{className:"text-sm text-muted-foreground",children:a.category})]})},{key:"amount",header:"Tutar",render:(t,a)=>e.jsxs("div",{className:`font-medium ${a.operation_type==="income"?"text-green-600":a.operation_type==="expense"?"text-red-600":"text-blue-600"}`,children:[a.operation_type==="income"?"+":a.operation_type==="expense"?"-":"",g(a.amount)]})},{key:"reference_number",header:"Referans No",render:(t,a)=>a.reference_number||"-"},{key:"operation_date",header:"İşlem Tarihi",render:(t,a)=>V(a.operation_date)},{key:"status",header:"Durum",render:(t,a)=>Q(a.status)},{key:"operator",header:"İşlem Yapan",render:(t,a)=>{var s;return((s=a.operator)==null?void 0:s.name)||"-"}},{key:"actions",header:"İşlemler",render:(t,a)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"rounded p-1 text-gray-600 hover:bg-gray-50",title:"Detay",children:e.jsx(xe,{className:"h-4 w-4"})}),a.status==="pending"&&e.jsx("button",{onClick:()=>{_(a),i(!0)},className:"rounded p-1 text-blue-600 hover:bg-blue-50",title:"Düzenle",children:e.jsx(he,{className:"h-4 w-4"})})]})}];return A?e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent mx-auto mb-2"}),e.jsx("p",{className:"text-muted-foreground",children:"Yükleniyor..."})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Nakdi Yardım İşlemleri"}),e.jsx("p",{className:"text-muted-foreground",children:"Nakdi işlemleri kaydedin ve takip edin"})]}),e.jsxs("button",{onClick:()=>{_(null),i(!0)},className:"flex items-center gap-2 rounded bg-primary px-4 py-2 text-sm text-white hover:bg-primary/90",children:[e.jsx(O,{className:"h-4 w-4"}),"Yeni İşlem"]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsx(j,{title:"Toplam Gelir",value:g(m.totalIncome),icon:G,accentClass:"bg-green-100"}),e.jsx(j,{title:"Toplam Gider",value:g(m.totalExpense),icon:F,accentClass:"bg-red-100"}),e.jsx(j,{title:"Bakiye",value:g(m.balance),icon:ue,accentClass:"bg-blue-100"}),e.jsx(j,{title:"Bugünkü İşlemler",value:m.todayOperations.toString(),icon:W,accentClass:"bg-purple-100"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 rounded-lg border p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("input",{type:"text",placeholder:"İşlem ara...",value:o,onChange:t=>M(t.target.value),className:"min-w-64 rounded border px-3 py-2 text-sm"})]}),e.jsxs("select",{value:p,onChange:t=>R(t.target.value),className:"rounded border px-3 py-2 text-sm",children:[e.jsx("option",{value:"all",children:"Tüm Türler"}),e.jsx("option",{value:"income",children:"Gelir"}),e.jsx("option",{value:"expense",children:"Gider"}),e.jsx("option",{value:"transfer",children:"Transfer"})]}),e.jsxs("select",{value:u,onChange:t=>Y(t.target.value),className:"rounded border px-3 py-2 text-sm",children:[e.jsx("option",{value:"all",children:"Tüm Durumlar"}),e.jsx("option",{value:"pending",children:"Bekleyen"}),e.jsx("option",{value:"completed",children:"Tamamlanan"}),e.jsx("option",{value:"cancelled",children:"İptal Edilen"})]}),e.jsxs("select",{value:x,onChange:t=>z(t.target.value),className:"rounded border px-3 py-2 text-sm",children:[e.jsx("option",{value:"all",children:"Tüm Tarihler"}),e.jsx("option",{value:"today",children:"Bugün"}),e.jsx("option",{value:"week",children:"Bu Hafta"}),e.jsx("option",{value:"month",children:"Bu Ay"})]}),e.jsxs("button",{onClick:()=>ne("nakdi-islemler.csv",N),className:"flex items-center gap-2 rounded bg-green-600 px-3 py-2 text-sm text-white hover:bg-green-700",children:[e.jsx(ee,{className:"h-4 w-4"}),"İndir"]}),e.jsxs("div",{className:"ml-auto text-sm text-muted-foreground",children:[N.length," işlem"]})]}),e.jsx(le,{columns:X,data:N}),e.jsxs(oe,{open:K,onClose:()=>i(!1),children:[e.jsxs("div",{className:"flex items-center justify-between border-b p-4",children:[e.jsx("h2",{className:"text-lg font-semibold",children:S?"İşlem Düzenle":"Yeni Nakdi İşlem"}),e.jsx("button",{onClick:()=>i(!1),className:"h-8 w-8 rounded-full bg-red-600 text-white hover:bg-red-700",children:"×"})]}),e.jsxs("form",{onSubmit:L($),className:"p-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"İşlem Türü *"}),e.jsxs("select",{...n("operation_type"),className:"w-full rounded border px-3 py-2 text-sm",children:[e.jsx("option",{value:"",children:"Seçiniz..."}),e.jsx("option",{value:"income",children:"Gelir"}),e.jsx("option",{value:"expense",children:"Gider"}),e.jsx("option",{value:"transfer",children:"Transfer"})]}),l.operation_type&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:l.operation_type.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Kategori *"}),e.jsxs("select",{...n("category"),className:"w-full rounded border px-3 py-2 text-sm",disabled:!h,children:[e.jsx("option",{value:"",children:"Seçiniz..."}),h&&((C=ye[h])==null?void 0:C.map(t=>e.jsx("option",{value:t,children:t},t)))]}),l.category&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:l.category.message})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tutar *"}),e.jsx("input",{type:"number",step:"0.01",...n("amount",{valueAsNumber:!0}),className:"w-full rounded border px-3 py-2 text-sm",placeholder:"0.00"}),l.amount&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:l.amount.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Referans Numarası"}),e.jsx("input",{type:"text",...n("reference_number"),className:"w-full rounded border px-3 py-2 text-sm",placeholder:"REF001"})]})]}),h==="transfer"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Kaynak Hesap"}),e.jsx("input",{type:"text",...n("from_account"),className:"w-full rounded border px-3 py-2 text-sm",placeholder:"Kaynak hesap"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hedef Hesap"}),e.jsx("input",{type:"text",...n("to_account"),className:"w-full rounded border px-3 py-2 text-sm",placeholder:"Hedef hesap"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Açıklama *"}),e.jsx("input",{type:"text",...n("description"),className:"w-full rounded border px-3 py-2 text-sm",placeholder:"İşlem açıklaması"}),l.description&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:l.description.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notlar"}),e.jsx("textarea",{...n("notes"),rows:3,className:"w-full rounded border px-3 py-2 text-sm",placeholder:"İşlem ile ilgili notlar..."})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>i(!1),className:"rounded border px-4 py-2 text-sm hover:bg-gray-50",children:"İptal"}),e.jsxs("button",{type:"submit",className:"flex items-center gap-2 rounded bg-primary px-4 py-2 text-sm text-white hover:bg-primary/90",children:[e.jsx(O,{className:"h-4 w-4"}),S?"Güncelle":"Kaydet"]})]})]})]})]})}export{De as default};
