import{t as e,r as a,V as s,j as t,e as l,aC as n,q as r,k as i,p as d,a2 as o,S as c,n as m,X as x,P as u,g as p,aB as h,U as g}from"../assets/index-C7XW2vnU.js";import{e as j}from"./exportToCsv-DLkyd1nM.js";import{D as v}from"./DataTable-BR_3tqT5.js";import{M as b}from"./Modal-QxY_FyG0.js";import{S as y}from"./StatCard-BDZzrbVN.js";import{u as f,t as k,o as N,s as _,b as w,e as S}from"./types-Drtxg6gu.js";import{V as D}from"./index-DGkWrISs.js";import{A}from"./alert-circle-W3dFygZp.js";import{E as C}from"./eye-Bpapn1fj.js";import{P as H}from"./pen-square-C-SOcf8u.js";const z=e("Stethoscope",[["path",{d:"M4.8 2.3A.3.3 0 1 0 5 2H4a2 2 0 0 0-2 2v5a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6V4a2 2 0 0 0-2-2h-1a.2.2 0 1 0 .3.3",key:"1jd90r"}],["path",{d:"M8 15v1a6 6 0 0 0 6 6v0a6 6 0 0 0 6-6v-4",key:"126ukv"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]]),T=N({beneficiary_id:_().min(1,"İhtiyaç sahibi seçiniz"),hospital_name:_().min(1,"Hastane adı giriniz"),department:_().min(1,"Bölüm seçiniz"),doctor_name:_().optional(),referral_reason:_().min(1,"Sevk nedeni giriniz"),urgency_level:S(["normal","urgent","emergency"],{message:"Aciliyet seviyesi seçiniz"}),appointment_date:_().optional(),appointment_time:_().optional(),transportation_needed:w(),transportation_type:_().optional(),companion_needed:w(),companion_name:_().optional(),companion_phone:_().optional(),medical_documents:_().optional(),insurance_info:_().optional(),notes:_().optional()}),G=["Ankara Şehir Hastanesi","Hacettepe Üniversitesi Hastanesi","Gazi Üniversitesi Hastanesi","Ankara Üniversitesi Tıp Fakültesi Hastanesi","Numune Eğitim ve Araştırma Hastanesi","Dışkapı Yıldırım Beyazıt Eğitim ve Araştırma Hastanesi","Keçiören Eğitim ve Araştırma Hastanesi","Atatürk Göğüs Hastalıkları Hastanesi","Dr. Sami Ulus Kadın Doğum Hastanesi","Ankara Fizik Tedavi Hastanesi"],K=["Dahiliye","Kardiyoloji","Nöroloji","Ortopedi","Göz Hastalıkları","Kulak Burun Boğaz","Üroloji","Kadın Hastalıkları","Çocuk Hastalıkları","Psikiyatri","Dermatoloji","Genel Cerrahi","Beyin Cerrahisi","Kalp Cerrahisi","Göğüs Cerrahisi","Plastik Cerrahi","Fizik Tedavi","Radyoloji","Onkoloji","Endokrinoloji"],R=["Ambulans","Hasta Nakil Aracı","Özel Araç","Toplu Taşıma","Taksi"];function B(){const[e,N]=a.useState([]),[_,w]=a.useState({totalReferrals:0,pending:0,scheduled:0,completed:0,emergency:0}),[S,B]=a.useState(!0),[E,L]=a.useState(""),[M,O]=a.useState("all"),[F,I]=a.useState("all"),[Y,U]=a.useState("all"),[V,q]=a.useState("all"),[P,$]=a.useState(!1),[Z,J]=a.useState(null),[Q,W]=a.useState([]),{register:X,handleSubmit:ee,formState:{errors:ae},reset:se,watch:te}=f({resolver:k(T)}),le=te("transportation_needed"),ne=te("companion_needed");a.useEffect(()=>{re(),ie(),de()},[]);const re=async()=>{try{const e=[{id:"1",beneficiary_id:"ben1",hospital_name:"Ankara Şehir Hastanesi",department:"Kardiyoloji",doctor_name:"Dr. Mehmet Özkan",referral_reason:"Kalp ritim bozukluğu kontrolü",urgency_level:"urgent",appointment_date:new Date(Date.now()+2592e5).toISOString().split("T")[0],appointment_time:"14:30",referral_date:(new Date).toISOString(),status:"scheduled",transportation_needed:!0,transportation_type:"Ambulans",companion_needed:!0,companion_name:"Fatma Yılmaz",companion_phone:"0532 123 45 67",medical_documents:"EKG sonuçları, kan tahlilleri",insurance_info:"SGK",notes:"Hasta yürümekte zorlanıyor, tekerlekli sandalye gerekli",created_at:(new Date).toISOString(),beneficiaries:{name:"Ali",surname:"Veli",phone:"0533 987 65 43",category:"Yaşlı",address:"Ankara, Çankaya",birth_date:"1950-05-15"},created_by:{name:"Ahmet Yılmaz",email:"ahmet@example.com"}},{id:"2",beneficiary_id:"ben2",hospital_name:"Hacettepe Üniversitesi Hastanesi",department:"Çocuk Hastalıkları",doctor_name:"Dr. Ayşe Demir",referral_reason:"Rutin çocuk kontrolü ve aşı takibi",urgency_level:"normal",appointment_date:new Date(Date.now()+6048e5).toISOString().split("T")[0],appointment_time:"10:00",referral_date:new Date(Date.now()-1728e5).toISOString(),status:"scheduled",transportation_needed:!1,companion_needed:!0,companion_name:"Zeynep Kaya",companion_phone:"0534 567 89 01",medical_documents:"Aşı kartı",insurance_info:"SGK",notes:"Anne ile birlikte gelecek",created_at:new Date(Date.now()-1728e5).toISOString(),beneficiaries:{name:"Elif",surname:"Kaya",phone:"0534 567 89 01",category:"Çocuk",address:"Ankara, Keçiören",birth_date:"2018-03-20"},created_by:{name:"Fatma Demir",email:"fatma@example.com"}}];N(e)}catch(e){D.error("Hastane sevk kayıtları yüklenirken hata oluştu")}finally{B(!1)}},ie=async()=>{try{w({totalReferrals:45,pending:12,scheduled:18,completed:13,emergency:2})}catch(e){}},de=async()=>{try{const{data:e,error:a}=await s.from("beneficiaries").select("id, name, surname, category, phone, address, birth_date").eq("status","active").order("name");if(a)throw a;W(e||[])}catch(e){}},oe=a.useMemo(()=>e.filter(e=>{var a,s,t;const l=""===E||`${null==(a=e.beneficiaries)?void 0:a.name} ${null==(s=e.beneficiaries)?void 0:s.surname}`.toLowerCase().includes(E.toLowerCase())||e.hospital_name.toLowerCase().includes(E.toLowerCase())||e.department.toLowerCase().includes(E.toLowerCase())||(null==(t=e.doctor_name)?void 0:t.toLowerCase().includes(E.toLowerCase()))||e.referral_reason.toLowerCase().includes(E.toLowerCase()),n="all"===M||e.hospital_name===M,r="all"===F||e.department===F,i="all"===Y||e.status===Y,d="all"===V||e.urgency_level===V;return l&&n&&r&&i&&d}),[e,E,M,F,Y,V]),ce=e=>{const a=new Date,s=new Date(e);let t=a.getFullYear()-s.getFullYear();const l=a.getMonth()-s.getMonth();return(l<0||0===l&&a.getDate()<s.getDate())&&t--,t},me=[{key:"beneficiaries",header:"Hasta Bilgisi",render:(e,a)=>{var s,l,n,r,i;return t.jsxs("div",{children:[t.jsxs("div",{className:"font-medium",children:[null==(s=a.beneficiaries)?void 0:s.name," ",null==(l=a.beneficiaries)?void 0:l.surname]}),t.jsx("div",{className:"text-sm text-muted-foreground",children:null==(n=a.beneficiaries)?void 0:n.category}),(null==(r=a.beneficiaries)?void 0:r.birth_date)&&t.jsxs("div",{className:"text-xs text-muted-foreground",children:[ce(a.beneficiaries.birth_date)," yaş"]}),(null==(i=a.beneficiaries)?void 0:i.phone)&&t.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[t.jsx(u,{className:"h-3 w-3"}),a.beneficiaries.phone]})]})}},{key:"hospital_info",header:"Hastane & Bölüm",render:(e,a)=>t.jsxs("div",{children:[t.jsxs("div",{className:"font-medium flex items-center gap-1",children:[t.jsx(n,{className:"h-3 w-3 text-blue-600"}),a.hospital_name]}),t.jsxs("div",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[t.jsx(z,{className:"h-3 w-3"}),a.department]}),a.doctor_name&&t.jsxs("div",{className:"text-xs text-muted-foreground",children:["Dr. ",a.doctor_name]})]})},{key:"referral_reason",header:"Sevk Nedeni",render:(e,a)=>t.jsxs("div",{className:"max-w-xs",children:[t.jsx("div",{className:"text-sm truncate",title:a.referral_reason,children:a.referral_reason}),a.medical_documents&&t.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1 mt-1",children:[t.jsx(p,{className:"h-3 w-3"}),"Belgeler mevcut"]})]})},{key:"urgency_level",header:"Aciliyet",render:(e,a)=>(e=>{const a={normal:{label:"Normal",class:"bg-green-100 text-green-800"},urgent:{label:"Acil",class:"bg-orange-100 text-orange-800"},emergency:{label:"Acil Servis",class:"bg-red-100 text-red-800"}}[e]||{label:e,class:"bg-gray-100 text-gray-800"};return t.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-1 text-xs font-medium ${a.class}`,children:a.label})})(a.urgency_level)},{key:"appointment",header:"Randevu",render:(e,a)=>{return t.jsx("div",{children:a.appointment_date?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"text-sm font-medium",children:(s=a.appointment_date,new Date(s).toLocaleDateString("tr-TR"))}),a.appointment_time&&t.jsx("div",{className:"text-xs text-muted-foreground",children:a.appointment_time})]}):t.jsx("span",{className:"text-muted-foreground text-sm",children:"Randevu yok"})});var s}},{key:"transportation",header:"Ulaşım",render:(e,a)=>t.jsxs("div",{children:[a.transportation_needed?t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(h,{className:"h-3 w-3 text-red-600"}),t.jsx("span",{className:"text-sm",children:a.transportation_type||"Gerekli"})]}):t.jsx("span",{className:"text-muted-foreground text-sm",children:"Gerekmiyor"}),a.companion_needed&&t.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1 mt-1",children:[t.jsx(g,{className:"h-3 w-3"}),"Refakatçi: ",a.companion_name||"Gerekli"]})]})},{key:"status",header:"Durum",render:(e,a)=>(e=>{const a={pending:{label:"Bekliyor",class:"bg-yellow-100 text-yellow-800",icon:r},scheduled:{label:"Randevulu",class:"bg-blue-100 text-blue-800",icon:i},completed:{label:"Tamamlandı",class:"bg-green-100 text-green-800",icon:d},cancelled:{label:"İptal Edildi",class:"bg-red-100 text-red-800",icon:x},no_show:{label:"Gelmedi",class:"bg-gray-100 text-gray-800",icon:A}}[e]||{label:e,class:"bg-gray-100 text-gray-800",icon:A},s=a.icon;return t.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2 py-1 text-xs font-medium ${a.class}`,children:[t.jsx(s,{className:"h-3 w-3"}),a.label]})})(a.status)},{key:"actions",header:"İşlemler",render:(e,a)=>t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{className:"rounded p-1 text-gray-600 hover:bg-gray-50",title:"Detay",children:t.jsx(C,{className:"h-4 w-4"})}),"completed"!==a.status&&"cancelled"!==a.status&&t.jsx("button",{onClick:()=>{J(a),$(!0)},className:"rounded p-1 text-blue-600 hover:bg-blue-50",title:"Düzenle",children:t.jsx(H,{className:"h-4 w-4"})})]})}];return S?t.jsx("div",{className:"flex h-64 items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent mx-auto mb-2"}),t.jsx("p",{className:"text-muted-foreground",children:"Yükleniyor..."})]})}):t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold",children:"Hastane Sevk İşlemleri"}),t.jsx("p",{className:"text-muted-foreground",children:"Hastane sevklerini yönetin ve takip edin"})]}),t.jsxs("button",{onClick:()=>{J(null),$(!0)},className:"flex items-center gap-2 rounded bg-primary px-4 py-2 text-sm text-white hover:bg-primary/90",children:[t.jsx(l,{className:"h-4 w-4"}),"Yeni Sevk"]})]}),t.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-5",children:[t.jsx(y,{title:"Toplam Sevkler",value:_.totalReferrals.toString(),icon:n,accentClass:"bg-blue-100"}),t.jsx(y,{title:"Bekleyen",value:_.pending.toString(),icon:r,accentClass:"bg-yellow-100"}),t.jsx(y,{title:"Randevulu",value:_.scheduled.toString(),icon:i,accentClass:"bg-blue-100"}),t.jsx(y,{title:"Tamamlanan",value:_.completed.toString(),icon:d,accentClass:"bg-green-100"}),t.jsx(y,{title:"Acil Servis",value:_.emergency.toString(),icon:o,accentClass:"bg-red-100"})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-4 rounded-lg border p-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(c,{className:"h-4 w-4 text-muted-foreground"}),t.jsx("input",{type:"text",placeholder:"Sevk ara...",value:E,onChange:e=>L(e.target.value),className:"min-w-64 rounded border px-3 py-2 text-sm"})]}),t.jsxs("select",{value:M,onChange:e=>O(e.target.value),className:"rounded border px-3 py-2 text-sm",children:[t.jsx("option",{value:"all",children:"Tüm Hastaneler"}),G.map(e=>t.jsx("option",{value:e,children:e},e))]}),t.jsxs("select",{value:F,onChange:e=>I(e.target.value),className:"rounded border px-3 py-2 text-sm",children:[t.jsx("option",{value:"all",children:"Tüm Bölümler"}),K.map(e=>t.jsx("option",{value:e,children:e},e))]}),t.jsxs("select",{value:Y,onChange:e=>U(e.target.value),className:"rounded border px-3 py-2 text-sm",children:[t.jsx("option",{value:"all",children:"Tüm Durumlar"}),t.jsx("option",{value:"pending",children:"Bekleyen"}),t.jsx("option",{value:"scheduled",children:"Randevulu"}),t.jsx("option",{value:"completed",children:"Tamamlanan"}),t.jsx("option",{value:"cancelled",children:"İptal Edilen"}),t.jsx("option",{value:"no_show",children:"Gelmeyen"})]}),t.jsxs("select",{value:V,onChange:e=>q(e.target.value),className:"rounded border px-3 py-2 text-sm",children:[t.jsx("option",{value:"all",children:"Tüm Aciliyet Seviyeleri"}),t.jsx("option",{value:"normal",children:"Normal"}),t.jsx("option",{value:"urgent",children:"Acil"}),t.jsx("option",{value:"emergency",children:"Acil Servis"})]}),t.jsxs("button",{onClick:()=>j("hastane-sevkleri.csv",oe),className:"flex items-center gap-2 rounded bg-green-600 px-3 py-2 text-sm text-white hover:bg-green-700",children:[t.jsx(m,{className:"h-4 w-4"}),"İndir"]}),t.jsxs("div",{className:"ml-auto text-sm text-muted-foreground",children:[oe.length," sevk"]})]}),t.jsx(v,{columns:me,data:oe}),t.jsxs(b,{open:P,onClose:()=>$(!1),children:[t.jsxs("div",{className:"flex items-center justify-between border-b p-4",children:[t.jsx("h2",{className:"text-lg font-semibold",children:Z?"Sevk Düzenle":"Yeni Hastane Sevki"}),t.jsx("button",{onClick:()=>$(!1),className:"h-8 w-8 rounded-full bg-red-600 text-white hover:bg-red-700",children:"×"})]}),t.jsxs("form",{onSubmit:ee(async e=>{try{const a={id:Date.now().toString(),...e,referral_date:(new Date).toISOString(),status:"pending",created_at:(new Date).toISOString(),beneficiaries:Q.find(a=>a.id===e.beneficiary_id),created_by:{name:"Mevcut Kullanıcı",email:"user@example.com"}};N(e=>[a,...e]),D.success("Hastane sevk kaydı başarıyla oluşturuldu"),$(!1),se(),ie()}catch(a){D.error("Hastane sevk kaydı oluşturulurken hata oluştu")}}),className:"p-4 space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hasta *"}),t.jsxs("select",{...X("beneficiary_id"),className:"w-full rounded border px-3 py-2 text-sm",children:[t.jsx("option",{value:"",children:"Seçiniz..."}),Q.map(e=>t.jsxs("option",{value:e.id,children:[e.name," ",e.surname," - ",e.category]},e.id))]}),ae.beneficiary_id&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:ae.beneficiary_id.message})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Aciliyet Seviyesi *"}),t.jsxs("select",{...X("urgency_level"),className:"w-full rounded border px-3 py-2 text-sm",children:[t.jsx("option",{value:"",children:"Seçiniz..."}),t.jsx("option",{value:"normal",children:"Normal"}),t.jsx("option",{value:"urgent",children:"Acil"}),t.jsx("option",{value:"emergency",children:"Acil Servis"})]}),ae.urgency_level&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:ae.urgency_level.message})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hastane *"}),t.jsxs("select",{...X("hospital_name"),className:"w-full rounded border px-3 py-2 text-sm",children:[t.jsx("option",{value:"",children:"Seçiniz..."}),G.map(e=>t.jsx("option",{value:e,children:e},e))]}),ae.hospital_name&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:ae.hospital_name.message})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Bölüm *"}),t.jsxs("select",{...X("department"),className:"w-full rounded border px-3 py-2 text-sm",children:[t.jsx("option",{value:"",children:"Seçiniz..."}),K.map(e=>t.jsx("option",{value:e,children:e},e))]}),ae.department&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:ae.department.message})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Doktor Adı"}),t.jsx("input",{type:"text",...X("doctor_name"),className:"w-full rounded border px-3 py-2 text-sm",placeholder:"Dr. Adı Soyadı"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Sigorta Bilgisi"}),t.jsx("input",{type:"text",...X("insurance_info"),className:"w-full rounded border px-3 py-2 text-sm",placeholder:"SGK, Özel Sigorta, vb."})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Sevk Nedeni *"}),t.jsx("textarea",{...X("referral_reason"),rows:3,className:"w-full rounded border px-3 py-2 text-sm",placeholder:"Sevk nedeni ve şikayetler..."}),ae.referral_reason&&t.jsx("p",{className:"text-sm text-red-600 mt-1",children:ae.referral_reason.message})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Randevu Tarihi"}),t.jsx("input",{type:"date",...X("appointment_date"),className:"w-full rounded border px-3 py-2 text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Randevu Saati"}),t.jsx("input",{type:"time",...X("appointment_time"),className:"w-full rounded border px-3 py-2 text-sm"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tıbbi Belgeler"}),t.jsx("input",{type:"text",...X("medical_documents"),className:"w-full rounded border px-3 py-2 text-sm",placeholder:"Mevcut belgeler (EKG, kan tahlili, vb.)"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",...X("transportation_needed"),className:"rounded"}),t.jsx("label",{className:"text-sm font-medium",children:"Ulaşım Desteği Gerekli"})]}),le&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Ulaşım Türü"}),t.jsxs("select",{...X("transportation_type"),className:"w-full rounded border px-3 py-2 text-sm",children:[t.jsx("option",{value:"",children:"Seçiniz..."}),R.map(e=>t.jsx("option",{value:e,children:e},e))]})]})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("input",{type:"checkbox",...X("companion_needed"),className:"rounded"}),t.jsx("label",{className:"text-sm font-medium",children:"Refakatçi Gerekli"})]}),ne&&t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Refakatçi Adı"}),t.jsx("input",{type:"text",...X("companion_name"),className:"w-full rounded border px-3 py-2 text-sm",placeholder:"Refakatçi adı soyadı"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Refakatçi Telefonu"}),t.jsx("input",{type:"tel",...X("companion_phone"),className:"w-full rounded border px-3 py-2 text-sm",placeholder:"0532 123 45 67"})]})]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notlar"}),t.jsx("textarea",{...X("notes"),rows:3,className:"w-full rounded border px-3 py-2 text-sm",placeholder:"Ek notlar ve özel durumlar..."})]}),t.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[t.jsx("button",{type:"button",onClick:()=>$(!1),className:"rounded border px-4 py-2 text-sm hover:bg-gray-50",children:"İptal"}),t.jsxs("button",{type:"submit",className:"flex items-center gap-2 rounded bg-primary px-4 py-2 text-sm text-white hover:bg-primary/90",children:[t.jsx(l,{className:"h-4 w-4"}),Z?"Güncelle":"Kaydet"]})]})]})]})]})}export{B as default};
