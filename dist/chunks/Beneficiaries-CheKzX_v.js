import{t as e,r as a,V as l,ao as n,j as i,F as t,n as r,g as s,ap as o,d}from"../assets/index-dW79Uy5k.js";import{D as c}from"./DataTable-Co2fK-v0.js";import{e as u}from"./exportToCsv-DLkyd1nM.js";import{b as h,c as p}from"./pdfExport-COs4Ncag.js";import{M as m}from"./Modal-BBek2lFh.js";import{L as x}from"./LazyQRScannerModal-B3E-EzM9.js";import{A as g,c as y,a as v}from"./AdvancedSearchModal-1Zx7RX-J.js";import{F as b}from"./jspdf.plugin.autotable-DPZz52D5.js";import{Q as j}from"./qr-code-6ryxGMhx.js";import"./sanitization-DKE2yZnW.js";const _=e("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),k=async()=>{const{data:e,error:a}=await l.from("beneficiaries").select("id").order("id",{ascending:!1}).limit(1);return a?1:e&&e.length>0?e[0].id+1:1};function f(){const[e,f]=a.useState(""),[w,C]=a.useState(!1),[S,A]=a.useState(!1),[D,K]=a.useState(!0),[z,T]=a.useState(!1),[B,E]=a.useState([]),[O,F]=a.useState(!1),[G,Y]=a.useState(null),[I,$]=a.useState(!1),[M,L]=a.useState({}),[P,H]=a.useState([]),[Q,U]=a.useState({personal:!0,contact:!1,financial:!1,health:!1,housing:!1,additional:!1,system:!1}),q=v(),R=y(),V=[{id:"all",name:"TÃ¼mÃ¼",filters:{},pageType:"beneficiaries",isQuickFilter:!0,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),usageCount:0,lastUsed:(new Date).toISOString()},{id:"active",name:"Aktif",filters:{status:"active"},pageType:"beneficiaries",isQuickFilter:!0,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),usageCount:0,lastUsed:(new Date).toISOString()},{id:"inactive",name:"Pasif",filters:{status:"inactive"},pageType:"beneficiaries",isQuickFilter:!0,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),usageCount:0,lastUsed:(new Date).toISOString()},{id:"pending",name:"Beklemede",filters:{status:"pending"},pageType:"beneficiaries",isQuickFilter:!0,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),usageCount:0,lastUsed:(new Date).toISOString()}],[Z,J]=a.useState({name:"",surname:"",category:"Yetim Ailesi",nationality:"TC",birth_date:"",birth_place:"",identity_no:"",gender:"",marital_status:"",education_level:"",mother_name:"",father_name:"",phone:"",alternative_phone:"",email:"",address:"",city:"",district:"",neighborhood:"",postal_code:"",emergency_contact_name:"",emergency_contact_phone:"",emergency_contact_relation:"",monthly_income:"",household_size:"",dependent_count:"",employment_status:"",occupation:"",social_security_no:"",bank_account_no:"",bank_name:"",has_disability:!1,disability_type:"",disability_percentage:"",chronic_illness:"",medication_needs:"",health_insurance:!1,health_insurance_type:"",housing_type:"",monthly_rent:"",room_count:"",has_electricity:!0,has_water:!0,has_gas:!1,has_internet:!1,housing_condition:"",special_needs:"",previous_aid_received:!1,previous_aid_details:"",verification_status:"pending",notes:"",fund_region:"Genel",file_connection:"DoÄŸrudan BaÅŸvuru",file_number:"",status:"active",mernis_check:!1}),[W,X]=a.useState({name:"",surname:"",identity_no:""}),ee=a.useCallback(async()=>{K(!0);let a=l.from("beneficiaries").select("*").order("created_at",{ascending:!1});const i=e.trim();i&&(a=a.or(`name.ilike.%${i}%,surname.ilike.%${i}%,identity_no.ilike.%${i}%,phone.ilike.%${i}%,email.ilike.%${i}%,city.ilike.%${i}%,district.ilike.%${i}%`)),Object.entries(M).forEach(([e,l])=>{null!=l&&""!==l&&(Array.isArray(l)&&l.length>0?a=a.in(e,l):"object"==typeof l&&void 0!==l.min&&void 0!==l.max?(null!==l.min&&(a=a.gte(e,l.min)),null!==l.max&&(a=a.lte(e,l.max))):a="object"==typeof l&&l.start&&l.end?a.gte(e,l.start).lte(e,l.end):"string"!=typeof l||"name"!==e&&"surname"!==e&&"city"!==e&&"district"!==e?a.eq(e,l):a.ilike(e,`%${l}%`))});const{data:t,error:r}=await a;r?(n.error("Veriler yÃ¼klenirken hata oluÅŸtu"),E([])):E(t||[]),K(!1)},[e,M]);a.useEffect(()=>{ee()},[ee]);const ae=()=>{J({name:"",surname:"",category:"Yetim Ailesi",nationality:"TC",birth_date:"",birth_place:"",identity_no:"",gender:"",marital_status:"",education_level:"",mother_name:"",father_name:"",phone:"",alternative_phone:"",email:"",address:"",city:"",district:"",neighborhood:"",postal_code:"",emergency_contact_name:"",emergency_contact_phone:"",emergency_contact_relation:"",monthly_income:"",household_size:"",dependent_count:"",employment_status:"",occupation:"",social_security_no:"",bank_account_no:"",bank_name:"",has_disability:!1,disability_type:"",disability_percentage:"",chronic_illness:"",medication_needs:"",health_insurance:!1,health_insurance_type:"",housing_type:"",monthly_rent:"",room_count:"",has_electricity:!0,has_water:!0,has_gas:!1,has_internet:!1,housing_condition:"",special_needs:"",previous_aid_received:!1,previous_aid_details:"",verification_status:"pending",notes:"",fund_region:"Genel",file_connection:"DoÄŸrudan BaÅŸvuru",file_number:"",status:"active",mernis_check:!1}),Y(null)},le=()=>{X({name:"",surname:"",identity_no:""})},ne=(e,a)=>{J(l=>({...l,[e]:a}))},ie=e=>{U(a=>({...a,[e]:!a[e]}))},te=({title:e,isExpanded:a,onToggle:l,children:n})=>i.jsxs("div",{className:"border border-gray-200 rounded-lg mb-4",children:[i.jsxs("button",{type:"button",onClick:l,className:"w-full px-4 py-3 bg-gray-50 hover:bg-gray-100 flex items-center justify-between text-left font-medium text-gray-900 rounded-t-lg",children:[i.jsx("span",{children:e}),a?i.jsx(_,{className:"h-5 w-5"}):i.jsx(o,{className:"h-5 w-5"})]}),a&&i.jsx("div",{className:"p-4 space-y-4",children:n})]}),re=(e,a)=>{X(l=>({...l,[e]:a}))},se=()=>{const e=Date.now();return{normal:[{name:"Ahmet",surname:"YÄ±lmaz",category:"Yetim Ailesi",nationality:"T.C.",birth_date:"1985-03-15",identity_no:`${e}001`,phone:"0532 123 45 67",family_size:4,status:"active"},{name:"Fatma",surname:"Demir",category:"YaÅŸlÄ±",nationality:"T.C.",birth_date:"1950-08-22",identity_no:`${e}002`,phone:"0533 234 56 78",family_size:2,status:"active"},{name:"Mehmet",surname:"Kaya",category:"Engelli",nationality:"T.C.",birth_date:"1978-12-10",identity_no:`${e}003`,phone:"0534 345 67 89",family_size:3,status:"active"}],temporary:[{name:"Ali",surname:"Ã–zkan",identity_no:`${e}004`,category:"MuhtaÃ§ Aile",family_size:5,status:"inactive"},{name:"AyÅŸe",surname:"Ã‡elik",identity_no:`${e}005`,category:"Hasta",family_size:1,status:"inactive"}]}},oe=[{key:"id",header:"ID",render:(e,a,l)=>i.jsx(d,{className:"text-blue-600 underline",to:`/aid/beneficiaries/${a.id}`,children:(l||0)+1})},{key:"name",header:"Ad Soyad",render:(e,a)=>i.jsxs("span",{children:[a.name," ",a.surname]})},{key:"category",header:"Kategori"},{key:"nationality",header:"Uyruk"},{key:"identity_no",header:"Kimlik No"},{key:"phone",header:"Cep Telefonu"},{key:"city",header:"Åžehir"},{key:"district",header:"Ä°lÃ§e"},{key:"status",header:"Durum",render:(e,a)=>i.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium "+("suspended"===a.status?"bg-orange-100 text-orange-800 border border-orange-200":"active"===a.status?"bg-green-100 text-green-800":"inactive"===a.status?"bg-gray-100 text-gray-800":"bg-yellow-100 text-yellow-800"),children:"suspended"===a.status?"ðŸ”„ GeÃ§ici":"active"===a.status?"Aktif":"inactive"===a.status?"Pasif":a.status})},{key:"actions",header:"Ä°ÅŸlemler",render:(e,a)=>"suspended"===a.status?i.jsx("button",{onClick:()=>(e=>{J({name:e.name||"",surname:e.surname||"",category:e.category||"Yetim Ailesi",nationality:e.nationality||"TC",birth_date:e.birth_date||"",birth_place:"",identity_no:e.identity_no||"",gender:"",marital_status:"",education_level:"",mother_name:"",father_name:"",phone:e.phone||"",alternative_phone:"",email:e.email||"",address:e.address||"",city:e.city||"",district:e.district||"",neighborhood:"",postal_code:"",emergency_contact_name:"",emergency_contact_phone:"",emergency_contact_relation:"",monthly_income:"",household_size:"",dependent_count:"",employment_status:"",occupation:"",social_security_no:"",bank_account_no:"",bank_name:"",has_disability:!1,disability_type:"",disability_percentage:"",chronic_illness:"",medication_needs:"",health_insurance:!1,health_insurance_type:"",housing_type:"",monthly_rent:"",room_count:"",has_electricity:!0,has_water:!0,has_gas:!1,has_internet:!1,housing_condition:"",special_needs:"",previous_aid_received:!1,previous_aid_details:"",verification_status:"pending",notes:"",fund_region:e.fund_region||"Genel",file_connection:e.file_connection||"DoÄŸrudan BaÅŸvuru",file_number:e.file_number||"",status:e.status||"active",mernis_check:!1}),Y(Number(e.id)),C(!0)})(a),className:"bg-blue-600 text-white px-2 py-1 rounded text-xs hover:bg-blue-700",children:"Tamamla"}):null}];return i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto rounded border p-2",children:[i.jsx("input",{value:e,onChange:e=>f(e.target.value),className:"min-w-64 flex-1 rounded border px-2 py-1 text-sm",placeholder:"Ad, Soyad, Kimlik No, Telefon, Åžehir, Ä°lÃ§e..."}),i.jsx("button",{className:"rounded bg-green-600 px-3 py-1 text-sm text-white",children:"Ara"}),i.jsxs("button",{onClick:()=>$(!0),className:"rounded border px-3 py-1 text-sm flex items-center gap-1 "+(Object.keys(M).length>0?"bg-blue-50 border-blue-300 text-blue-700":"hover:bg-gray-50"),children:[i.jsx(t,{className:"w-3 h-3"}),"GeliÅŸmiÅŸ Filtre",Object.keys(M).length>0&&i.jsx("span",{className:"bg-blue-600 text-white text-xs rounded-full px-1.5 py-0.5 ml-1",children:Object.keys(M).length})]}),Object.keys(M).length>0&&i.jsx("button",{onClick:()=>{L({})},className:"rounded bg-red-100 border border-red-300 text-red-700 px-3 py-1 text-sm hover:bg-red-200",children:"Filtreleri Temizle"}),i.jsx("button",{onClick:()=>C(!0),className:"rounded border px-3 py-1 text-sm",children:"Ekle"}),i.jsx("button",{onClick:()=>A(!0),className:"rounded bg-orange-600 px-3 py-1 text-sm text-white",children:"GeÃ§ici KayÄ±t"}),i.jsx("button",{onClick:async()=>{try{return void n.error("Supabase environment variables are missing")}catch(e){n.error("Connection test failed")}},className:"rounded bg-gray-600 px-3 py-1 text-sm text-white hover:bg-gray-700",children:"Test DB"}),i.jsx("button",{onClick:async()=>{T(!0);try{{const e=se(),a=[...e.normal,...e.temporary].map((e,a)=>({...e,id:`mock-${Date.now()}-${a}`,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()}));return E(e=>[...e,...a]),void n.success(`${a.length} demo kayÄ±t mock data olarak eklendi (Supabase yapÄ±landÄ±rmasÄ± eksik)`)}}catch(e){let a="Bilinmeyen hata";e instanceof Error?a=e.message:"string"==typeof e?a=e:e&&"object"==typeof e&&(a=JSON.stringify(e,null,2)),n.error(`Demo kayÄ±tlar oluÅŸturulurken beklenmeyen hata oluÅŸtu: ${a}`)}finally{T(!1)}},disabled:z,className:"rounded bg-purple-600 px-3 py-1 text-sm text-white hover:bg-purple-700 disabled:opacity-50",children:z?"OluÅŸturuluyor...":"Demo KayÄ±t"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsxs("button",{onClick:()=>u("ihtiyac-sahipleri.csv",B),className:"rounded bg-blue-600 px-3 py-1 text-sm text-white hover:bg-blue-700 flex items-center gap-1",title:"CSV olarak indir",children:[i.jsx(r,{className:"w-3 h-3"}),"CSV"]}),i.jsxs("button",{onClick:()=>h(B,e.trim()?{search:e.trim()}:void 0),className:"rounded bg-green-600 px-3 py-1 text-sm text-white hover:bg-green-700 flex items-center gap-1",title:"Excel olarak indir",children:[i.jsx(b,{className:"w-3 h-3"}),"Excel"]}),i.jsxs("button",{onClick:()=>p(B,e.trim()?{search:e.trim()}:void 0),className:"rounded bg-red-600 px-3 py-1 text-sm text-white hover:bg-red-700 flex items-center gap-1",title:"PDF olarak indir",children:[i.jsx(s,{className:"w-3 h-3"}),"PDF"]})]}),i.jsxs("div",{className:"ml-auto text-sm text-muted-foreground",children:[B.length," KayÄ±t"]})]}),D?i.jsx("div",{className:"p-6 text-sm text-muted-foreground",children:"YÃ¼kleniyor..."}):i.jsx(c,{columns:oe,data:B}),i.jsx(m,{isOpen:w,onClose:()=>{C(!1),ae()},title:G?"Ä°htiyaÃ§ Sahibi Bilgilerini Tamamla":"Yeni Ä°htiyaÃ§ Sahibi",children:i.jsxs("div",{className:"p-4 space-y-4",children:[i.jsx("div",{className:"flex justify-center",children:i.jsxs("button",{onClick:()=>F(!0),className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-3 rounded-lg hover:from-blue-700 hover:to-blue-800 flex items-center gap-2 shadow-md transition-all duration-200 hover:shadow-lg",children:[i.jsx(j,{className:"w-5 h-5"}),"Tarama"]})}),i.jsx(te,{title:"Temel Bilgiler",isExpanded:Q.personal,onToggle:()=>ie("personal"),children:i.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[i.jsx(N,{label:"Kategori *",children:i.jsxs("select",{value:Z.category,onChange:e=>ne("category",e.target.value),className:"w-full rounded border px-2 py-1",children:[i.jsx("option",{value:"Yetim Ailesi",children:"Yetim Ailesi"}),i.jsx("option",{value:"MuhtaÃ§ Aile",children:"MuhtaÃ§ Aile"}),i.jsx("option",{value:"YaÅŸlÄ±",children:"YaÅŸlÄ±"}),i.jsx("option",{value:"Engelli",children:"Engelli"}),i.jsx("option",{value:"Hasta",children:"Hasta"})]})}),i.jsx(N,{label:"Ad *",children:i.jsx("input",{value:Z.name,onChange:e=>ne("name",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"Ad"})}),i.jsx(N,{label:"Soyad *",children:i.jsx("input",{value:Z.surname,onChange:e=>ne("surname",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"Soyad"})}),i.jsx(N,{label:"Uyruk",children:i.jsxs("select",{value:Z.nationality,onChange:e=>ne("nationality",e.target.value),className:"w-full rounded border px-2 py-1",children:[i.jsx("option",{value:"TC",children:"T.C."}),i.jsx("option",{value:"Suriye",children:"Suriye"}),i.jsx("option",{value:"Irak",children:"Irak"}),i.jsx("option",{value:"Afganistan",children:"Afganistan"}),i.jsx("option",{value:"DiÄŸer",children:"DiÄŸer"})]})}),i.jsx(N,{label:"DoÄŸum Tarihi",children:i.jsx("input",{type:"date",value:Z.birth_date,onChange:e=>ne("birth_date",e.target.value),className:"w-full rounded border px-2 py-1"})}),i.jsx(N,{label:"DoÄŸum Yeri",children:i.jsx("input",{value:Z.birth_place,onChange:e=>ne("birth_place",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"DoÄŸum yeri"})}),i.jsx(N,{label:"Cinsiyet",children:i.jsxs("select",{value:Z.gender,onChange:e=>ne("gender",e.target.value),className:"w-full rounded border px-2 py-1",children:[i.jsx("option",{value:"",children:"SeÃ§iniz"}),i.jsx("option",{value:"Erkek",children:"Erkek"}),i.jsx("option",{value:"KadÄ±n",children:"KadÄ±n"})]})}),i.jsx(N,{label:"Medeni Durum",children:i.jsxs("select",{value:Z.marital_status,onChange:e=>ne("marital_status",e.target.value),className:"w-full rounded border px-2 py-1",children:[i.jsx("option",{value:"",children:"SeÃ§iniz"}),i.jsx("option",{value:"Bekar",children:"Bekar"}),i.jsx("option",{value:"Evli",children:"Evli"}),i.jsx("option",{value:"Dul",children:"Dul"}),i.jsx("option",{value:"BoÅŸanmÄ±ÅŸ",children:"BoÅŸanmÄ±ÅŸ"})]})}),i.jsx(N,{label:"EÄŸitim Seviyesi",children:i.jsxs("select",{value:Z.education_level,onChange:e=>ne("education_level",e.target.value),className:"w-full rounded border px-2 py-1",children:[i.jsx("option",{value:"",children:"SeÃ§iniz"}),i.jsx("option",{value:"Okur-yazar deÄŸil",children:"Okur-yazar deÄŸil"}),i.jsx("option",{value:"Ä°lkokul",children:"Ä°lkokul"}),i.jsx("option",{value:"Ortaokul",children:"Ortaokul"}),i.jsx("option",{value:"Lise",children:"Lise"}),i.jsx("option",{value:"Ãœniversite",children:"Ãœniversite"}),i.jsx("option",{value:"LisansÃ¼stÃ¼",children:"LisansÃ¼stÃ¼"})]})}),i.jsx(N,{label:"Anne AdÄ±",children:i.jsx("input",{value:Z.mother_name,onChange:e=>ne("mother_name",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"Anne adÄ±"})}),i.jsx(N,{label:"Baba AdÄ±",children:i.jsx("input",{value:Z.father_name,onChange:e=>ne("father_name",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"Baba adÄ±"})}),i.jsxs("div",{className:"sm:col-span-2 grid grid-cols-[1fr_auto] items-center gap-2",children:[i.jsx(N,{label:"Kimlik No *",children:i.jsx("input",{value:Z.identity_no,onChange:e=>ne("identity_no",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"11 haneli kimlik numarasÄ±"})}),i.jsxs("label",{className:"flex items-center gap-2 text-sm mt-5",children:[i.jsx("input",{type:"checkbox",checked:Z.mernis_check,onChange:e=>ne("mernis_check",e.target.checked)}),"Mernis KontrolÃ¼ Yap"]})]})]})}),i.jsx(te,{title:"Ä°letiÅŸim Bilgileri",isExpanded:Q.contact,onToggle:()=>ie("contact"),children:i.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[i.jsx(N,{label:"Telefon",children:i.jsx("input",{value:Z.phone,onChange:e=>ne("phone",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"0555 123 45 67"})}),i.jsx(N,{label:"Alternatif Telefon",children:i.jsx("input",{value:Z.alternative_phone,onChange:e=>ne("alternative_phone",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"0555 123 45 67"})}),i.jsx(N,{label:"E-posta",children:i.jsx("input",{type:"email",value:Z.email,onChange:e=>ne("email",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"ornek@email.com"})}),i.jsx(N,{label:"Åžehir",children:i.jsx("input",{value:Z.city,onChange:e=>ne("city",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"Åžehir"})}),i.jsx(N,{label:"Ä°lÃ§e",children:i.jsx("input",{value:Z.district,onChange:e=>ne("district",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"Ä°lÃ§e"})}),i.jsx(N,{label:"Mahalle",children:i.jsx("input",{value:Z.neighborhood,onChange:e=>ne("neighborhood",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"Mahalle"})}),i.jsx(N,{label:"Posta Kodu",children:i.jsx("input",{value:Z.postal_code,onChange:e=>ne("postal_code",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"34000"})}),i.jsx("div",{className:"sm:col-span-2",children:i.jsx(N,{label:"Adres",children:i.jsx("textarea",{value:Z.address,onChange:e=>ne("address",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"Tam adres",rows:2})})}),i.jsx(N,{label:"Acil Durum Ä°letiÅŸim AdÄ±",children:i.jsx("input",{value:Z.emergency_contact_name,onChange:e=>ne("emergency_contact_name",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"Acil durum kiÅŸisi"})}),i.jsx(N,{label:"Acil Durum Telefon",children:i.jsx("input",{value:Z.emergency_contact_phone,onChange:e=>ne("emergency_contact_phone",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"0555 123 45 67"})}),i.jsx(N,{label:"Acil Durum YakÄ±nlÄ±k",children:i.jsxs("select",{value:Z.emergency_contact_relation,onChange:e=>ne("emergency_contact_relation",e.target.value),className:"w-full rounded border px-2 py-1",children:[i.jsx("option",{value:"",children:"SeÃ§iniz"}),i.jsx("option",{value:"EÅŸ",children:"EÅŸ"}),i.jsx("option",{value:"Anne",children:"Anne"}),i.jsx("option",{value:"Baba",children:"Baba"}),i.jsx("option",{value:"KardeÅŸ",children:"KardeÅŸ"}),i.jsx("option",{value:"Ã‡ocuk",children:"Ã‡ocuk"}),i.jsx("option",{value:"Akraba",children:"Akraba"}),i.jsx("option",{value:"ArkadaÅŸ",children:"ArkadaÅŸ"}),i.jsx("option",{value:"KomÅŸu",children:"KomÅŸu"})]})})]})}),i.jsx(te,{title:"Finansal Bilgiler",isExpanded:Q.financial,onToggle:()=>ie("financial"),children:i.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[i.jsx(N,{label:"AylÄ±k Gelir (TL)",children:i.jsx("input",{type:"number",value:Z.monthly_income,onChange:e=>ne("monthly_income",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"0"})}),i.jsx(N,{label:"Hane BÃ¼yÃ¼klÃ¼ÄŸÃ¼",children:i.jsx("input",{type:"number",value:Z.household_size,onChange:e=>ne("household_size",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"1"})}),i.jsx(N,{label:"BaÄŸÄ±mlÄ± KiÅŸi SayÄ±sÄ±",children:i.jsx("input",{type:"number",value:Z.dependent_count,onChange:e=>ne("dependent_count",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"0"})}),i.jsx(N,{label:"Ä°stihdam Durumu",children:i.jsxs("select",{value:Z.employment_status,onChange:e=>ne("employment_status",e.target.value),className:"w-full rounded border px-2 py-1",children:[i.jsx("option",{value:"",children:"SeÃ§iniz"}),i.jsx("option",{value:"Ã‡alÄ±ÅŸÄ±yor",children:"Ã‡alÄ±ÅŸÄ±yor"}),i.jsx("option",{value:"Ä°ÅŸsiz",children:"Ä°ÅŸsiz"}),i.jsx("option",{value:"Emekli",children:"Emekli"}),i.jsx("option",{value:"Ã–ÄŸrenci",children:"Ã–ÄŸrenci"}),i.jsx("option",{value:"Ev hanÄ±mÄ±",children:"Ev hanÄ±mÄ±"}),i.jsx("option",{value:"Ã‡alÄ±ÅŸamaz durumda",children:"Ã‡alÄ±ÅŸamaz durumda"})]})}),i.jsx(N,{label:"Meslek",children:i.jsx("input",{value:Z.occupation,onChange:e=>ne("occupation",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"Meslek"})}),i.jsx(N,{label:"SGK No",children:i.jsx("input",{value:Z.social_security_no,onChange:e=>ne("social_security_no",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"SGK numarasÄ±"})}),i.jsx(N,{label:"Banka Hesap No",children:i.jsx("input",{value:Z.bank_account_no,onChange:e=>ne("bank_account_no",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"IBAN"})}),i.jsx(N,{label:"Banka AdÄ±",children:i.jsx("input",{value:Z.bank_name,onChange:e=>ne("bank_name",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"Banka adÄ±"})})]})}),i.jsx(te,{title:"SaÄŸlÄ±k Bilgileri",isExpanded:Q.health,onToggle:()=>ie("health"),children:i.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[i.jsx("div",{className:"sm:col-span-2",children:i.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[i.jsx("input",{type:"checkbox",checked:Z.has_disability,onChange:e=>ne("has_disability",e.target.checked)}),"Engel durumu var"]})}),Z.has_disability&&i.jsxs(i.Fragment,{children:[i.jsx(N,{label:"Engel TÃ¼rÃ¼",children:i.jsxs("select",{value:Z.disability_type,onChange:e=>ne("disability_type",e.target.value),className:"w-full rounded border px-2 py-1",children:[i.jsx("option",{value:"",children:"SeÃ§iniz"}),i.jsx("option",{value:"Fiziksel",children:"Fiziksel"}),i.jsx("option",{value:"Zihinsel",children:"Zihinsel"}),i.jsx("option",{value:"GÃ¶rme",children:"GÃ¶rme"}),i.jsx("option",{value:"Ä°ÅŸitme",children:"Ä°ÅŸitme"}),i.jsx("option",{value:"KonuÅŸma",children:"KonuÅŸma"}),i.jsx("option",{value:"Ã‡oklu",children:"Ã‡oklu"})]})}),i.jsx(N,{label:"Engel OranÄ± (%)",children:i.jsx("input",{type:"number",value:Z.disability_percentage,onChange:e=>ne("disability_percentage",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"0-100",min:"0",max:"100"})})]}),i.jsx(N,{label:"Kronik HastalÄ±k",children:i.jsx("input",{value:Z.chronic_illness,onChange:e=>ne("chronic_illness",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"Kronik hastalÄ±k varsa belirtiniz"})}),i.jsx(N,{label:"Ä°laÃ§ Ä°htiyacÄ±",children:i.jsx("input",{value:Z.medication_needs,onChange:e=>ne("medication_needs",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"DÃ¼zenli kullanÄ±lan ilaÃ§lar"})}),i.jsx("div",{className:"sm:col-span-2",children:i.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[i.jsx("input",{type:"checkbox",checked:Z.health_insurance,onChange:e=>ne("health_insurance",e.target.checked)}),"SaÄŸlÄ±k sigortasÄ± var"]})}),Z.health_insurance&&i.jsx(N,{label:"Sigorta TÃ¼rÃ¼",children:i.jsxs("select",{value:Z.health_insurance_type,onChange:e=>ne("health_insurance_type",e.target.value),className:"w-full rounded border px-2 py-1",children:[i.jsx("option",{value:"",children:"SeÃ§iniz"}),i.jsx("option",{value:"SGK",children:"SGK"}),i.jsx("option",{value:"YeÅŸil Kart",children:"YeÅŸil Kart"}),i.jsx("option",{value:"Ã–zel Sigorta",children:"Ã–zel Sigorta"}),i.jsx("option",{value:"DiÄŸer",children:"DiÄŸer"})]})})]})}),i.jsx(te,{title:"Konut Bilgileri",isExpanded:Q.housing,onToggle:()=>ie("housing"),children:i.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[i.jsx(N,{label:"Konut TÃ¼rÃ¼",children:i.jsxs("select",{value:Z.housing_type,onChange:e=>ne("housing_type",e.target.value),className:"w-full rounded border px-2 py-1",children:[i.jsx("option",{value:"",children:"SeÃ§iniz"}),i.jsx("option",{value:"MÃ¼lk",children:"MÃ¼lk"}),i.jsx("option",{value:"KiralÄ±k",children:"KiralÄ±k"}),i.jsx("option",{value:"Lojman",children:"Lojman"}),i.jsx("option",{value:"Akraba yanÄ±nda",children:"Akraba yanÄ±nda"}),i.jsx("option",{value:"BarÄ±nak",children:"BarÄ±nak"}),i.jsx("option",{value:"DiÄŸer",children:"DiÄŸer"})]})}),i.jsx(N,{label:"AylÄ±k Kira (TL)",children:i.jsx("input",{type:"number",value:Z.monthly_rent,onChange:e=>ne("monthly_rent",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"0"})}),i.jsx(N,{label:"Oda SayÄ±sÄ±",children:i.jsxs("select",{value:Z.room_count,onChange:e=>ne("room_count",e.target.value),className:"w-full rounded border px-2 py-1",children:[i.jsx("option",{value:"",children:"SeÃ§iniz"}),i.jsx("option",{value:"1",children:"1"}),i.jsx("option",{value:"2",children:"2"}),i.jsx("option",{value:"3",children:"3"}),i.jsx("option",{value:"4",children:"4"}),i.jsx("option",{value:"5+",children:"5+"})]})}),i.jsx(N,{label:"Konut Durumu",children:i.jsxs("select",{value:Z.housing_condition,onChange:e=>ne("housing_condition",e.target.value),className:"w-full rounded border px-2 py-1",children:[i.jsx("option",{value:"",children:"SeÃ§iniz"}),i.jsx("option",{value:"Ä°yi",children:"Ä°yi"}),i.jsx("option",{value:"Orta",children:"Orta"}),i.jsx("option",{value:"KÃ¶tÃ¼",children:"KÃ¶tÃ¼"}),i.jsx("option",{value:"Ã‡ok kÃ¶tÃ¼",children:"Ã‡ok kÃ¶tÃ¼"})]})}),i.jsxs("div",{className:"sm:col-span-2 grid grid-cols-2 sm:grid-cols-4 gap-3",children:[i.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[i.jsx("input",{type:"checkbox",checked:Z.has_electricity,onChange:e=>ne("has_electricity",e.target.checked)}),"Elektrik"]}),i.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[i.jsx("input",{type:"checkbox",checked:Z.has_water,onChange:e=>ne("has_water",e.target.checked)}),"Su"]}),i.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[i.jsx("input",{type:"checkbox",checked:Z.has_gas,onChange:e=>ne("has_gas",e.target.checked)}),"DoÄŸalgaz"]}),i.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[i.jsx("input",{type:"checkbox",checked:Z.has_internet,onChange:e=>ne("has_internet",e.target.checked)}),"Ä°nternet"]})]})]})}),i.jsx(te,{title:"Ek Bilgiler",isExpanded:Q.additional,onToggle:()=>ie("additional"),children:i.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[i.jsx("div",{className:"sm:col-span-2",children:i.jsx(N,{label:"Ã–zel Ä°htiyaÃ§lar",children:i.jsx("textarea",{value:Z.special_needs,onChange:e=>ne("special_needs",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"Ã–zel ihtiyaÃ§lar, dikkat edilmesi gereken durumlar",rows:2})})}),i.jsx("div",{className:"sm:col-span-2",children:i.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[i.jsx("input",{type:"checkbox",checked:Z.previous_aid_received,onChange:e=>ne("previous_aid_received",e.target.checked)}),"Daha Ã¶nce yardÄ±m alÄ±ndÄ±"]})}),Z.previous_aid_received&&i.jsx("div",{className:"sm:col-span-2",children:i.jsx(N,{label:"Ã–nceki YardÄ±m DetaylarÄ±",children:i.jsx("textarea",{value:Z.previous_aid_details,onChange:e=>ne("previous_aid_details",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"Hangi kuruluÅŸtan, ne tÃ¼r yardÄ±m alÄ±ndÄ±",rows:2})})}),i.jsx(N,{label:"DoÄŸrulama Durumu",children:i.jsxs("select",{value:Z.verification_status,onChange:e=>ne("verification_status",e.target.value),className:"w-full rounded border px-2 py-1",children:[i.jsx("option",{value:"pending",children:"Beklemede"}),i.jsx("option",{value:"verified",children:"DoÄŸrulandÄ±"}),i.jsx("option",{value:"rejected",children:"Reddedildi"}),i.jsx("option",{value:"needs_review",children:"Ä°nceleme Gerekli"})]})}),i.jsx("div",{className:"sm:col-span-2",children:i.jsx(N,{label:"Notlar",children:i.jsx("textarea",{value:Z.notes,onChange:e=>ne("notes",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"Ek notlar, aÃ§Ä±klamalar",rows:3})})})]})}),i.jsx(te,{title:"Sistem AlanlarÄ±",isExpanded:Q.system,onToggle:()=>ie("system"),children:i.jsxs("div",{className:"grid gap-3 sm:grid-cols-2",children:[i.jsx(N,{label:"Fon BÃ¶lgesi",children:i.jsxs("select",{value:Z.fund_region,onChange:e=>ne("fund_region",e.target.value),className:"w-full rounded border px-2 py-1",children:[i.jsx("option",{value:"Genel",children:"Genel"}),i.jsx("option",{value:"Ã–zel",children:"Ã–zel"}),i.jsx("option",{value:"Acil",children:"Acil"})]})}),i.jsx(N,{label:"Dosya BaÄŸlantÄ±sÄ±",children:i.jsxs("select",{value:Z.file_connection,onChange:e=>ne("file_connection",e.target.value),className:"w-full rounded border px-2 py-1",children:[i.jsx("option",{value:"Partner Kurum",children:"Partner Kurum"}),i.jsx("option",{value:"DoÄŸrudan BaÅŸvuru",children:"DoÄŸrudan BaÅŸvuru"}),i.jsx("option",{value:"Sevk",children:"Sevk"})]})}),i.jsx(N,{label:"Dosya NumarasÄ±",children:i.jsx("input",{value:Z.file_number,onChange:e=>ne("file_number",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"Dosya numarasÄ±"})}),i.jsx(N,{label:"Durum",children:i.jsxs("select",{value:Z.status,onChange:e=>ne("status",e.target.value),className:"w-full rounded border px-2 py-1",children:[i.jsx("option",{value:"active",children:"Aktif"}),i.jsx("option",{value:"inactive",children:"Pasif"}),i.jsx("option",{value:"suspended",children:"GeÃ§ici"})]})})]})}),i.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[i.jsx("button",{onClick:()=>{C(!1),ae()},className:"px-4 py-2 border rounded hover:bg-gray-50",disabled:z,children:"Ä°ptal"}),i.jsx("button",{onClick:async()=>{if(Z.name.trim()&&Z.surname.trim()&&Z.identity_no.trim()){T(!0);try{const e={name:Z.name.trim(),surname:Z.surname.trim(),category:Z.category,nationality:Z.nationality.trim(),birth_date:Z.birth_date||null,identity_no:Z.identity_no.trim(),phone:Z.phone.trim()||null,email:Z.email.trim()||null,address:Z.address.trim()||null,city:Z.city.trim()||null,district:Z.district.trim()||null,status:Z.status,fund_region:Z.fund_region};let a;if(G)a=await l.from("beneficiaries").update(e).eq("id",G).select();else{const n=await k(),i={...e,id:n};a=await l.from("beneficiaries").insert([i]).select()}const{error:i}=a;i?n.error("KayÄ±t sÄ±rasÄ±nda hata oluÅŸtu: "+i.message):(n.success(G?"Ä°htiyaÃ§ sahibi baÅŸarÄ±yla gÃ¼ncellendi":"Ä°htiyaÃ§ sahibi baÅŸarÄ±yla kaydedildi"),C(!1),ae(),Y(null),ee())}catch(e){n.error("KayÄ±t sÄ±rasÄ±nda beklenmeyen hata oluÅŸtu")}finally{T(!1)}}else n.error("Ad, Soyad ve Kimlik No alanlarÄ± zorunludur")},disabled:z,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 disabled:opacity-50",children:z?"Kaydediliyor...":"Kaydet"})]})]})}),i.jsx(m,{isOpen:S,onClose:()=>{A(!1),le()},title:"GeÃ§ici KayÄ±t",children:i.jsxs("div",{className:"p-4 space-y-4",children:[i.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3 mb-4",children:i.jsxs("p",{className:"text-sm text-orange-800",children:[i.jsx("strong",{children:"GeÃ§ici KayÄ±t:"})," Sadece temel bilgiler alÄ±nÄ±r. Detaylar daha sonra tamamlanabilir."]})}),i.jsxs("div",{className:"grid gap-3",children:[i.jsx(N,{label:"Ad *",children:i.jsx("input",{value:W.name,onChange:e=>re("name",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"Ad"})}),i.jsx(N,{label:"Soyad *",children:i.jsx("input",{value:W.surname,onChange:e=>re("surname",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"Soyad"})}),i.jsx(N,{label:"Kimlik No *",children:i.jsx("input",{value:W.identity_no,onChange:e=>re("identity_no",e.target.value),className:"w-full rounded border px-2 py-1",placeholder:"11 haneli kimlik numarasÄ±"})})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[i.jsx("button",{onClick:()=>{A(!1),le()},className:"px-4 py-2 border rounded hover:bg-gray-50",disabled:z,children:"Ä°ptal"}),i.jsx("button",{onClick:async()=>{if(W.name.trim()&&W.surname.trim()&&W.identity_no.trim()){T(!0);try{const e=await k(),{error:a}=await l.from("beneficiaries").insert([{id:e,name:W.name.trim(),surname:W.surname.trim(),identity_no:W.identity_no.trim(),category:"Yetim Ailesi",status:"geÃ§ici",fund_region:"Genel",file_connection:"DoÄŸrudan BaÅŸvuru"}]).select();a?n.error("GeÃ§ici kayÄ±t sÄ±rasÄ±nda hata oluÅŸtu: "+a.message):(n.success("GeÃ§ici kayÄ±t baÅŸarÄ±yla oluÅŸturuldu"),A(!1),le(),ee())}catch(e){n.error("GeÃ§ici kayÄ±t sÄ±rasÄ±nda beklenmeyen hata oluÅŸtu")}finally{T(!1)}}else n.error("Ad, Soyad ve Kimlik No alanlarÄ± zorunludur")},disabled:z,className:"bg-orange-600 text-white px-4 py-2 rounded hover:bg-orange-700 disabled:opacity-50",children:z?"Kaydediliyor...":"GeÃ§ici Kaydet"})]})]})}),i.jsx(x,{isOpen:O,onClose:()=>F(!1),onScanSuccess:e=>{e.identity_no&&(J(a=>({...a,identity_no:e.identity_no||"",name:e.name||a.name,surname:e.surname||a.surname,birth_date:e.birth_date||a.birth_date})),n.success("Kimlik bilgileri QR koddan okundu")),F(!1)}}),i.jsx(g,{isOpen:I,onClose:()=>$(!1),onApplyFilters:e=>{L(e),$(!1)},onSaveFilter:e=>{const a={...e,id:Date.now().toString(),createdAt:(new Date).toISOString()};H(e=>[...e,a]),n.success("Filtre kaydedildi")},onLoadFilter:e=>{L(e.filters),n.success("Filtre yÃ¼klendi")},pageType:"beneficiaries",fields:q.fields,dependencies:q.dependencies,groups:q.groups,validationRules:q.validationRules,urlConfig:R,savedFiltersConfig:{storageKey:"beneficiaries_saved_filters",filters:[{id:"status",label:"Durum",value:"",type:"select",options:[{label:"Aktif",value:"active"},{label:"Pasif",value:"inactive"},{label:"Beklemede",value:"pending"}]},{id:"city",label:"Åžehir",value:"",type:"select",options:[{label:"Ä°stanbul",value:"istanbul"},{label:"Ankara",value:"ankara"},{label:"Ä°zmir",value:"izmir"}]},{id:"age",label:"YaÅŸ",value:"",type:"number"},{id:"name",label:"Ad Soyad",value:"",type:"text"}],quickFilters:[{id:"active",label:"Aktif YararlanÄ±cÄ±lar",value:"active",type:"select"},{id:"pending",label:"Bekleyen BaÅŸvurular",value:"pending",type:"select"}]},quickFilters:V,savedFilters:P,initialFilters:M})]})}function N({label:e,children:a}){return i.jsxs("label",{className:"space-y-1",children:[i.jsx("div",{className:"text-xs text-muted-foreground",children:e}),a]})}export{f as default};
