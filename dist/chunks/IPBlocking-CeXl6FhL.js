import{t as e,r as t,j as s,e as l,O as a,J as r,s as i}from"../assets/index-C7XW2vnU.js";import{D as d}from"./DataTable-BR_3tqT5.js";import{e as n}from"./exportToCsv-DLkyd1nM.js";import{E as c}from"./eye-Bpapn1fj.js";import{L as o}from"./lock-Bn4grRpA.js";const m=e("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),x=[{id:"1",ipAddress:"192.168.48.44",reason:"nurettin nicki ile giriş yapmaya çalışan kullanıcının hatalı giriş denemesinden dolayı ip engellemesi",blockedDate:"12.05.2025 04:43:51",blockedBy:"Sistem (Otomatik)",attempts:15,lastAttempt:"12.05.2025 04:42:30",blockType:"Automatic",expiryDate:"19.05.2025 04:43:51",country:"Türkiye",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64)",severity:"High",status:"Active"},{id:"2",ipAddress:"85.34.12.45",reason:"Şüpheli SQL injection denemeleri",blockedDate:"10.05.2025 14:22:10",blockedBy:"Ahmet Yılmaz",attempts:8,lastAttempt:"10.05.2025 14:20:45",blockType:"Manual",expiryDate:null,country:"Rusya",userAgent:"curl/7.68.0",severity:"Critical",status:"Active"},{id:"3",ipAddress:"172.29.188.109",reason:"Çoklu başarısız giriş denemesi",blockedDate:"08.05.2025 16:30:22",blockedBy:"Sistem (Otomatik)",attempts:12,lastAttempt:"08.05.2025 16:29:55",blockType:"Temporary",expiryDate:"09.05.2025 16:30:22",country:"Türkiye",userAgent:"Mozilla/5.0 (iPhone; CPU iPhone OS 14_0)",severity:"Medium",status:"Expired"},{id:"4",ipAddress:"195.142.86.72",reason:"Brute force saldırı tespiti",blockedDate:"05.05.2025 09:15:33",blockedBy:"Fatma Demir",attempts:25,lastAttempt:"05.05.2025 09:14:12",blockType:"Manual",expiryDate:null,country:"Çin",userAgent:"python-requests/2.25.1",severity:"Critical",status:"Active"},{id:"5",ipAddress:"192.168.1.100",reason:"Test amaçlı manuel engelleme",blockedDate:"01.05.2025 10:00:00",blockedBy:"Mehmet Öz",attempts:3,lastAttempt:"01.05.2025 09:58:30",blockType:"Manual",expiryDate:null,country:"Türkiye",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64)",severity:"Low",status:"Whitelist"}];function u(){const[e,u]=t.useState(""),[g,p]=t.useState(!1),[h,y]=t.useState("all"),[b,j]=t.useState("all"),[k,v]=t.useState("all"),N=t.useMemo(()=>{let t=x;return"all"!==h&&(t=t.filter(e=>e.blockType===h)),"all"!==b&&(t=t.filter(e=>e.status===b)),"all"!==k&&(t=t.filter(e=>e.severity===k)),e&&(t=t.filter(t=>JSON.stringify(t).toLowerCase().includes(e.toLowerCase()))),t},[e,h,b,k]),f=[{key:"ipAddress",header:"IP Adresi",render:e=>s.jsx("span",{className:"font-mono text-sm",children:String(e||"")})},{key:"reason",header:"Engelleme Nedeni",render:e=>s.jsx("div",{className:"max-w-xs",children:s.jsx("p",{className:"text-sm truncate",title:String(e||""),children:String(e||"")})})},{key:"blockType",header:"Engelleme Tipi",render:e=>{const t={Manual:"bg-blue-100 text-blue-700",Automatic:"bg-green-100 text-green-700",Temporary:"bg-yellow-100 text-yellow-700"},l={Manual:"Manuel",Automatic:"Otomatik",Temporary:"Geçici"},a=String(e||"Manual");return s.jsx("span",{className:`rounded-full px-2 py-1 text-xs ${t[a]||t.Manual}`,children:l[a]||l.Manual})}},{key:"severity",header:"Önem",render:e=>{const t={Low:"bg-gray-100 text-gray-700",Medium:"bg-yellow-100 text-yellow-700",High:"bg-orange-100 text-orange-700",Critical:"bg-red-100 text-red-700"},l={Low:"Düşük",Medium:"Orta",High:"Yüksek",Critical:"Kritik"},a=String(e||"Low");return s.jsx("span",{className:`rounded-full px-2 py-1 text-xs ${t[a]||t.Low}`,children:l[a]||l.Low})}},{key:"attempts",header:"Deneme Sayısı"},{key:"country",header:"Ülke"},{key:"blockedDate",header:"Engellenme Tarihi"},{key:"status",header:"Durum",render:e=>{const t={Active:"bg-red-100 text-red-700",Expired:"bg-gray-100 text-gray-700",Whitelist:"bg-green-100 text-green-700"},l={Active:"Aktif",Expired:"Süresi Dolmuş",Whitelist:"Beyaz Liste"},a=String(e||"Active");return s.jsx("span",{className:`rounded-full px-2 py-1 text-xs ${t[a]||t.Active}`,children:l[a]||l.Active})}},{key:"actions",header:"İşlemler",render:(e,t)=>s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{className:"rounded p-1 text-gray-600 hover:bg-gray-50",title:"Detay",children:s.jsx(c,{className:"h-4 w-4"})}),"Active"===t.status?s.jsx("button",{className:"rounded p-1 text-green-600 hover:bg-green-50",title:"Engeli Kaldır",children:s.jsx(m,{className:"h-4 w-4"})}):s.jsx("button",{className:"rounded p-1 text-red-600 hover:bg-red-50",title:"Engelle",children:s.jsx(o,{className:"h-4 w-4"})}),s.jsx("button",{className:"rounded p-1 text-red-600 hover:bg-red-50",title:"Sil",children:s.jsx(i,{className:"h-4 w-4"})})]})}],w=["Manual","Automatic","Temporary"],A=["Low","Medium","High","Critical"],T=N.filter(e=>"Active"===e.status).length,M=N.filter(e=>"Critical"===e.severity).length,S=N.reduce((e,t)=>e+t.attempts,0),D=new Set(N.map(e=>e.country)).size;return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto rounded border p-2",children:[s.jsxs("button",{onClick:()=>p(!0),className:"flex items-center gap-2 rounded bg-red-600 px-3 py-1 text-sm text-white",children:[s.jsx(l,{className:"h-4 w-4"}),"IP Engelle"]}),s.jsxs("select",{value:h,onChange:e=>y(e.target.value),className:"rounded border bg-background px-2 py-1 text-sm",children:[s.jsx("option",{value:"all",children:"Tüm Tipler"}),w.map(e=>s.jsx("option",{value:e,children:"Manual"===e?"Manuel":"Automatic"===e?"Otomatik":"Geçici"},e))]}),s.jsxs("select",{value:b,onChange:e=>j(e.target.value),className:"rounded border bg-background px-2 py-1 text-sm",children:[s.jsx("option",{value:"all",children:"Tüm Durumlar"}),["Active","Expired","Whitelist"].map(e=>s.jsx("option",{value:e,children:"Active"===e?"Aktif":"Expired"===e?"Süresi Dolmuş":"Beyaz Liste"},e))]}),s.jsxs("select",{value:k,onChange:e=>v(e.target.value),className:"rounded border bg-background px-2 py-1 text-sm",children:[s.jsx("option",{value:"all",children:"Tüm Önem Seviyeleri"}),A.map(e=>s.jsx("option",{value:e,children:"Low"===e?"Düşük":"Medium"===e?"Orta":"High"===e?"Yüksek":"Kritik"},e))]}),s.jsx("input",{value:e,onChange:e=>u(e.target.value),className:"min-w-64 flex-1 rounded border px-2 py-1 text-sm",placeholder:"IP adresi, neden veya ülke ara..."}),s.jsx("button",{className:"rounded bg-blue-600 px-3 py-1 text-sm text-white",children:"Ara"}),s.jsx("button",{onClick:()=>n("ip-engelleme-savunma.csv",N),className:"rounded bg-gray-600 px-3 py-1 text-sm text-white",children:"İndir"}),s.jsxs("div",{className:"ml-auto text-sm text-muted-foreground",children:[N.length," Engellenmiş IP"]})]}),s.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-4",children:[s.jsxs("div",{className:"rounded border bg-card dark:bg-gray-800 p-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(a,{className:"h-5 w-5 text-red-600"}),s.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Aktif Engeller"})]}),s.jsx("p",{className:"text-2xl font-bold text-red-600",children:T})]}),s.jsxs("div",{className:"rounded border bg-card p-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(r,{className:"h-5 w-5 text-orange-600"}),s.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Kritik Tehditler"})]}),s.jsx("p",{className:"text-2xl font-bold text-orange-600",children:M})]}),s.jsxs("div",{className:"rounded border bg-card p-4",children:[s.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Toplam Deneme"}),s.jsx("p",{className:"text-2xl font-bold text-purple-600",children:S})]}),s.jsxs("div",{className:"rounded border bg-card p-4",children:[s.jsx("h3",{className:"text-sm font-medium text-muted-foreground",children:"Ülke Sayısı"}),s.jsx("p",{className:"text-2xl font-bold text-blue-600",children:D})]})]}),s.jsxs("div",{className:"grid grid-cols-1 gap-4 lg:grid-cols-2",children:[s.jsxs("div",{className:"rounded border bg-card p-4",children:[s.jsx("h3",{className:"mb-3 text-lg font-semibold",children:"Tehdit Seviyeleri"}),s.jsx("div",{className:"space-y-2",children:A.map(e=>{const t=N.filter(t=>t.severity===e).length,l=N.length>0?(t/N.length*100).toFixed(1):0,a="Low"===e?"Düşük":"Medium"===e?"Orta":"High"===e?"Yüksek":"Kritik",r="Low"===e?"bg-gray-500":"Medium"===e?"bg-yellow-500":"High"===e?"bg-orange-500":"bg-red-500";return s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm",children:a}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"h-2 w-20 rounded bg-gray-200",children:s.jsx("div",{className:`h-full rounded ${r}`,style:{width:`${l}%`}})}),s.jsxs("span",{className:"text-sm font-medium",children:[t," (%",l,")"]})]})]},e)})})]}),s.jsxs("div",{className:"rounded border bg-card p-4",children:[s.jsx("h3",{className:"mb-3 text-lg font-semibold",children:"Engelleme Türleri"}),s.jsx("div",{className:"space-y-2",children:w.map(e=>{const t=N.filter(t=>t.blockType===e).length,l=N.length>0?(t/N.length*100).toFixed(1):0,a="Manual"===e?"Manuel":"Automatic"===e?"Otomatik":"Geçici",r="Manual"===e?"bg-blue-500":"Automatic"===e?"bg-green-500":"bg-yellow-500";return s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm",children:a}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"h-2 w-20 rounded bg-gray-200",children:s.jsx("div",{className:`h-full rounded ${r}`,style:{width:`${l}%`}})}),s.jsxs("span",{className:"text-sm font-medium",children:[t," (%",l,")"]})]})]},e)})})]})]}),s.jsx(d,{columns:f,data:N}),g&&s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:s.jsxs("div",{className:"w-full max-w-lg rounded-lg bg-white dark:bg-gray-800 p-6",children:[s.jsx("h2",{className:"mb-4 text-lg font-semibold text-gray-900 dark:text-gray-100",children:"IP Adresi Engelle"}),s.jsxs("form",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"IP Adresi"}),s.jsx("input",{type:"text",className:"mt-1 w-full rounded border px-3 py-2 text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 border-gray-300 dark:border-gray-600",placeholder:"192.168.1.10"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Engelleme Nedeni"}),s.jsx("textarea",{className:"mt-1 w-full rounded border px-3 py-2 text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 border-gray-300 dark:border-gray-600",rows:3,placeholder:"Engelleme nedenini açıklayın..."})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Engelleme Tipi"}),s.jsxs("select",{className:"mt-1 w-full rounded border px-3 py-2 text-sm bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 border-gray-300 dark:border-gray-600",children:[s.jsx("option",{value:"Manual",children:"Manuel"}),s.jsx("option",{value:"Automatic",children:"Otomatik"}),s.jsx("option",{value:"Temporary",children:"Geçici"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium",children:"Önem Seviyesi"}),s.jsxs("select",{className:"mt-1 w-full rounded border px-3 py-2 text-sm",children:[s.jsx("option",{value:"Low",children:"Düşük"}),s.jsx("option",{value:"Medium",children:"Orta"}),s.jsx("option",{value:"High",children:"Yüksek"}),s.jsx("option",{value:"Critical",children:"Kritik"})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium",children:"Son Erişim Tarihi (Opsiyonel)"}),s.jsx("input",{type:"datetime-local",className:"mt-1 w-full rounded border px-3 py-2 text-sm"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium",children:"Deneme Sayısı"}),s.jsx("input",{type:"number",className:"mt-1 w-full rounded border px-3 py-2 text-sm",placeholder:"0"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium",children:"Ülke (Opsiyonel)"}),s.jsx("input",{type:"text",className:"mt-1 w-full rounded border px-3 py-2 text-sm",placeholder:"Türkiye"})]})]}),s.jsx("div",{children:s.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[s.jsx("input",{type:"checkbox",className:"rounded"}),"Kalıcı engelleme (Son kullanma tarihi yok)"]})}),s.jsxs("div",{className:"flex gap-2 pt-4",children:[s.jsx("button",{type:"button",onClick:()=>p(!1),className:"flex-1 rounded border px-4 py-2 text-sm",children:"İptal"}),s.jsx("button",{type:"submit",className:"flex-1 rounded bg-red-600 px-4 py-2 text-sm text-white",children:"Engelle"})]})]})]})})]})}export{u as default};
