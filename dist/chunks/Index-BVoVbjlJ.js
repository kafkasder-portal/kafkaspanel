import{r as e,V as s,j as a,d as t,i as r,q as l,p as i,D as n,an as c,g as d,T as o,k as m}from"../assets/index-C7XW2vnU.js";import{S as x}from"./StatCard-BDZzrbVN.js";import{A as u}from"./alert-circle-W3dFygZp.js";function p(){const[p,g]=e.useState({totalBeneficiaries:0,pendingApplications:0,monthlyAidAmount:0,completedAids:0,urgentApplications:0,activeAidRecords:0}),[h,b]=e.useState([]),[f,j]=e.useState(!0);e.useEffect(()=>{v()},[]);const v=async()=>{try{const{count:e,error:a}=await s.from("beneficiaries").select("*",{count:"exact",head:!0}).eq("status","active"),{count:t,error:r}=await s.from("applications").select("*",{count:"exact",head:!0}).eq("status","pending"),{count:l,error:i}=await s.from("applications").select("*",{count:"exact",head:!0}).eq("priority","urgent").eq("status","pending"),n=(new Date).toISOString().slice(0,7),{count:c,error:d}=await s.from("aid_records").select("*",{count:"exact",head:!0}).eq("status","completed").gte("created_at",`${n}-01`),{data:o,error:m}=await s.from("aid_records").select("amount").eq("status","completed").gte("created_at",`${n}-01`),x=(null==o?void 0:o.reduce((e,s)=>{const a=s.amount||0;return e+(isNaN(a)?0:a)},0))||0,{count:u,error:p}=await s.from("aid_records").select("*",{count:"exact",head:!0}).in("status",["approved","distributed"]),{data:h,error:f}=await s.from("applications").select("\n          *,\n          beneficiaries (name, surname)\n        ").order("created_at",{ascending:!1}).limit(5);g({totalBeneficiaries:e||0,pendingApplications:t||0,monthlyAidAmount:x,completedAids:c||0,urgentApplications:l||0,activeAidRecords:u||0}),b(h||[])}catch(e){g({totalBeneficiaries:0,pendingApplications:0,monthlyAidAmount:0,completedAids:0,urgentApplications:0,activeAidRecords:0}),b([])}finally{j(!1)}},N=e=>isNaN(e)||null==e?"₺0,00":new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY"}).format(e),y=e=>{const s={pending:{label:"Bekliyor",class:"bg-yellow-100 text-yellow-800"},approved:{label:"Onaylandı",class:"bg-green-100 text-green-800"},rejected:{label:"Reddedildi",class:"bg-red-100 text-red-800"},completed:{label:"Tamamlandı",class:"bg-blue-100 text-blue-800"}}[e]||{label:e,class:"bg-gray-100 text-gray-800"};return a.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-1 text-xs font-medium ${s.class}`,children:s.label})},A=e=>{const s={low:{label:"Düşük",class:"bg-gray-100 text-gray-800"},normal:{label:"Normal",class:"bg-blue-100 text-blue-800"},high:{label:"Yüksek",class:"bg-orange-100 text-orange-800"},urgent:{label:"Acil",class:"bg-red-100 text-red-800"}}[e]||{label:e,class:"bg-gray-100 text-gray-800"};return a.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-1 text-xs font-medium ${s.class}`,children:s.label})};return f?a.jsx("div",{className:"flex h-64 items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent mx-auto mb-2"}),a.jsx("p",{className:"text-muted-foreground",children:"Yükleniyor..."})]})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Yardım Yönetimi"}),a.jsx("p",{className:"text-muted-foreground",children:"Yardım süreçlerinizi takip edin ve yönetin"})]}),a.jsx("div",{className:"flex gap-2",children:a.jsx(t,{to:"/aid/applications",className:"rounded bg-primary px-4 py-2 text-sm text-primary-foreground hover:bg-primary/90",children:"Yeni Başvuru"})})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[a.jsx(x,{title:"Toplam İhtiyaç Sahibi",value:p.totalBeneficiaries,icon:r,accentClass:"bg-blue-100"}),a.jsx(x,{title:"Bekleyen Başvurular",value:p.pendingApplications,icon:l,accentClass:"bg-orange-100"}),a.jsx(x,{title:"Acil Başvurular",value:p.urgentApplications,icon:u,accentClass:"bg-red-100"}),a.jsx(x,{title:"Bu Ay Tamamlanan",value:p.completedAids,icon:i,accentClass:"bg-green-100"}),a.jsx(x,{title:"Bu Ay Toplam Tutar",value:N(p.monthlyAidAmount||0),icon:n,accentClass:"bg-purple-100"}),a.jsx(x,{title:"Aktif Yardım Kayıtları",value:p.activeAidRecords,icon:c,accentClass:"bg-indigo-100"})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[a.jsxs("div",{className:"rounded-lg border p-6",children:[a.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Son Başvurular"}),a.jsx(t,{to:"/aid/applications",className:"text-sm text-primary hover:underline",children:"Tümünü Gör"})]}),a.jsx("div",{className:"space-y-3",children:h.length>0?h.map(e=>{var s,t,r;return a.jsxs("div",{className:"flex items-center justify-between rounded border p-3",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"font-medium",children:[(null==(s=e.beneficiaries)?void 0:s.name)||"İsim"," ",(null==(t=e.beneficiaries)?void 0:t.surname)||"Soyisim"]}),a.jsx("div",{className:"text-sm text-muted-foreground",children:e.description||"Açıklama bulunmamaktadır"}),a.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[y(e.status||"pending"),A(e.priority||"normal")]})]}),a.jsx("div",{className:"text-right text-sm text-muted-foreground",children:e.created_at?(r=e.created_at,new Date(r).toLocaleDateString("tr-TR")):"Tarih yok"})]},e.id)}):a.jsx("div",{className:"text-center text-muted-foreground py-8",children:"Henüz başvuru bulunmamaktadır."})})]}),a.jsxs("div",{className:"rounded-lg border p-6",children:[a.jsx("h2",{className:"mb-4 text-lg font-semibold",children:"Hızlı Erişim"}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs(t,{to:"/aid/beneficiaries",className:"flex flex-col items-center rounded border p-4 hover:bg-muted transition-colors",children:[a.jsx(r,{className:"h-8 w-8 text-blue-600 mb-2"}),a.jsx("span",{className:"text-sm font-medium",children:"İhtiyaç Sahipleri"})]}),a.jsxs(t,{to:"/aid/applications",className:"flex flex-col items-center rounded border p-4 hover:bg-muted transition-colors",children:[a.jsx(d,{className:"h-8 w-8 text-orange-600 mb-2"}),a.jsx("span",{className:"text-sm font-medium",children:"Başvurular"})]}),a.jsxs(t,{to:"/aid/cash-vault",className:"flex flex-col items-center rounded border p-4 hover:bg-muted transition-colors",children:[a.jsx(n,{className:"h-8 w-8 text-green-600 mb-2"}),a.jsx("span",{className:"text-sm font-medium",children:"Nakdi Yardım"})]}),a.jsxs(t,{to:"/aid/reports",className:"flex flex-col items-center rounded border p-4 hover:bg-muted transition-colors",children:[a.jsx(o,{className:"h-8 w-8 text-purple-600 mb-2"}),a.jsx("span",{className:"text-sm font-medium",children:"Raporlar"})]})]})]})]}),a.jsxs("div",{className:"rounded-lg border p-6",children:[a.jsxs("h2",{className:"mb-4 text-lg font-semibold flex items-center gap-2",children:[a.jsx(m,{className:"h-5 w-5"}),"Bu Ay Özeti"]}),a.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:p.completedAids}),a.jsx("div",{className:"text-sm text-muted-foreground",children:"Tamamlanan Yardım"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:N(p.monthlyAidAmount||0)}),a.jsx("div",{className:"text-sm text-muted-foreground",children:"Toplam Tutar"})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-orange-600",children:p.pendingApplications}),a.jsx("div",{className:"text-sm text-muted-foreground",children:"Bekleyen Başvuru"})]})]})]})]})}export{p as default};
