import{r as e,j as a}from"../assets/index-C7XW2vnU.js";import{D as t}from"./DataTable-BR_3tqT5.js";import{M as s}from"./Modal-QxY_FyG0.js";import{e as r}from"./exportToCsv-DLkyd1nM.js";import{L as l}from"./LazyCameraScanner-BK6mF-_0.js";import{C as n}from"./camera-TQrTJftG.js";const o=[{id:"1",donationNumber:"DN2024001",generatedDate:"2024-01-15",donorName:"Ahmet Yılmaz",donorPhone:"+90 532 123 4567",donorEmail:"ahmet.yilmaz@email.com",purpose:"Eğitim Yardımı",targetAmount:5e3,collectedAmount:3500,currency:"TRY",expiryDate:"2024-06-15",status:"aktif",qrCode:"QR_DN2024001",shortUrl:"https://bagis.org/dn001",usageCount:7,lastUsedDate:"2024-01-14",notes:"Okul öncesi eğitim için",createdBy:"Admin"},{id:"2",donationNumber:"DN2024002",generatedDate:"2024-01-10",purpose:"Genel Bağış",targetAmount:1e4,collectedAmount:1e4,currency:"TRY",expiryDate:"2024-12-31",status:"tamamlandı",qrCode:"QR_DN2024002",shortUrl:"https://bagis.org/dn002",usageCount:25,lastUsedDate:"2024-01-13",notes:"Genel amaçlı bağış kampanyası",createdBy:"Operator1"},{id:"3",donationNumber:"DN2024003",generatedDate:"2024-01-05",donorName:"Zeynep Kaya",donorPhone:"+90 533 987 6543",purpose:"Kurban",targetAmount:2500,collectedAmount:1200,currency:"TRY",expiryDate:"2024-03-01",status:"süresi doldu",qrCode:"QR_DN2024003",shortUrl:"https://bagis.org/dn003",usageCount:3,lastUsedDate:"2024-02-28",createdBy:"Admin"}];function d(){const[d,i]=e.useState(o),[m,c]=e.useState(""),[u,x]=e.useState(!1),[p,h]=e.useState(!1),[b,g]=e.useState(null),[j,N]=e.useState(null),[y,v]=e.useState({donorName:"",donorPhone:"",donorEmail:"",purpose:"",targetAmount:"",currency:"TRY",expiryDate:"",notes:""}),[f,k]=e.useState(!1),D=e.useMemo(()=>d.filter(e=>JSON.stringify(e).toLowerCase().includes(m.toLowerCase())),[d,m]),A=D.reduce((e,a)=>e+a.targetAmount,0),C=D.reduce((e,a)=>e+a.collectedAmount,0),S=D.filter(e=>"aktif"===e.status).length,T=D.filter(e=>"tamamlandı"===e.status).length,w=[{key:"donationNumber",header:"Bağış No"},{key:"generatedDate",header:"Oluşturma Tarihi"},{key:"donorName",header:"Bağışçı"},{key:"purpose",header:"Amaç"},{key:"targetAmount",header:"Hedef Tutar",render:(e,a)=>`${a.targetAmount.toLocaleString("tr-TR")} ${a.currency}`},{key:"collectedAmount",header:"Toplanan",render:(e,a)=>`${a.collectedAmount.toLocaleString("tr-TR")} ${a.currency}`},{key:"targetAmount",header:"Tamamlanma",render:(e,t)=>{const s=Math.round(t.collectedAmount/t.targetAmount*100);return a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-16 bg-gray-200 rounded-full h-2",children:a.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${Math.min(s,100)}%`}})}),a.jsxs("span",{className:"text-sm",children:[s,"%"]})]})}},{key:"usageCount",header:"Kullanım"},{key:"expiryDate",header:"Son Tarih"},{key:"status",header:"Durum",render:(e,t)=>a.jsx("span",{className:"px-2 py-1 rounded text-xs "+("aktif"===t.status?"bg-green-100 text-green-800":"tamamlandı"===t.status?"bg-blue-100 text-blue-800":"süresi doldu"===t.status?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:t.status})},{key:"id",header:"İşlemler",render:(e,t)=>a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>B(t),className:"text-purple-600 hover:text-purple-800 text-sm",children:"QR Kod"}),a.jsx("button",{onClick:()=>R(t),className:"text-blue-600 hover:text-blue-800 text-sm",children:"Düzenle"}),a.jsx("button",{onClick:()=>Y(t.id),className:"text-red-600 hover:text-red-800 text-sm",children:"Sil"})]})}],R=e=>{g(e),v({donorName:e.donorName||"",donorPhone:e.donorPhone||"",donorEmail:e.donorEmail||"",purpose:e.purpose,targetAmount:e.targetAmount.toString(),currency:e.currency,expiryDate:e.expiryDate||"",notes:e.notes||""}),x(!0)},B=e=>{N(e),h(!0)},Y=e=>{confirm("Bu bağış numarasını silmek istediğinizden emin misiniz?")&&i(d.filter(a=>a.id!==e))},$=e=>`https://bagis.org/${e.toLowerCase().replace("dn","dn")}`,E=()=>{v({donorName:"",donorPhone:"",donorEmail:"",purpose:"",targetAmount:"",currency:"TRY",expiryDate:"",notes:""})},P=e=>{navigator.clipboard.writeText(e),alert("Panoya kopyalandı!")};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Bağış Numaraları"}),a.jsx("button",{onClick:()=>{g(null),E(),x(!0)},className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Yeni Bağış Numarası"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[a.jsx("h3",{className:"text-sm font-medium text-blue-600",children:"Toplam Numara"}),a.jsx("p",{className:"text-2xl font-bold text-blue-900",children:D.length})]}),a.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[a.jsx("h3",{className:"text-sm font-medium text-green-600",children:"Aktif"}),a.jsx("p",{className:"text-2xl font-bold text-green-900",children:S})]}),a.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[a.jsx("h3",{className:"text-sm font-medium text-purple-600",children:"Tamamlanan"}),a.jsx("p",{className:"text-2xl font-bold text-purple-900",children:T})]}),a.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[a.jsx("h3",{className:"text-sm font-medium text-orange-600",children:"Toplama Oranı"}),a.jsxs("p",{className:"text-2xl font-bold text-orange-900",children:[A>0?Math.round(C/A*100):0,"%"]})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"text-lg font-medium mb-3",children:"Durum Dağılımı"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:["aktif","tamamlandı","süresi doldu","iptal"].map(e=>{const t=D.filter(a=>a.status===e).length,s=D.filter(a=>a.status===e).reduce((e,a)=>e+a.collectedAmount,0);return a.jsxs("div",{className:"border rounded-lg p-4",children:[a.jsx("h4",{className:"font-medium capitalize",children:e}),a.jsxs("p",{className:"text-sm text-gray-600",children:[t," numara"]}),a.jsxs("p",{className:"text-lg font-bold",children:[s.toLocaleString("tr-TR")," ₺"]})]},e)})})]}),a.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[a.jsx("input",{value:m,onChange:e=>c(e.target.value),className:"flex-1 border rounded px-3 py-2",placeholder:"Bağış no, bağışçı, amaç ile ara..."}),a.jsxs("select",{className:"border rounded px-3 py-2",children:[a.jsx("option",{value:"",children:"Tüm Durumlar"}),a.jsx("option",{value:"aktif",children:"Aktif"}),a.jsx("option",{value:"tamamlandı",children:"Tamamlandı"}),a.jsx("option",{value:"süresi doldu",children:"Süresi Doldu"}),a.jsx("option",{value:"iptal",children:"İptal"})]}),a.jsxs("select",{className:"border rounded px-3 py-2",children:[a.jsx("option",{value:"",children:"Tüm Amaçlar"}),a.jsx("option",{value:"Genel Bağış",children:"Genel Bağış"}),a.jsx("option",{value:"Eğitim Yardımı",children:"Eğitim Yardımı"}),a.jsx("option",{value:"Sağlık Yardımı",children:"Sağlık Yardımı"}),a.jsx("option",{value:"Kurban",children:"Kurban"}),a.jsx("option",{value:"Ramazan",children:"Ramazan"})]}),a.jsx("input",{type:"date",className:"border rounded px-3 py-2",placeholder:"Başlangıç tarihi"}),a.jsx("button",{onClick:()=>r("bagis-numaralari.csv",D),className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:"Excel İndir"})]}),a.jsx(t,{columns:w,data:D})]}),a.jsxs(s,{isOpen:u,onClose:()=>x(!1),title:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{children:b?"Bağış Numarası Düzenle":"Yeni Bağış Numarası"}),a.jsxs("button",{type:"button",onClick:()=>k(!f),className:"flex items-center gap-2 px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700",children:[a.jsx(n,{size:16}),f?"Kamerayı Kapat":"Kamera Tara"]})]}),children:[f&&a.jsx("div",{className:"mb-4",children:a.jsx(l,{onScanResult:e=>{e&&(null!=e.donorName&&v(a=>({...a,donorName:e.donorName??a.donorName})),null!=e.donorPhone&&v(a=>({...a,donorPhone:e.donorPhone??a.donorPhone})),null!=e.donorEmail&&v(a=>({...a,donorEmail:e.donorEmail??a.donorEmail})),null!=e.purpose&&v(a=>({...a,purpose:e.purpose??a.purpose})),null!=e.targetAmount&&v(a=>({...a,targetAmount:(e.targetAmount??Number(a.targetAmount||0)).toString()})),null!=e.currency&&v(a=>({...a,currency:["TRY","USD","EUR"].includes(e.currency)?e.currency:a.currency})),null!=e.expiryDate&&v(a=>({...a,expiryDate:e.expiryDate??a.expiryDate})),null!=e.notes&&v(a=>({...a,notes:e.notes??a.notes})),e.firstName&&e.lastName&&v(a=>({...a,donorName:`${e.firstName} ${e.lastName}`})),e.phone&&v(a=>({...a,donorPhone:e.phone||""})),e.idNumber&&v(a=>({...a,notes:a.notes?`${a.notes} | TC: ${e.idNumber}`:`TC: ${e.idNumber}`})),e.passportNumber&&v(a=>({...a,notes:a.notes?`${a.notes} | Pasaport: ${e.passportNumber}`:`Pasaport: ${e.passportNumber}`})),e.address&&v(a=>({...a,notes:a.notes?`${a.notes} | Adres: ${e.address}`:`Adres: ${e.address}`})),e.birthDate&&v(a=>({...a,notes:a.notes?`${a.notes} | Doğum: ${e.birthDate}`:`Doğum: ${e.birthDate}`})),k(!1))},onError:e=>{}})}),a.jsxs("form",{onSubmit:e=>{if(e.preventDefault(),b)i(d.map(e=>e.id===b.id?{...e,...y,targetAmount:parseFloat(y.targetAmount)}:e));else{const e=`DN${(new Date).getFullYear()}${(d.length+1).toString().padStart(3,"0")}`,a={id:Date.now().toString(),donationNumber:e,generatedDate:(new Date).toISOString().split("T")[0],...y,targetAmount:parseFloat(y.targetAmount),collectedAmount:0,status:"aktif",qrCode:`QR_${e}`,shortUrl:$(e),usageCount:0,createdBy:"Admin"};i([...d,a])}x(!1),g(null),E()},className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Bağışçı Adı (Opsiyonel)"}),a.jsx("input",{type:"text",value:y.donorName,onChange:e=>v({...y,donorName:e.target.value}),className:"w-full border rounded px-3 py-2",placeholder:"Belirli bir bağışçı için"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Telefon"}),a.jsx("input",{type:"tel",value:y.donorPhone,onChange:e=>v({...y,donorPhone:e.target.value}),className:"w-full border rounded px-3 py-2"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"E-posta"}),a.jsx("input",{type:"email",value:y.donorEmail,onChange:e=>v({...y,donorEmail:e.target.value}),className:"w-full border rounded px-3 py-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Bağış Amacı"}),a.jsxs("select",{value:y.purpose,onChange:e=>v({...y,purpose:e.target.value}),className:"w-full border rounded px-3 py-2",required:!0,children:[a.jsx("option",{value:"",children:"Seçiniz"}),a.jsx("option",{value:"Genel Bağış",children:"Genel Bağış"}),a.jsx("option",{value:"Eğitim Yardımı",children:"Eğitim Yardımı"}),a.jsx("option",{value:"Sağlık Yardımı",children:"Sağlık Yardımı"}),a.jsx("option",{value:"Gıda Yardımı",children:"Gıda Yardımı"}),a.jsx("option",{value:"Kurban",children:"Kurban"}),a.jsx("option",{value:"Ramazan",children:"Ramazan"}),a.jsx("option",{value:"Diğer",children:"Diğer"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hedef Tutar"}),a.jsx("input",{type:"number",step:"0.01",value:y.targetAmount,onChange:e=>v({...y,targetAmount:e.target.value}),className:"w-full border rounded px-3 py-2",required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Para Birimi"}),a.jsxs("select",{value:y.currency,onChange:e=>v({...y,currency:e.target.value}),className:"w-full border rounded px-3 py-2",children:[a.jsx("option",{value:"TRY",children:"TRY"}),a.jsx("option",{value:"USD",children:"USD"}),a.jsx("option",{value:"EUR",children:"EUR"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Son Kullanım Tarihi (Opsiyonel)"}),a.jsx("input",{type:"date",value:y.expiryDate,onChange:e=>v({...y,expiryDate:e.target.value}),className:"w-full border rounded px-3 py-2"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notlar"}),a.jsx("textarea",{value:y.notes,onChange:e=>v({...y,notes:e.target.value}),className:"w-full border rounded px-3 py-2",rows:3,placeholder:"Bağış numarası hakkında ek bilgiler..."})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>x(!1),className:"px-4 py-2 border rounded hover:bg-gray-50",children:"İptal"}),a.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:b?"Güncelle":"Oluştur"})]})]})]}),a.jsx(s,{isOpen:p,onClose:()=>h(!1),title:"QR Kod ve Bağış Linki",children:j&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("h3",{className:"text-lg font-medium mb-2",children:j.donationNumber}),a.jsx("p",{className:"text-gray-600 mb-4",children:j.purpose}),a.jsx("div",{className:"w-48 h-48 mx-auto bg-gray-100 border-2 border-dashed border-gray-300 flex items-center justify-center mb-4",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-4xl mb-2",children:"📱"}),a.jsx("div",{className:"text-sm text-gray-500",children:"QR Kod"}),a.jsx("div",{className:"text-xs text-gray-400",children:j.qrCode})]})})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Bağış Linki"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:j.shortUrl,readOnly:!0,className:"flex-1 border rounded px-3 py-2 bg-gray-50"}),a.jsx("button",{onClick:()=>P(j.shortUrl),className:"px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Kopyala"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hedef Tutar"}),a.jsxs("div",{className:"text-lg font-bold",children:[j.targetAmount.toLocaleString("tr-TR")," ",j.currency]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Toplanan"}),a.jsxs("div",{className:"text-lg font-bold text-green-600",children:[j.collectedAmount.toLocaleString("tr-TR")," ",j.currency]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Kullanım Sayısı"}),a.jsx("div",{className:"text-lg font-bold",children:j.usageCount})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Son Kullanım"}),a.jsx("div",{className:"text-sm",children:j.lastUsedDate||"Henüz kullanılmadı"})]})]}),j.expiryDate&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Son Tarih"}),a.jsx("div",{className:"text-sm",children:j.expiryDate})]})]}),a.jsxs("div",{className:"flex justify-center gap-2 pt-4",children:[a.jsx("button",{onClick:()=>window.open(j.shortUrl,"_blank"),className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"Bağış Sayfasını Aç"}),a.jsx("button",{onClick:()=>P(j.shortUrl),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Linki Paylaş"})]})]})})]})}export{d as default};
