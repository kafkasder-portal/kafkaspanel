import{t as e,r as t,j as a,e as r,T as s,k as l,S as n,n as i,h as o,aA as d,X as c,a9 as m,q as p}from"../assets/index-dW79Uy5k.js";import{e as x}from"./exportToCsv-DLkyd1nM.js";import{D as u}from"./DataTable-Co2fK-v0.js";import{M as h}from"./Modal-BBek2lFh.js";import{S as g}from"./StatCard-CRbncoUZ.js";import{u as y,t as b,o as j,s as f,n as v,e as N}from"./types-DWSxFkmy.js";import{V as k}from"./index-BPtWanD8.js";import{T as w}from"./trending-down-BgaEdcG2.js";import{E as _}from"./eye-C2ZiGWXh.js";import{P as S}from"./pen-square-DLfSiTnY.js";const T=e("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]),C=j({operation_type:N(["income","expense","transfer"],{message:"İşlem türü seçiniz"}),amount:v().min(.01,"Geçerli bir tutar giriniz"),description:f().min(1,"Açıklama giriniz"),category:f().min(1,"Kategori seçiniz"),reference_number:f().optional(),from_account:f().optional(),to_account:f().optional(),notes:f().optional()}),D={income:["Bağış Geliri","Faiz Geliri","Kira Geliri","Diğer Gelirler"],expense:["Nakdi Yardım","Personel Gideri","Kira Gideri","Elektrik-Su","Telefon-İnternet","Kırtasiye","Diğer Giderler"],transfer:["Hesap Arası Transfer","Banka Transfer","Kasa Transfer"]};function G(){var e;const[j,f]=t.useState([]),[v,N]=t.useState({totalIncome:0,totalExpense:0,balance:0,todayOperations:0}),[G,M]=t.useState(!0),[E,I]=t.useState(""),[z,A]=t.useState("all"),[B,Y]=t.useState("all"),[K,O]=t.useState("all"),[R,F]=t.useState(!1),[L,H]=t.useState(null),{register:q,handleSubmit:U,formState:{errors:P},reset:V,watch:$}=y({resolver:b(C)}),J=$("operation_type");t.useEffect(()=>{Q(),W()},[]);const Q=async()=>{try{const e=[{id:"1",operation_type:"income",amount:5e4,description:"Aylık bağış geliri",category:"Bağış Geliri",reference_number:"REF001",operator_id:"user1",operation_date:(new Date).toISOString(),status:"completed",created_at:(new Date).toISOString(),operator:{name:"Admin User",email:"admin@example.com"}},{id:"2",operation_type:"expense",amount:15e3,description:"Nakdi yardım ödemesi",category:"Nakdi Yardım",reference_number:"REF002",operator_id:"user1",operation_date:(new Date).toISOString(),status:"completed",created_at:(new Date).toISOString(),operator:{name:"Admin User",email:"admin@example.com"}}];f(e)}catch(e){k.error("Nakdi işlemler yüklenirken hata oluştu")}finally{M(!1)}},W=async()=>{try{N({totalIncome:15e4,totalExpense:85e3,balance:65e3,todayOperations:5})}catch(e){}},X=t.useMemo(()=>j.filter(e=>{var t;const a=""===E||e.description.toLowerCase().includes(E.toLowerCase())||e.category.toLowerCase().includes(E.toLowerCase())||(null==(t=e.reference_number)?void 0:t.toLowerCase().includes(E.toLowerCase())),r="all"===z||e.operation_type===z,s="all"===B||e.status===B;let l=!0;if("all"!==K){const t=new Date(e.operation_date),a=new Date;switch(K){case"today":l=t.toDateString()===a.toDateString();break;case"week":l=t>=new Date(a.getTime()-6048e5);break;case"month":l=t.getMonth()===a.getMonth()&&t.getFullYear()===a.getFullYear()}}return a&&r&&s&&l}),[j,E,z,B,K]),Z=e=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY"}).format(e),ee=[{key:"operation_type",header:"İşlem Türü",render:(e,t)=>(e=>{const t={income:{label:"Gelir",class:"bg-green-100 text-green-800",icon:s},expense:{label:"Gider",class:"bg-red-100 text-red-800",icon:w},transfer:{label:"Transfer",class:"bg-blue-100 text-blue-800",icon:o}}[e]||{label:e,class:"bg-gray-100 text-gray-800",icon:d},r=t.icon;return a.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2 py-1 text-xs font-medium ${t.class}`,children:[a.jsx(r,{className:"h-3 w-3"}),t.label]})})(t.operation_type)},{key:"description",header:"Açıklama",render:(e,t)=>a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:t.description}),a.jsx("div",{className:"text-sm text-muted-foreground",children:t.category})]})},{key:"amount",header:"Tutar",render:(e,t)=>a.jsxs("div",{className:"font-medium "+("income"===t.operation_type?"text-green-600":"expense"===t.operation_type?"text-red-600":"text-blue-600"),children:["income"===t.operation_type?"+":"expense"===t.operation_type?"-":"",Z(t.amount)]})},{key:"reference_number",header:"Referans No",render:(e,t)=>t.reference_number||"-"},{key:"operation_date",header:"İşlem Tarihi",render:(e,t)=>{return a=t.operation_date,new Date(a).toLocaleDateString("tr-TR");var a}},{key:"status",header:"Durum",render:(e,t)=>(e=>{const t={pending:{label:"Beklemede",class:"bg-yellow-100 text-yellow-800",icon:p},completed:{label:"Tamamlandı",class:"bg-green-100 text-green-800",icon:m},cancelled:{label:"İptal Edildi",class:"bg-red-100 text-red-800",icon:c}}[e]||{label:e,class:"bg-gray-100 text-gray-800",icon:m},r=t.icon;return a.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full px-2 py-1 text-xs font-medium ${t.class}`,children:[a.jsx(r,{className:"h-3 w-3"}),t.label]})})(t.status)},{key:"operator",header:"İşlem Yapan",render:(e,t)=>{var a;return(null==(a=t.operator)?void 0:a.name)||"-"}},{key:"actions",header:"İşlemler",render:(e,t)=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{className:"rounded p-1 text-gray-600 hover:bg-gray-50",title:"Detay",children:a.jsx(_,{className:"h-4 w-4"})}),"pending"===t.status&&a.jsx("button",{onClick:()=>{H(t),F(!0)},className:"rounded p-1 text-blue-600 hover:bg-blue-50",title:"Düzenle",children:a.jsx(S,{className:"h-4 w-4"})})]})}];return G?a.jsx("div",{className:"flex h-64 items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent mx-auto mb-2"}),a.jsx("p",{className:"text-muted-foreground",children:"Yükleniyor..."})]})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold",children:"Nakdi Yardım İşlemleri"}),a.jsx("p",{className:"text-muted-foreground",children:"Nakdi işlemleri kaydedin ve takip edin"})]}),a.jsxs("button",{onClick:()=>{H(null),F(!0)},className:"flex items-center gap-2 rounded bg-primary px-4 py-2 text-sm text-white hover:bg-primary/90",children:[a.jsx(r,{className:"h-4 w-4"}),"Yeni İşlem"]})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[a.jsx(g,{title:"Toplam Gelir",value:Z(v.totalIncome),icon:s,accentClass:"bg-green-100"}),a.jsx(g,{title:"Toplam Gider",value:Z(v.totalExpense),icon:w,accentClass:"bg-red-100"}),a.jsx(g,{title:"Bakiye",value:Z(v.balance),icon:T,accentClass:"bg-blue-100"}),a.jsx(g,{title:"Bugünkü İşlemler",value:v.todayOperations.toString(),icon:l,accentClass:"bg-purple-100"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-4 rounded-lg border p-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(n,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("input",{type:"text",placeholder:"İşlem ara...",value:E,onChange:e=>I(e.target.value),className:"min-w-64 rounded border px-3 py-2 text-sm"})]}),a.jsxs("select",{value:z,onChange:e=>A(e.target.value),className:"rounded border px-3 py-2 text-sm",children:[a.jsx("option",{value:"all",children:"Tüm Türler"}),a.jsx("option",{value:"income",children:"Gelir"}),a.jsx("option",{value:"expense",children:"Gider"}),a.jsx("option",{value:"transfer",children:"Transfer"})]}),a.jsxs("select",{value:B,onChange:e=>Y(e.target.value),className:"rounded border px-3 py-2 text-sm",children:[a.jsx("option",{value:"all",children:"Tüm Durumlar"}),a.jsx("option",{value:"pending",children:"Bekleyen"}),a.jsx("option",{value:"completed",children:"Tamamlanan"}),a.jsx("option",{value:"cancelled",children:"İptal Edilen"})]}),a.jsxs("select",{value:K,onChange:e=>O(e.target.value),className:"rounded border px-3 py-2 text-sm",children:[a.jsx("option",{value:"all",children:"Tüm Tarihler"}),a.jsx("option",{value:"today",children:"Bugün"}),a.jsx("option",{value:"week",children:"Bu Hafta"}),a.jsx("option",{value:"month",children:"Bu Ay"})]}),a.jsxs("button",{onClick:()=>x("nakdi-islemler.csv",X),className:"flex items-center gap-2 rounded bg-green-600 px-3 py-2 text-sm text-white hover:bg-green-700",children:[a.jsx(i,{className:"h-4 w-4"}),"İndir"]}),a.jsxs("div",{className:"ml-auto text-sm text-muted-foreground",children:[X.length," işlem"]})]}),a.jsx(u,{columns:ee,data:X}),a.jsxs(h,{open:R,onClose:()=>F(!1),children:[a.jsxs("div",{className:"flex items-center justify-between border-b p-4",children:[a.jsx("h2",{className:"text-lg font-semibold",children:L?"İşlem Düzenle":"Yeni Nakdi İşlem"}),a.jsx("button",{onClick:()=>F(!1),className:"h-8 w-8 rounded-full bg-red-600 text-white hover:bg-red-700",children:"×"})]}),a.jsxs("form",{onSubmit:U(async e=>{try{const t={id:Date.now().toString(),...e,operator_id:"current_user",operation_date:(new Date).toISOString(),status:"completed",created_at:(new Date).toISOString(),operator:{name:"Current User",email:"user@example.com"}};f(e=>[t,...e]),k.success("Nakdi işlem başarıyla kaydedildi"),F(!1),V(),W()}catch(t){k.error("Nakdi işlem kaydedilirken hata oluştu")}}),className:"p-4 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"İşlem Türü *"}),a.jsxs("select",{...q("operation_type"),className:"w-full rounded border px-3 py-2 text-sm",children:[a.jsx("option",{value:"",children:"Seçiniz..."}),a.jsx("option",{value:"income",children:"Gelir"}),a.jsx("option",{value:"expense",children:"Gider"}),a.jsx("option",{value:"transfer",children:"Transfer"})]}),P.operation_type&&a.jsx("p",{className:"text-sm text-red-600 mt-1",children:P.operation_type.message})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Kategori *"}),a.jsxs("select",{...q("category"),className:"w-full rounded border px-3 py-2 text-sm",disabled:!J,children:[a.jsx("option",{value:"",children:"Seçiniz..."}),J&&(null==(e=D[J])?void 0:e.map(e=>a.jsx("option",{value:e,children:e},e)))]}),P.category&&a.jsx("p",{className:"text-sm text-red-600 mt-1",children:P.category.message})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Tutar *"}),a.jsx("input",{type:"number",step:"0.01",...q("amount",{valueAsNumber:!0}),className:"w-full rounded border px-3 py-2 text-sm",placeholder:"0.00"}),P.amount&&a.jsx("p",{className:"text-sm text-red-600 mt-1",children:P.amount.message})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Referans Numarası"}),a.jsx("input",{type:"text",...q("reference_number"),className:"w-full rounded border px-3 py-2 text-sm",placeholder:"REF001"})]})]}),"transfer"===J&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Kaynak Hesap"}),a.jsx("input",{type:"text",...q("from_account"),className:"w-full rounded border px-3 py-2 text-sm",placeholder:"Kaynak hesap"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Hedef Hesap"}),a.jsx("input",{type:"text",...q("to_account"),className:"w-full rounded border px-3 py-2 text-sm",placeholder:"Hedef hesap"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Açıklama *"}),a.jsx("input",{type:"text",...q("description"),className:"w-full rounded border px-3 py-2 text-sm",placeholder:"İşlem açıklaması"}),P.description&&a.jsx("p",{className:"text-sm text-red-600 mt-1",children:P.description.message})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"Notlar"}),a.jsx("textarea",{...q("notes"),rows:3,className:"w-full rounded border px-3 py-2 text-sm",placeholder:"İşlem ile ilgili notlar..."})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[a.jsx("button",{type:"button",onClick:()=>F(!1),className:"rounded border px-4 py-2 text-sm hover:bg-gray-50",children:"İptal"}),a.jsxs("button",{type:"submit",className:"flex items-center gap-2 rounded bg-primary px-4 py-2 text-sm text-white hover:bg-primary/90",children:[a.jsx(r,{className:"h-4 w-4"}),L?"Güncelle":"Kaydet"]})]})]})]})]})}export{G as default};
