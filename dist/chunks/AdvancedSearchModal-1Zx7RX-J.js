var e=Object.defineProperty,t=(t,a,r)=>((t,a,r)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[a]=r)(t,"symbol"!=typeof a?a+"":a,r);import{r as a,j as r,c as i,X as s,a0 as l,s as n,F as d,S as o}from"../assets/index-dW79Uy5k.js";import{i as c,e as u,s as m}from"./sanitization-DKE2yZnW.js";class h{constructor(e,a=[],r=[],i=[]){t(this,"fields"),t(this,"dependencies"),t(this,"groups"),t(this,"validationRules"),t(this,"_visibleFieldsCache"),this.fields=e,this.dependencies=a,this.groups=r,this.validationRules=i}getVisibleFields(e){var t;const a=JSON.stringify(Object.keys(e).sort());if((null==(t=this._visibleFieldsCache)?void 0:t.key)===a)return this._visibleFieldsCache.fields;const r=this.fields.filter(t=>{const a=this.dependencies.find(e=>e.field===t.key);if(!a)return!0;const r=e[a.dependsOn];return this.evaluateCondition(r,a.condition)});return this._visibleFieldsCache={key:a,fields:r},r}getEnabledFields(e){const t=[];return this.fields.forEach(a=>{const r=this.dependencies.find(e=>e.field===a.key&&"enable"===e.action);if(!r)return void t.push(a.key);const i=e[r.dependsOn];this.evaluateCondition(i,r.condition)&&t.push(a.key)}),t}getFieldsToClear(e,t){const a=[];return this.dependencies.forEach(r=>{r.dependsOn===e&&"clear"===r.action&&(this.evaluateCondition(t,r.condition)||a.push(r.field))}),a}validateFilters(e){const t={},a=this.getVisibleFields(e),r=this.getEnabledFields(e);for(const i of a){if(!r.includes(i.key))continue;const a=e[i.key],s=this.validationRules.find(e=>e.field===i.key);if(s)if(s.rules.required&&this.isEmpty(a))t[i.key]=`${i.label} alanı zorunludur`;else if(!this.isEmpty(a)){if("number"==typeof a){if(void 0!==s.rules.min&&a<s.rules.min){t[i.key]=`${i.label} en az ${s.rules.min} olmalıdır`;continue}if(void 0!==s.rules.max&&a>s.rules.max){t[i.key]=`${i.label} en fazla ${s.rules.max} olmalıdır`;continue}}if("string"==typeof a){if(void 0!==s.rules.min&&a.length<s.rules.min){t[i.key]=`${i.label} en az ${s.rules.min} karakter olmalıdır`;continue}if(void 0!==s.rules.max&&a.length>s.rules.max){t[i.key]=`${i.label} en fazla ${s.rules.max} karakter olmalıdır`;continue}}if(s.rules.pattern&&"string"==typeof a&&!new RegExp(s.rules.pattern).test(a)){t[i.key]=`${i.label} geçerli bir format değil`;continue}if(s.rules.custom){const r=s.rules.custom(a,e);if(r){t[i.key]=r;continue}}}}return{isValid:0===Object.keys(t).length,errors:t}}getGroupedFields(e){const t=this.getVisibleFields(e),a=[],r=new Set;this.groups.forEach(e=>{const i=t.filter(t=>e.fields.includes(t.key));i.length>0&&(a.push({group:e,fields:i}),i.forEach(e=>r.add(e.key)))});const i=t.filter(e=>!r.has(e.key));return i.length>0&&a.push({group:null,fields:i}),a}applyFilterChange(e,t,a){const r={...e,[t]:a};return this.getFieldsToClear(t,a).forEach(e=>{delete r[e]}),r}buildQueryParams(e){const t={},a=this.getVisibleFields(e),r=this.getEnabledFields(e),i=Object.entries(e).filter(([,e])=>!this.isEmpty(e));for(const s of a){if(!r.includes(s.key))continue;const e=i.find(([e])=>e===s.key);if(!e)continue;const[,a]=e;switch(s.type){case"multiSelect":Array.isArray(a)&&a.length>0&&(t[s.key]=a);break;case"dateRange":a&&a.start&&a.end&&(t[`${s.key}_start`]=a.start,t[`${s.key}_end`]=a.end);break;case"numberRange":!a||void 0===a.min&&void 0===a.max||(void 0!==a.min&&(t[`${s.key}_min`]=a.min),void 0!==a.max&&(t[`${s.key}_max`]=a.max));break;default:t[s.key]=a}}return t}evaluateCondition(e,t){const{operator:a,value:r}=t;switch(a){case"equals":return e===r;case"not_equals":return e!==r;case"contains":return"string"==typeof e&&"string"==typeof r&&e.includes(r);case"not_contains":return"string"==typeof e&&"string"==typeof r&&!e.includes(r);case"greater_than":return"number"==typeof e&&"number"==typeof r&&e>r;case"less_than":return"number"==typeof e&&"number"==typeof r&&e<r;case"in":return Array.isArray(r)&&r.includes(e);case"not_in":return Array.isArray(r)&&!r.includes(e);default:return!1}}isEmpty(e){return null==e||""===e||(Array.isArray(e)?0===e.length:"object"==typeof e&&(0===Object.keys(e).length||Object.values(e).every(e=>null==e||""===e)))}resetFilters(){const e={};return this.fields.forEach(t=>{switch(t.type){case"multiSelect":e[t.key]=void 0!==t.defaultValue?t.defaultValue:[];break;case"numberRange":case"dateRange":e[t.key]=void 0!==t.defaultValue?t.defaultValue:{};break;default:e[t.key]=void 0!==t.defaultValue?t.defaultValue:""}}),e}static resetFilters(e){const t={};return e.forEach(e=>{switch(e.type){case"multiSelect":t[e.key]=void 0!==e.defaultValue?e.defaultValue:[];break;case"numberRange":case"dateRange":t[e.key]=void 0!==e.defaultValue?e.defaultValue:{};break;default:t[e.key]=void 0!==e.defaultValue?e.defaultValue:""}}),t}static buildFilterQuery(e){const t={};return Object.entries(e).forEach(([e,a])=>{null!=a&&""!==a&&(Array.isArray(a)?a.length>0&&(t[e]=a):"object"==typeof a?a.from&&a.to?(t[`${e}_from`]=a.from,t[`${e}_to`]=a.to):void 0!==a.min||void 0!==a.max?(void 0!==a.min&&(t[`${e}_min`]=a.min),void 0!==a.max&&(t[`${e}_max`]=a.max)):Object.keys(a).length>0&&(t[e]=a):t[e]=a)}),t}static getVisibleFields(e){return e.filter(e=>!1!==e.visible)}static validateFilters(e,t,a=[]){const r={};for(const i of t){const t=e[i.key],a=i.validation;if(a)if(!a.required||t&&""!==t){if(t&&""!==t)if(a.minLength&&"string"==typeof t&&t.length<a.minLength)r[i.key]=`En az ${a.minLength} karakter olmalıdır`;else{if(a.pattern&&"string"==typeof t&&!new RegExp(a.pattern).test(t)){r[i.key]="Geçerli bir email adresi girin";continue}if("number"==typeof t){if(void 0!==a.min&&t<a.min){r[i.key]=`Minimum değer ${a.min} olmalıdır`;continue}if(void 0!==a.max&&t>a.max){r[i.key]=`Maksimum değer ${a.max} olmalıdır`;continue}}}}else r[i.key]="Bu alan zorunludur"}for(const i of a)if(i.rules.custom){const t=e[i.field],a=i.rules.custom(t,e);a&&(r[i.field]=a)}return r}static applyDependencies(e,t,a){return e.map(e=>{const r=a.filter(t=>t.field===e.key);if(0===r.length)return{...e,visible:!0,enabled:!0};let i=!1!==e.visible,s=!1!==e.enabled;for(const a of r){const e=t[a.dependsOn],r=h.evaluateCondition(e,a.condition);"show"===a.action?i=i&&r:"hide"===a.action?i=i&&!r:"enable"===a.action?s=s&&r:"disable"===a.action&&(s=s&&!r)}return{...e,visible:i,enabled:s}})}static evaluateCondition(e,t){const{operator:a,value:r}=t;switch(a){case"equals":return e===r;case"not_equals":return e!==r;case"contains":return"string"==typeof e&&"string"==typeof r&&e.includes(r);case"not_contains":return"string"==typeof e&&"string"==typeof r&&!e.includes(r);case"greater_than":return"number"==typeof e&&"number"==typeof r&&e>r;case"less_than":return"number"==typeof e&&"number"==typeof r&&e<r;case"greater_than_or_equal":return"number"==typeof e&&"number"==typeof r&&e>=r;case"less_than_or_equal":return"number"==typeof e&&"number"==typeof r&&e<=r;case"in":return Array.isArray(r)&&r.includes(e);case"not_in":return Array.isArray(r)&&!r.includes(e);case"not_empty":return null!=e&&""!==e;case"empty":return null==e||""===e;default:return!1}}}const g=()=>({fields:[{key:"name",label:"Ad Soyad",type:"text",placeholder:"Yararlanıcı adı ara..."},{key:"status",label:"Durum",type:"select",options:[{value:"active",label:"Aktif"},{value:"inactive",label:"Pasif"},{value:"pending",label:"Beklemede"}]},{key:"categories",label:"Kategoriler",type:"multiSelect",options:[{value:"education",label:"Eğitim"},{value:"health",label:"Sağlık"},{value:"food",label:"Gıda"},{value:"shelter",label:"Barınma"}]},{key:"ageRange",label:"Yaş Aralığı",type:"numberRange",validation:{min:0,max:120}},{key:"registrationDate",label:"Kayıt Tarihi",type:"dateRange"},{key:"priority",label:"Öncelik",type:"select",options:[{value:"high",label:"Yüksek"},{value:"medium",label:"Orta"},{value:"low",label:"Düşük"}]},{key:"hasActiveApplication",label:"Aktif Başvuru Var",type:"select",options:[{value:"true",label:"Evet"},{value:"false",label:"Hayır"}]}],dependencies:[{field:"priority",dependsOn:"status",condition:{operator:"equals",value:"active"},action:"show"}],groups:[{id:"basic",key:"basic",label:"Temel Bilgiler",fields:["name","status","categories"],operator:"AND"},{id:"demographics",key:"demographics",label:"Demografik Bilgiler",fields:["ageRange","registrationDate"],operator:"AND",collapsible:!0,defaultCollapsed:!0},{id:"advanced",key:"advanced",label:"Gelişmiş Filtreler",fields:["priority","hasActiveApplication"],operator:"AND",collapsible:!0,defaultCollapsed:!0}],validationRules:[{field:"ageRange",rules:{custom:e=>{if(e&&"object"==typeof e&&null!==e&&"min"in e&&"max"in e){const t=e;if(t.min&&t.max&&t.min>t.max)return"Minimum yaş maksimum yaştan büyük olamaz"}return null}}}]});class p{constructor(e){t(this,"config"),this.config={paramPrefix:"filter_",encodeValues:!0,excludeEmpty:!0,dateFormat:"iso",...e}}filtersToURL(e){const t=new URLSearchParams;Object.entries(e).forEach(([e,a])=>{if(this.config.excludeEmpty&&this.isEmpty(a))return;const r=this.config.paramPrefix+e,i=this.serializeValue(a);null!==i&&t.set(r,i)});const a=t.toString();return a?`${this.config.baseUrl}?${a}`:this.config.baseUrl}urlToFilters(e){const t={};try{if(!c(e))return{};let a;if(e.startsWith("http://")||e.startsWith("https://"))a=u(e);else{const t="undefined"!=typeof window?window.location.origin:"http://localhost";a=u(e,t)}if(!a)return{};a.searchParams.forEach((e,a)=>{if(a.startsWith(this.config.paramPrefix||"")){const r=a.replace(this.config.paramPrefix||"",""),i=m(e),s=this.deserializeValue(i);null!==s&&(t[r]=s)}})}catch(a){}return t}getCurrentFilters(){return"undefined"==typeof window?{}:this.urlToFilters(window.location.href)}updateBrowserURL(e,t=!1){if("undefined"==typeof window)return;const a=this.filtersToURL(e);(c(a)||a.startsWith("/"))&&(t?window.history.replaceState({},"",a):window.history.pushState({},"",a))}generateShareableURL(e,t){try{const a=this.filtersToURL(e);if(t){if(!c(t))return a;const e=u(a,t);return e?e.toString():a}if("undefined"!=typeof window&&window.location&&window.location.origin){const e=u(a,window.location.origin);return e?e.toString():a}return a}catch(a){return""}}parseShareableURL(e){return this.urlToFilters(e)}createFilteredURL(e,t){const a={...e,...t};return this.filtersToURL(a)}removeFiltersFromURL(e,t){const a={...e};return t.forEach(e=>{delete a[e]}),this.filtersToURL(a)}hasFilters(){const e=this.getCurrentFilters();return Object.keys(e).length>0}clearFiltersFromURL(e=!1){if("undefined"==typeof window)return;const t=this.config.baseUrl;e?window.history.replaceState({},"",t):window.history.pushState({},"",t)}onURLChange(e){if("undefined"==typeof window)return()=>{};const t=()=>{const t=this.getCurrentFilters();e(t)};return window.addEventListener("popstate",t),()=>{window.removeEventListener("popstate",t)}}validateURLFilters(e,t){const a={};return Object.entries(e).forEach(([e,r])=>{t.includes(e)&&(a[e]=r)}),a}serializeValue(e){if(this.isEmpty(e))return null;try{if("string"==typeof e)return this.config.encodeValues?encodeURIComponent(e):e;if("number"==typeof e||"boolean"==typeof e)return String(e);if(e instanceof Date)switch(this.config.dateFormat){case"timestamp":return String(e.getTime());case"date":return e.toISOString().split("T")[0];default:return e.toISOString()}if(Array.isArray(e)){const t=e.filter(e=>!this.isEmpty(e)).map(e=>this.serializeValue(e)).filter(e=>null!==e);return t.length>0?t.join(","):null}if("object"==typeof e&&null!==e){if("start"in e&&"end"in e&&e.start&&e.end){const t=this.serializeValue(e.start),a=this.serializeValue(e.end);return t&&a?`${t}|${a}`:null}if("min"in e||"max"in e){return`${"min"in e&&void 0!==e.min?String(e.min):""}|${"max"in e&&void 0!==e.max?String(e.max):""}`}return JSON.stringify(e)}return String(e)}catch(t){return null}}deserializeValue(e){if(!e)return null;try{const t=this.config.encodeValues?decodeURIComponent(e):e;if(t.includes(",")&&!t.includes("|"))return t.split(",").map(e=>{const t=e.trim();return this.parseSimpleValue(t)});if(t.includes("|")){const[e,a]=t.split("|");return this.isDateString(e)||this.isDateString(a)?{start:e?this.parseDate(e):null,end:a?this.parseDate(a):null}:this.isNumeric(e)||this.isNumeric(a)?{min:e?Number(e):void 0,max:a?Number(a):void 0}:{start:e||null,end:a||null}}return t.startsWith("{")&&t.endsWith("}")||t.startsWith("[")&&t.endsWith("]")?JSON.parse(t):this.parseSimpleValue(t)}catch(t){return e}}parseSimpleValue(e){return"true"===e||"false"!==e&&(this.isNumeric(e)?Number(e):this.isDateString(e)?this.parseDate(e):e)}parseDate(e){try{if("timestamp"===this.config.dateFormat&&this.isNumeric(e))return new Date(Number(e));const t=new Date(e);return isNaN(t.getTime())?null:t}catch{return null}}isNumeric(e){return!isNaN(Number(e))&&!isNaN(parseFloat(e))}isDateString(e){if(!e)return!1;if(/^\d{4}-\d{2}-\d{2}(T\d{2}:\d{2}:\d{2}(\.\d{3})?Z?)?$/.test(e))return!0;if("timestamp"===this.config.dateFormat&&this.isNumeric(e)){const t=Number(e);return t>0&&t<2*Date.now()}return!1}isEmpty(e){return null==e||""===e||(Array.isArray(e)?0===e.length:"object"==typeof e&&(0===Object.keys(e).length||Object.values(e).every(e=>null==e||""===e)))}}const f=()=>({baseUrl:"/beneficiaries",paramPrefix:"bf_",encodeValues:!0,excludeEmpty:!0,dateFormat:"iso"});class y{constructor(e){t(this,"config"),t(this,"storageKey"),this.config={maxSavedFilters:50,enableCloud:!1,...e},this.storageKey=e.userId?`${e.storageKey}_${e.userId}`:e.storageKey}async saveFilter(e){const t=await this.getSavedFilters();if(t.length>=(this.config.maxSavedFilters||50))throw new Error(`Maksimum ${this.config.maxSavedFilters} adet filtre kaydedebilirsiniz`);if(t.some(t=>t.name===e.name&&t.pageType===e.pageType))throw new Error("Bu isimde bir filtre zaten mevcut");const a={...e,id:this.generateId(),createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),usageCount:0,lastUsed:(new Date).toISOString()},r=[...t,a];return await this.storeSavedFilters(r),a}async getSavedFilters(e){try{const t=localStorage.getItem(this.storageKey),a=t?JSON.parse(t):[];return e?a.filter(t=>t.pageType===e):a}catch(t){return[]}}async getSavedFilter(e){return(await this.getSavedFilters()).find(t=>t.id===e)||null}async updateSavedFilter(e,t){const a=await this.getSavedFilters(),r=a.findIndex(t=>t.id===e);if(-1===r)throw new Error("Filtre bulunamadı");if(t.name&&t.name!==a[r].name&&a.some((e,i)=>i!==r&&e.name===t.name&&e.pageType===a[r].pageType))throw new Error("Bu isimde bir filtre zaten mevcut");const i={...a[r],...t,updatedAt:(new Date).toISOString()};return a[r]=i,await this.storeSavedFilters(a),i}async deleteSavedFilter(e){const t=await this.getSavedFilters(),a=t.filter(t=>t.id!==e);return a.length!==t.length&&(await this.storeSavedFilters(a),!0)}async loadSavedFilter(e){const t=await this.getSavedFilter(e);return t?(await this.updateSavedFilter(e,{usageCount:t.usageCount+1,lastUsed:(new Date).toISOString()}),t):null}async getRecentFilters(e,t=5){return(await this.getSavedFilters(e)).filter(e=>e.usageCount>0).sort((e,t)=>new Date(t.lastUsed).getTime()-new Date(e.lastUsed).getTime()).slice(0,t)}async getPopularFilters(e,t=5){return(await this.getSavedFilters(e)).filter(e=>e.usageCount>0).sort((e,t)=>t.usageCount-e.usageCount).slice(0,t)}async searchSavedFilters(e,t){const a=await this.getSavedFilters(t),r=e.toLowerCase();return a.filter(e=>e.name.toLowerCase().includes(r)||e.description&&e.description.toLowerCase().includes(r))}async exportSavedFilters(e){const t=await this.getSavedFilters(e);return JSON.stringify(t,null,2)}async importSavedFilters(e,t=!1){try{const a=JSON.parse(e);if(!Array.isArray(a))throw new Error("Geçersiz veri formatı");const r=await this.getSavedFilters();let i;if(t)i=a.map(e=>({...e,id:this.generateId(),createdAt:e.createdAt,updatedAt:(new Date).toISOString(),lastUsed:e.lastUsed}));else{const e=new Set(r.map(e=>`${e.name}_${e.pageType}`)),t=a.filter(t=>!e.has(`${t.name}_${t.pageType}`));i=[...r,...t.map(e=>({...e,id:this.generateId(),createdAt:e.createdAt,updatedAt:(new Date).toISOString(),lastUsed:e.lastUsed}))]}return await this.storeSavedFilters(i),t?a.length:i.length-r.length}catch(a){throw new Error("Filtreler içe aktarılırken hata oluştu: "+a.message)}}async clearAllSavedFilters(e){if(e){const t=await this.getSavedFilters(),a=t.filter(t=>t.pageType!==e),r=t.length-a.length;return await this.storeSavedFilters(a),r}{const e=(await this.getSavedFilters()).length;return localStorage.removeItem(this.storageKey),e}}async getStorageStats(){const e=await this.getSavedFilters(),t=JSON.stringify(e).length,a={};let r,i;return e.forEach(e=>{a[e.pageType]=(a[e.pageType]||0)+1,(!r||e.createdAt<r)&&(r=e.createdAt),(!i||e.createdAt>i)&&(i=e.createdAt)}),{totalFilters:e.length,totalSize:t,filtersByPage:a,oldestFilter:r,newestFilter:i}}async storeSavedFilters(e){try{localStorage.setItem(this.storageKey,JSON.stringify(e))}catch(t){throw new Error("Filtreler kaydedilirken hata oluştu: "+t.message)}}generateId(){return`filter_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}}const x=a.memo(function({isOpen:e,onClose:t,onApplyFilters:c,fields:u,initialFilters:m={},savedFilters:g=[],quickFilters:f=[],onSaveFilter:x,onDeleteFilter:b,onLoadFilter:v,title:k="Gelişmiş Arama",pageType:j,enableURLSync:w=!0,enableExport:N=!1,onExport:S,dependencies:F=[],groups:C=[],validationRules:A=[],urlConfig:O,savedFiltersConfig:E}){const[R,D]=a.useState(m),[$,T]=a.useState(""),[U,z]=a.useState(!1),[_,L]=a.useState("filters"),[V,I]=a.useState({}),[q,K]=a.useState(!1),[B,P]=a.useState(null),M=a.useMemo(()=>new h(u,F,C,A),[u,F,C,A]),J=a.useMemo(()=>O?new p(O):null,[O]),G=a.useMemo(()=>E?new y(E):null,[E]);a.useEffect(()=>{e&&D(m)},[e,m]),a.useEffect(()=>{if(w&&e&&J){const e=J.getCurrentFilters(),{errors:t}=M.validateFilters(e);Object.keys(t).length>0&&D(t=>({...t,...e}))}},[e,w,J,M,u]),a.useEffect(()=>{if(w&&J)return J.onURLChange(e=>{const{errors:t}=M.validateFilters(e);0===Object.keys(t).length&&(D(e),I({}))})},[w,J,M,u]);const H=a.useCallback(e=>{const{errors:t}=M.validateFilters(e);return I(t),0===Object.keys(t).length},[M]),W=a.useMemo(()=>function(){let e=null;return function(...t){null!==e&&clearTimeout(e),e=setTimeout(()=>{e=null,(e=>{w&&J&&J.updateBrowserURL(e,!0)})(...t)},300)}}(),[w,J]),Q=a.useCallback((e,t)=>{const a=M.applyFilterChange(R,e,t);D(a);const r=Object.keys(R).filter(e=>!(e in a));(V[e]||r.some(e=>V[e]))&&I(t=>{const a={...t};return delete a[e],r.forEach(e=>delete a[e]),a}),W(a)},[M,R,V,W]),Y=a.useCallback(async()=>{try{K(!0),P(null),H(R)&&(await c(R),t())}catch(e){P(e instanceof Error?e.message:"Filtreler uygulanırken bir hata oluştu")}finally{K(!1)}},[R,c,t,H]),Z=a.useCallback(()=>{const e={};D(e),I({}),W(e)},[W]),X=a.useCallback(async(e=!1)=>{if($.trim()&&x&&H(R))try{if(K(!0),P(null),G){const t={id:Date.now().toString(),name:$.trim(),filters:R,createdAt:(new Date).toISOString(),pageType:j,isQuickFilter:e,updatedAt:(new Date).toISOString(),usageCount:0,lastUsed:(new Date).toISOString()};await G.saveFilter(t)}x({name:$.trim(),description:"",filters:R,pageType:j,isQuickFilter:e||!1,updatedAt:(new Date).toISOString(),usageCount:0,lastUsed:(new Date).toISOString()}),T(""),z(!1)}catch(t){P(t instanceof Error?t.message:"Filtre kaydedilirken bir hata oluştu")}finally{K(!1)}},[$,x,H,R,G,j]),ee=e=>{G&&G.loadSavedFilter(e.id),D(e.filters),I({}),W(e.filters),v&&v(e),L("filters")},te=e=>{var t,a,i,s,l,n,d,o,c,u,m,h,g,p,f;const y=R[e.key]||("multiSelect"===e.type?[]:"dateRange"===e.type||"numberRange"===e.type?{}:""),x=!!V[e.key],b=M.getVisibleFields(R),v=M.getEnabledFields(R),k=b.some(t=>t.key===e.key),j=v.includes(e.key);if(!k)return null;if(e.conditional&&R[e.conditional.field]!==e.conditional.value)return null;const w="w-full px-3 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white "+(x?"border-red-500":"border-gray-300 dark:border-gray-600");switch(e.type){case"text":case"number":return r.jsxs("div",{className:"space-y-1",children:[r.jsx("input",{type:"number"===e.type?"number":"text",placeholder:e.placeholder||e.label,value:y,onChange:t=>Q(e.key,t.target.value),disabled:!j,className:`${w} ${j?"":"bg-gray-100 cursor-not-allowed"}`,min:null==(t=e.validation)?void 0:t.min,max:null==(a=e.validation)?void 0:a.max,pattern:null==(i=e.validation)?void 0:i.pattern}),x&&r.jsx("p",{className:"text-sm text-red-500",children:x})]});case"select":return r.jsxs("div",{className:"space-y-1",children:[r.jsxs("select",{value:y,onChange:t=>Q(e.key,t.target.value),disabled:!j,className:`${w} ${j?"":"bg-gray-100 cursor-not-allowed"}`,children:[r.jsx("option",{value:"",children:"Tümü"}),null==(s=e.options)?void 0:s.map(e=>r.jsx("option",{value:e.value,children:e.label},e.value))]}),x&&r.jsx("p",{className:"text-sm text-red-500",children:x})]});case"multiSelect":return r.jsxs("div",{className:"space-y-1",children:[r.jsx("div",{className:"border rounded-md p-2 max-h-32 overflow-y-auto",children:null==(l=e.options)?void 0:l.map(t=>r.jsxs("label",{className:"flex items-center space-x-2 py-1",children:[r.jsx("input",{type:"checkbox",checked:Array.isArray(y)&&y.includes(t.value),onChange:a=>{const r=Array.isArray(y)?y:[];a.target.checked?Q(e.key,[...r,t.value]):Q(e.key,r.filter(e=>e!==t.value))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),r.jsx("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:t.label})]},t.value))}),x&&r.jsx("p",{className:"text-sm text-red-500",children:x})]});case"numberRange":return r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx("input",{type:"number",placeholder:"Min",value:(null==y?void 0:y.min)||"",onChange:t=>Q(e.key,{...y,min:t.target.value}),className:w,min:null==(n=e.validation)?void 0:n.min,max:null==(d=e.validation)?void 0:d.max}),r.jsx("input",{type:"number",placeholder:"Max",value:(null==y?void 0:y.max)||"",onChange:t=>Q(e.key,{...y,max:t.target.value}),className:w,min:null==(o=e.validation)?void 0:o.min,max:null==(c=e.validation)?void 0:c.max})]}),x&&r.jsx("p",{className:"text-sm text-red-500",children:x})]});case"dateRange":return r.jsxs("div",{className:"space-y-1",children:[r.jsxs("div",{className:"flex gap-2",children:[r.jsx("input",{type:"date",value:(null==y?void 0:y.start)||"",onChange:t=>Q(e.key,{...y,start:t.target.value}),className:`flex-1 ${w}`,placeholder:"Başlangıç",min:null==(u=e.validation)?void 0:u.min,max:null==(m=e.validation)?void 0:m.max}),r.jsx("input",{type:"date",value:(null==y?void 0:y.end)||"",onChange:t=>Q(e.key,{...y,end:t.target.value}),className:`flex-1 ${w}`,placeholder:"Bitiş",min:null==(h=e.validation)?void 0:h.min,max:null==(g=e.validation)?void 0:g.max})]}),x&&r.jsx("p",{className:"text-sm text-red-500",children:x})]});case"date":return r.jsxs("div",{className:"space-y-1",children:[r.jsx("input",{type:"date",value:y,onChange:t=>Q(e.key,t.target.value),className:w,min:null==(p=e.validation)?void 0:p.min,max:null==(f=e.validation)?void 0:f.max}),x&&r.jsx("p",{className:"text-sm text-red-500",children:x})]});default:return null}};return e?r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:r.jsxs("div",{"data-testid":"advanced-search-modal",className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[r.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[r.jsxs("div",{className:"flex items-center space-x-4",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:k}),j&&r.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full dark:bg-blue-900 dark:text-blue-200",children:j})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[N&&S&&r.jsx("button",{onClick:()=>S(R,"csv"),className:"px-3 py-1 text-sm bg-green-600 text-white rounded-md hover:bg-green-700 flex items-center space-x-1",children:r.jsx("span",{children:"Dışa Aktar"})}),r.jsx(i,{variant:"ghost",size:"icon",onClick:t,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:r.jsx(s,{className:"h-5 w-5"})})]})]}),r.jsxs("div",{className:"flex border-b border-gray-200 dark:border-gray-700",children:[r.jsx("button",{onClick:()=>L("filters"),className:"px-6 py-3 text-sm font-medium border-b-2 "+("filters"===_?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"),children:"Filtreler"}),r.jsxs("button",{onClick:()=>L("saved"),className:"px-6 py-3 text-sm font-medium border-b-2 "+("saved"===_?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"),children:["Kayıtlı Filtreler (",g.length,")"]}),f&&f.length>0&&r.jsx("button",{onClick:()=>L("quick"),className:"px-6 py-3 text-sm font-medium border-b-2 "+("quick"===_?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300"),children:"Hızlı Filtreler"})]}),r.jsxs("div",{className:"flex h-[calc(90vh-120px)]",children:["filters"===_&&r.jsxs("div",{className:"flex-1 p-6 overflow-y-auto",children:[Object.keys(V).length>0&&r.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg dark:bg-red-900/20 dark:border-red-800",children:[r.jsx("h4",{className:"text-sm font-medium text-red-800 dark:text-red-200 mb-2",children:"Lütfen aşağıdaki hataları düzeltin:"}),r.jsx("ul",{className:"text-sm text-red-700 dark:text-red-300 space-y-1",children:Object.entries(V).map(([e,t])=>r.jsxs("li",{children:["• ",t]},e))})]}),r.jsxs("div",{className:"space-y-6",children:[M.getGroupedFields(R).filter(e=>e.group).map(e=>r.jsxs("div",{className:"space-y-4",children:[e.group.label&&r.jsx("h3",{className:"text-lg font-medium text-gray-900 border-b border-gray-200 pb-2",children:e.group.label}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.fields.map(e=>{var t;return r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[e.label,(null==(t=e.validation)?void 0:t.required)&&r.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),te(e)]},e.key)})})]},e.group.id)),(()=>{const e=M.getGroupedFields(R).flatMap(e=>e.fields.map(e=>e.key)),t=u.filter(t=>!e.includes(t.key));return t.length>0?r.jsx("div",{className:"space-y-4",children:r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map(e=>{var t;return r.jsxs("div",{className:"space-y-2",children:[r.jsxs("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:[e.label,(null==(t=e.validation)?void 0:t.required)&&r.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),te(e)]},e.key)})})}):null})()]}),x&&r.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:U?r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("input",{placeholder:"Filtre adı",value:$,onChange:e=>T(e.target.value),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white",onKeyPress:e=>{"Enter"===e.key&&X()}}),r.jsx(i,{onClick:()=>X(),disabled:!$.trim(),children:"Kaydet"}),r.jsx(i,{variant:"outline",onClick:()=>{z(!1),T("")},children:"İptal"})]}):r.jsxs(i,{variant:"outline",onClick:()=>z(!0),className:"flex items-center gap-2",children:[r.jsx(l,{className:"h-4 w-4"}),"Filtreyi Kaydet"]})})]}),"saved"===_&&r.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Kayıtlı Filtreler"}),r.jsxs("div",{className:"flex items-center space-x-2",children:[G&&r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>{const e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=e=>{var t;const a=null==(t=e.target.files)?void 0:t[0];if(a&&G){const e=new FileReader;e.onload=e=>{var t;try{const a=JSON.parse(null==(t=e.target)?void 0:t.result);G.importSavedFilters(a)}catch(a){}},e.readAsText(a)}},e.click()},className:"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"İçe Aktar"}),r.jsx("button",{onClick:()=>{const e=G.exportSavedFilters(),t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),a=URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download=`saved-filters-${j}-${(new Date).toISOString().split("T")[0]}.json`,r.click(),URL.revokeObjectURL(a)},className:"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Dışa Aktar"})]}),r.jsx("button",{onClick:()=>{G&&G.clearAllSavedFilters()},className:"text-sm text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300",children:"Tümünü Temizle"})]})]}),g.map(e=>r.jsx("div",{className:"p-4 border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 group",children:r.jsxs("div",{className:"flex items-start justify-between",children:[r.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>ee(e),children:[r.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[r.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.name}),e.isQuickFilter&&r.jsx("span",{className:"px-2 py-1 text-xs bg-yellow-100 text-yellow-800 rounded-full dark:bg-yellow-900 dark:text-yellow-200",children:"Hızlı"})]}),r.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-400 dark:text-gray-500",children:[r.jsxs("span",{children:["Oluşturulma: ",new Date(e.createdAt).toLocaleDateString("tr-TR")]}),e.lastUsed&&r.jsxs("span",{children:["Son kullanım: ",new Date(e.lastUsed).toLocaleDateString("tr-TR")]}),e.usageCount&&r.jsxs("span",{children:["Kullanım: ",e.usageCount]})]})]}),b&&r.jsx("button",{onClick:t=>{t.stopPropagation(),b(e.id)},className:"opacity-0 group-hover:opacity-100 text-red-500 hover:text-red-700 p-1",children:r.jsx(n,{className:"w-4 h-4"})})]})},e.id)),0===g.length&&r.jsxs("div",{className:"text-center py-12",children:[r.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Henüz kayıtlı filtre yok"}),r.jsx("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:"Filtrelerinizi kaydetmek için önce filtre oluşturun"})]})]})}),"quick"===_&&f&&r.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Hızlı Filtreler"}),G&&r.jsx("button",{onClick:()=>{if(Object.keys(R).length>0){const e=prompt("Hızlı filtre adı:");e&&(T(e),X(!0))}},className:"text-sm text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300",children:"Mevcut Filtreyi Hızlı Filtre Yap"})]}),f.length>0?r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:f.map(e=>r.jsxs("button",{onClick:()=>{ee(e),G&&e.id&&G.loadSavedFilter(e.id)},className:"p-4 text-left bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg hover:from-blue-100 hover:to-indigo-100 transition-all duration-200 dark:from-blue-900/20 dark:to-indigo-900/20 dark:border-blue-700 dark:hover:from-blue-900/30 dark:hover:to-indigo-900/30",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-1",children:e.name}),e.usageCount&&e.usageCount>0&&r.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full dark:bg-blue-800 dark:text-blue-200",children:e.usageCount})]}),r.jsxs("div",{className:"flex items-center justify-between mt-2 text-xs text-gray-500 dark:text-gray-400",children:[r.jsxs("span",{children:[Object.keys(e.filters).length," filtre"]}),e.lastUsed&&r.jsxs("span",{children:["Son: ",new Date(e.lastUsed).toLocaleDateString("tr-TR")]})]})]},e.id))}):r.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[r.jsx("p",{className:"mb-4",children:"Hızlı filtre bulunamadı"}),r.jsx("p",{className:"text-sm",children:"Sık kullanılan filtrelerinizi hızlı erişim için kaydedin"})]})]})})]}),r.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 dark:border-gray-700",children:[B&&r.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-md dark:bg-red-900/20 dark:border-red-800",children:r.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:B})}),r.jsxs(i,{variant:"outline",onClick:Z,disabled:q,className:"flex items-center gap-2",children:[r.jsx(d,{className:"h-4 w-4"}),"Filtreleri Temizle"]}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(i,{"data-testid":"close-modal",variant:"outline",onClick:t,disabled:q,children:"İptal"}),r.jsxs(i,{"data-testid":"apply-filters",onClick:Y,disabled:q,className:"flex items-center gap-2",children:[q?r.jsx("div",{className:"h-4 w-4 animate-spin rounded-full border-2 border-white border-t-transparent"}):r.jsx(o,{className:"h-4 w-4"}),q?"Filtreleniyor...":"Filtrele"]})]})]})]})}):null});export{x as A,g as a,f as c};
