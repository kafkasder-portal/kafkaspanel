import{t as e,r as s,j as a,O as l,X as t,aH as r,J as i,U as n,M as d,B as c,P as o,a0 as m,i as x,aI as u,T as h,l as p,n as g,S as b}from"../assets/index-C7XW2vnU.js";import{u as y}from"./useUserManagement-C7iggVth.js";import{M as j}from"./Modal-QxY_FyG0.js";import{P as f}from"./pen-square-C-SOcf8u.js";import{E as v}from"./eye-off-ChtCqLKz.js";import{E as N}from"./eye-Bpapn1fj.js";const w=e("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);function k({isOpen:e,onClose:n,user:d,onRoleChange:c}){var o;const[m,x]=s.useState(d.role),[u,h]=s.useState(""),[p,g]=s.useState(!1),[b,y]=s.useState(null),f=e=>({super_admin:"Sistemin tüm özelliklerine erişim ve tüm yetkileri",admin:"Kullanıcı yönetimi ve sistem ayarları dahil geniş yetkiler",manager:"Departman yönetimi ve onay süreçlerinde yetki",coordinator:"Proje koordinasyonu ve takım yönetimi yetkileri",operator:"Günlük operasyonel işlemler için temel yetkiler",viewer:"Sadece görüntüleme yetkisi, değişiklik yapamaz"}[e]||""),v=e=>({super_admin:"border-red-300 bg-red-50 text-red-800",admin:"border-orange-300 bg-orange-50 text-orange-800",manager:"border-purple-300 bg-purple-50 text-purple-800",coordinator:"border-blue-300 bg-blue-50 text-blue-800",operator:"border-green-300 bg-green-50 text-green-800",viewer:"border-gray-300 bg-gray-50 text-gray-800"}[e]||"border-gray-300 bg-gray-50 text-gray-800"),N=()=>{p||(y(null),x(d.role),h(""),n())};return a.jsx(j,{isOpen:e,onClose:N,children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(l,{className:"h-6 w-6 text-purple-600 mr-2"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Kullanıcı Rolünü Değiştir"})]}),a.jsx("button",{onClick:N,disabled:p,className:"text-gray-400 hover:text-gray-600 disabled:cursor-not-allowed",children:a.jsx(t,{className:"h-5 w-5"})})]}),a.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),m!==d.role){g(!0),y(null);try{const e=await c(d.id,m,u.trim()||void 0);e.success?n():y(e.error||"Rol değiştirme işlemi başarısız")}catch(s){y(s instanceof Error?s.message:"Beklenmeyen bir hata oluştu")}finally{g(!1)}}else y("Lütfen farklı bir rol seçin")},className:"p-6 space-y-6",children:[a.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"h-12 w-12 rounded-full bg-indigo-100 flex items-center justify-center",children:a.jsx("span",{className:"text-indigo-600 font-medium text-lg",children:(null==(o=d.full_name)?void 0:o.charAt(0))||d.email.charAt(0).toUpperCase()})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("h4",{className:"text-lg font-medium text-gray-900",children:d.full_name||d.email}),a.jsx("p",{className:"text-sm text-gray-500",children:d.email}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Mevcut Rol: ",a.jsx("span",{className:"font-medium",children:r(d.role)})]})]})]})}),a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:a.jsxs("div",{className:"flex",children:[a.jsx(i,{className:"h-5 w-5 text-blue-400"}),a.jsx("div",{className:"ml-3",children:a.jsxs("p",{className:"text-sm text-blue-800",children:[a.jsx("strong",{children:"Bilgi:"})," Rol atama işlevi devre dışı bırakılmıştır. Tüm kullanıcılar otomatik olarak tam yetkiye sahiptir."]})})]})}),b&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:a.jsxs("div",{className:"flex",children:[a.jsx(i,{className:"h-5 w-5 text-red-400"}),a.jsx("div",{className:"ml-3",children:a.jsx("p",{className:"text-sm text-red-800",children:b})})]})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Yeni Rol Seçin"}),a.jsx("div",{className:"space-y-3",children:["super_admin","admin","manager","coordinator","operator","viewer"].map(e=>a.jsxs("label",{className:`relative flex cursor-pointer rounded-lg border p-4 hover:bg-gray-50 ${m===e?v(e):"border-gray-300"} opacity-50 cursor-not-allowed`,children:[a.jsx("input",{type:"radio",name:"role",value:e,checked:m===e,onChange:e=>x(e.target.value),disabled:!0,className:"sr-only"}),a.jsxs("div",{className:"flex w-full items-start",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"h-5 w-5 rounded-full border-2 flex items-center justify-center "+(m===e?"border-current bg-current":"border-gray-300"),children:m===e&&a.jsx("div",{className:"h-2 w-2 bg-white rounded-full"})})}),a.jsxs("div",{className:"ml-3 flex-1",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("p",{className:"font-medium",children:r(e)}),e===d.role&&a.jsx("span",{className:"text-xs px-2 py-1 bg-blue-100 text-blue-600 rounded-full",children:"Mevcut"}),a.jsx("span",{className:"text-xs px-2 py-1 bg-red-100 text-red-600 rounded-full",children:"Yetki Yok"})]}),a.jsx("p",{className:"text-sm text-gray-600 mt-1",children:f(e)})]})]})]},e))})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"reason",className:"block text-sm font-medium text-gray-700 mb-2",children:"Değişiklik Nedeni (Opsiyonel)"}),a.jsx("textarea",{id:"reason",value:u,onChange:e=>h(e.target.value),disabled:p,rows:3,placeholder:"Bu rol değişikliğinin nedenini açıklayın...",className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500 disabled:bg-gray-50 disabled:cursor-not-allowed"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Bu bilgi rol değişiklik loglarında saklanacak"})]}),m!==d.role&&a.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-md p-4",children:a.jsxs("div",{className:"flex",children:[a.jsx(i,{className:"h-5 w-5 text-amber-400"}),a.jsx("div",{className:"ml-3",children:a.jsxs("p",{className:"text-sm text-amber-800",children:[a.jsx("strong",{children:"Dikkat:"})," Rol değişikliği kullanıcının sistem erişim yetkilerini değiştirecek. Bu işlem geri alınamaz ve kullanıcı yeni rolüne göre yetkilendirilecek."]})})]})}),a.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-4 border-t border-gray-200",children:[a.jsx("button",{type:"button",onClick:N,disabled:p,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50",children:"İptal"}),a.jsx("button",{type:"submit",disabled:p||m===d.role||!0,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 border border-transparent rounded-md hover:bg-purple-700 disabled:cursor-not-allowed disabled:opacity-50",children:p?"Güncelleniyor...":"Rolü Değiştir"})]})]})]})})}function _({isOpen:e,onClose:l,user:r,onSave:i}){var x;const[u,h]=s.useState({full_name:r.full_name||"",email:r.email||"",department:r.department||"",phone:r.phone||""}),[p,g]=s.useState(!1),[b,y]=s.useState(null),f=e=>{const{name:s,value:a}=e.target;h(e=>({...e,[s]:a}))},v=()=>{p||(y(null),h({full_name:r.full_name||"",email:r.email||"",department:r.department||"",phone:r.phone||""}),l())};return a.jsx(j,{isOpen:e,onClose:v,children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[a.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(n,{className:"h-6 w-6 text-blue-600 mr-2"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Profil Düzenle"})]}),a.jsx("button",{onClick:v,disabled:p,className:"text-gray-400 hover:text-gray-600 disabled:cursor-not-allowed",children:a.jsx(t,{className:"h-5 w-5"})})]}),a.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),u.full_name.trim())if(u.email.trim())if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u.email)){g(!0),y(null);try{const e=await i(r.id,{full_name:u.full_name.trim(),email:u.email.trim(),department:u.department.trim()||null,phone:u.phone.trim()||null});e.success?l():y(e.error||"Profil güncellenirken hata oluştu")}catch(s){y(s instanceof Error?s.message:"Beklenmeyen bir hata oluştu")}finally{g(!1)}}else y("Geçerli bir e-posta adresi giriniz");else y("E-posta alanı zorunludur");else y("Ad Soyad alanı zorunludur")},className:"p-6 space-y-4",children:[a.jsx("div",{className:"flex justify-center mb-4",children:a.jsx("div",{className:"h-16 w-16 rounded-full bg-indigo-100 flex items-center justify-center",children:a.jsx("span",{className:"text-indigo-600 font-medium text-xl",children:(null==(x=u.full_name)?void 0:x.charAt(0))||r.email.charAt(0).toUpperCase()})})}),b&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:a.jsx("p",{className:"text-sm text-red-800",children:b})}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"full_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Ad Soyad *"}),a.jsxs("div",{className:"relative",children:[a.jsx(n,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),a.jsx("input",{type:"text",id:"full_name",name:"full_name",value:u.full_name,onChange:f,disabled:p,required:!0,className:"pl-10 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500 disabled:bg-gray-50 disabled:cursor-not-allowed",placeholder:"Ad ve soyadınızı giriniz"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"E-posta *"}),a.jsxs("div",{className:"relative",children:[a.jsx(d,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),a.jsx("input",{type:"email",id:"email",name:"email",value:u.email,onChange:f,disabled:p,required:!0,className:"pl-10 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500 disabled:bg-gray-50 disabled:cursor-not-allowed",placeholder:"E-posta adresinizi giriniz"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"department",className:"block text-sm font-medium text-gray-700 mb-1",children:"Departman"}),a.jsxs("div",{className:"relative",children:[a.jsx(c,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),a.jsx("input",{type:"text",id:"department",name:"department",value:u.department,onChange:f,disabled:p,className:"pl-10 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500 disabled:bg-gray-50 disabled:cursor-not-allowed",placeholder:"Departmanınızı giriniz"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefon"}),a.jsxs("div",{className:"relative",children:[a.jsx(o,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),a.jsx("input",{type:"tel",id:"phone",name:"phone",value:u.phone,onChange:f,disabled:p,className:"pl-10 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500 disabled:bg-gray-50 disabled:cursor-not-allowed",placeholder:"Telefon numaranızı giriniz"})]})]}),a.jsx("div",{className:"bg-blue-50 rounded-lg p-3",children:a.jsxs("p",{className:"text-sm text-blue-800",children:[a.jsx("strong",{children:"Not:"})," E-posta adresi değişikliği kullanıcının giriş bilgilerini etkileyecektir."]})}),a.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-4 border-t border-gray-200",children:[a.jsx("button",{type:"button",onClick:v,disabled:p,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:cursor-not-allowed disabled:opacity-50",children:"İptal"}),a.jsxs("button",{type:"submit",disabled:p||!(u.full_name!==(r.full_name||"")||u.email!==(r.email||"")||u.department!==(r.department||"")||u.phone!==(r.phone||"")),className:"inline-flex items-center px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-50",children:[a.jsx(m,{className:"h-4 w-4 mr-2"}),p?"Kaydediliyor...":"Kaydet"]})]})]})]})})}function C({statistics:e}){const s={super_admin:"text-red-600 bg-red-50 border-red-200",admin:"text-orange-600 bg-orange-50 border-orange-200",manager:"text-purple-600 bg-purple-50 border-purple-200",coordinator:"text-blue-600 bg-blue-50 border-blue-200",operator:"text-green-600 bg-green-50 border-green-200",viewer:"text-gray-600 bg-gray-50 border-gray-200"},t=({title:e,value:s,icon:l,color:t="text-blue-600 bg-blue-50",change:r})=>a.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:e}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s}),void 0!==r&&a.jsxs("div",{className:"flex items-center mt-1",children:[a.jsx(h,{className:"h-3 w-3 text-green-500 mr-1"}),a.jsxs("span",{className:"text-xs text-green-600",children:["+",r," bu hafta"]})]})]}),a.jsx("div",{className:`p-3 rounded-full ${t}`,children:a.jsx(l,{className:"h-6 w-6"})})]})});return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsx(t,{title:"Toplam Kullanıcı",value:e.total,icon:x,color:"text-blue-600 bg-blue-50",change:e.recentSignups}),a.jsx(t,{title:"Aktif Kullanıcı",value:e.active,icon:u,color:"text-green-600 bg-green-50"}),a.jsx(t,{title:"Pasif Kullanıcı",value:e.inactive,icon:w,color:"text-red-600 bg-red-50"}),a.jsx(t,{title:"Yönetici Sayısı",value:e.byRole.admin+e.byRole.super_admin,icon:l,color:"text-purple-600 bg-purple-50"})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Rol Dağılımı"}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:Object.entries(e.byRole).map(([l,t])=>a.jsx("div",{className:`p-4 rounded-lg border-2 ${s[l]}`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium",children:r(l)}),a.jsx("p",{className:"text-2xl font-bold",children:t})]}),a.jsx("div",{className:"text-right",children:a.jsx("p",{className:"text-xs",children:e.total>0?`${Math.round(t/e.total*100)}%`:"0%"})})]})},l))})]}),a.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Özet Bilgiler"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Kullanıcı Durumu"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Aktif Rate:"}),a.jsx("span",{className:"text-sm font-medium text-green-600",children:e.total>0?`${Math.round(e.active/e.total*100)}%`:"0%"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Bu Hafta Yeni:"}),a.jsx("span",{className:"text-sm font-medium text-blue-600",children:e.recentSignups})]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Yetki Dağılımı"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Yönetici:"}),a.jsx("span",{className:"text-sm font-medium text-purple-600",children:e.byRole.admin+e.byRole.super_admin})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Operasyonel:"}),a.jsx("span",{className:"text-sm font-medium text-blue-600",children:e.byRole.manager+e.byRole.coordinator+e.byRole.operator})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:"Görüntüleyici:"}),a.jsx("span",{className:"text-sm font-medium text-gray-600",children:e.byRole.viewer})]})]})]})]})]})]})}function S({users:e,canManageUsers:s,onRoleChange:t,onProfileEdit:i,onStatusToggle:n,isUpdating:d}){const c=e=>e?new Date(e).toLocaleDateString("tr-TR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Hiçbir zaman";return a.jsxs("div",{className:"overflow-x-auto",children:[a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kullanıcı"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rol"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Departman"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Durum"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Son Giriş"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Kayıt Tarihi"}),s&&a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"İşlemler"})]})}),a.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>{var o,m;return a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"h-10 w-10 flex-shrink-0",children:a.jsx("div",{className:"h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center",children:a.jsx("span",{className:"text-indigo-600 font-medium",children:(null==(o=e.full_name)?void 0:o.charAt(0))||e.email.charAt(0).toUpperCase()})})}),a.jsxs("div",{className:"ml-4",children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.full_name||e.email}),a.jsx("div",{className:"text-sm text-gray-500",children:e.email})]})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${m=e.role,{super_admin:"text-red-600 bg-red-50",admin:"text-orange-600 bg-orange-50",manager:"text-purple-600 bg-purple-50",coordinator:"text-blue-600 bg-blue-50",operator:"text-green-600 bg-green-50",viewer:"text-gray-600 bg-gray-50"}[m]||"text-gray-600 bg-gray-50"}`,children:r(e.role)})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.department||"-"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsx("div",{className:"flex items-center",children:e.is_active?a.jsxs("div",{className:"flex items-center text-green-600",children:[a.jsx(u,{className:"h-4 w-4 mr-1"}),a.jsx("span",{className:"text-sm",children:"Aktif"})]}):a.jsxs("div",{className:"flex items-center text-red-600",children:[a.jsx(w,{className:"h-4 w-4 mr-1"}),a.jsx("span",{className:"text-sm",children:"Pasif"})]})})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:c(e.last_sign_in_at)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:c(e.created_at)}),s&&a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:a.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[a.jsx("button",{onClick:()=>i(e),className:"text-indigo-600 hover:text-indigo-900",title:"Profil Düzenle",children:a.jsx(f,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>t(e),className:"text-purple-600 hover:text-purple-900",title:"Rol Değiştir",children:a.jsx(l,{className:"h-4 w-4"})}),a.jsx("button",{onClick:()=>n(e.id,!e.is_active),disabled:d,className:`${e.is_active?"text-red-600 hover:text-red-900":"text-green-600 hover:text-green-900"} ${d?"opacity-50 cursor-not-allowed":""}`,title:e.is_active?"Pasif Yap":"Aktif Yap",children:e.is_active?a.jsx(v,{className:"h-4 w-4"}):a.jsx(N,{className:"h-4 w-4"})})]})})]},e.id)})})]}),0===e.length&&a.jsxs("div",{className:"text-center py-8",children:[a.jsx(x,{className:"mx-auto h-12 w-12 text-gray-400"}),a.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Kullanıcı bulunamadı"}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Henüz hiç kullanıcı kaydedilmemiş veya arama kriterlerinize uygun kullanıcı yok."})]})]})}function R(){var e;const{users:l,permissions:t,statistics:i,selectedUser:n,isLoading:d,isUpdating:c,error:o,showRoleModal:m,showProfileModal:x,handleRoleChange:u,handleProfileUpdate:h,handleStatusToggle:j,selectUserForRoleChange:f,selectUserForProfileEdit:v,closeModals:N,search:w,refetchUsers:R}=y(),[D,z]=s.useState("all"),[U,A]=s.useState("all"),K=l.filter(e=>{var s,a;const l=w.searchQuery.length<=2||e.email.toLowerCase().includes(w.searchQuery.toLowerCase())||(null==(s=e.full_name)?void 0:s.toLowerCase().includes(w.searchQuery.toLowerCase()))||(null==(a=e.department)?void 0:a.toLowerCase().includes(w.searchQuery.toLowerCase())),t="all"===D||e.role===D,r="all"===U||"active"===U&&e.is_active||"inactive"===U&&!e.is_active;return l&&t&&r});return d?a.jsx(p,{}):o?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsxs("div",{className:"text-red-500 text-sm",children:["Kullanıcı verileri yüklenirken hata oluştu: ",null==o?void 0:o.message]}),a.jsx("button",{onClick:()=>R(),className:"mt-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Tekrar Dene"})]})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Kullanıcı Yönetimi"}),a.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Sistem kullanıcılarını yönetin ve rollerini düzenleyin."})]}),a.jsxs("button",{onClick:()=>{const e=[["Ad Soyad","Email","Rol","Departman","Durum","Son Giriş","Kayıt Tarihi"],...K.map(e=>[e.full_name||e.email,e.email,r(e.role),e.department||"",e.is_active?"Aktif":"Pasif",e.last_sign_in_at?new Date(e.last_sign_in_at).toLocaleDateString("tr-TR"):"Hiçbir zaman",new Date(e.created_at).toLocaleDateString("tr-TR")])].map(e=>e.map(e=>`"${e}"`).join(",")).join("\n"),s=new Blob([e],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a");if(void 0!==a.download){const e=URL.createObjectURL(s);a.setAttribute("href",e),a.setAttribute("download",`kullanicilar-${(new Date).toISOString().slice(0,10)}.csv`),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)}},className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:[a.jsx(g,{className:"h-4 w-4 mr-2"}),"CSV İndir"]})]}),i&&a.jsx(C,{statistics:i}),a.jsx("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx(b,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),a.jsx("input",{type:"text",placeholder:"Kullanıcı ara...",value:w.searchQuery,onChange:e=>w.setSearchQuery(e.target.value),className:"pl-10 w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500"})]}),a.jsx("div",{children:a.jsxs("select",{value:D,onChange:e=>z(e.target.value),className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500",children:[a.jsx("option",{value:"all",children:"Tüm Roller"}),a.jsx("option",{value:"super_admin",children:"Süper Yönetici"}),a.jsx("option",{value:"admin",children:"Yönetici"}),a.jsx("option",{value:"manager",children:"Müdür"}),a.jsx("option",{value:"coordinator",children:"Koordinatör"}),a.jsx("option",{value:"operator",children:"Operatör"}),a.jsx("option",{value:"viewer",children:"Görüntüleyici"})]})}),a.jsx("div",{children:a.jsxs("select",{value:U,onChange:e=>A(e.target.value),className:"w-full rounded-md border border-gray-300 px-3 py-2 text-sm focus:border-blue-500 focus:ring-blue-500",children:[a.jsx("option",{value:"all",children:"Tüm Durumlar"}),a.jsx("option",{value:"active",children:"Aktif"}),a.jsx("option",{value:"inactive",children:"Pasif"})]})}),a.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[K.length," kullanıcı gösteriliyor"]})]})}),a.jsx("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200",children:a.jsx(S,{users:K,canManageUsers:!0,onRoleChange:f,onProfileEdit:v,onStatusToggle:j,isUpdating:c})}),m&&n&&a.jsx(k,{isOpen:m,onClose:N,user:n,onRoleChange:u,currentUserRole:null==(e=null==t?void 0:t.profile)?void 0:e.role}),x&&n&&a.jsx(_,{isOpen:x,onClose:N,user:n,onSave:h})]})}export{R as default};
